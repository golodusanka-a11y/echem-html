
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Conductor-like polarizable continuum model &#8212; Computational Chemistry from  Laptop to HPC</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-TX4YJ1J5XE"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-TX4YJ1J5XE');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-TX4YJ1J5XE');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/env/cpcm';</script>
    <link rel="icon" href="../../_static/favicon.png"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Molecular structure and dynamics" href="../visualize/mol_struct.html" />
    <link rel="prev" title="Polarizable continuum models" href="pcm.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../title.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Computational Chemistry from  Laptop to HPC - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Computational Chemistry from  Laptop to HPC - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../intro.html">Getting started</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basics_notebook.html">Using Jupyter notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../units_notation.html">Units and notation</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Electronic ground states</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/elstruct_gen.html">General aspects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/orbitals.html">Orbitals and basis sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/slater.html">Many-electron wave functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/operators.html">Operators and matrix elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/reduced_density.html">Reduced particle densities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/natural_orbitals.html">Natural orbitals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/integrals.html">Integrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/spin.html">Electron spin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/correlation.html">Electron correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/dispersion.html">Dispersion interactions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/pt.html">Rayleigh–Schrödinger perturbation theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/second_quant.html">Second quantization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/group_theory.html">Symmetry</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/wft.html">Wave function theory</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../elec_struct/hartree-fock.html">Hartree–Fock</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../elec_struct/hf_theory.html">Hartree–Fock theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../elec_struct/fock_diagonalize.html">Fock matrix diagonalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../elec_struct/hf_scf.html">SCF optimization</a></li>

<li class="toctree-l3"><a class="reference internal" href="../elec_struct/hf_example.html">HF in VeloxChem</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/mp2.html">Møller–Plesset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/ci.html">Configuration interaction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/wft_exercises.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/dft.html">Density functional theory</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/hohenberg.html">Hohenberg–Kohn theorems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/kohn-sham.html">Kohn–Sham method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/kernel_int.html">Kernel integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/dft_scf.html">SCF optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/dft_prop.html">First-order properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/available_xcfun.html">Available XC functionals</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../elec_struct/multiref.html">Multireference methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/mcscf.html">MCSCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../elec_struct/mcpdft.html">MC-PDFT</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Molecular structure and dynamics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/molstruct_gen.html">General aspects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/coordinates.html">Choice of coordinates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/symmetry.html">Molecular symmetry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/tst.html">Transition-state theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/opt_struct.html">Optimization methods</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/gradients.html">Gradients</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/energy_grad.html">Energy gradients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/property_grad.html">Property gradients</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/hessians_vib.html">Hessians and vibrations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/hessians.html">Molecular Hessians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/vibrations.html">Vibrational analysis</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/opt.html">Structure optimization</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/opt_gs.html">Ground state</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/opt_constrained.html">Constrained coordinates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/conformer.html">Conformer search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/tst_gen.html">Transition state</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/ts_guesser.html">Guessing transition states with force fireld interpolation</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/impes.html">PES interpolation techniques</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/impes_calc.html">Constructing the PES by interpolation</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../mol_struct/md.html">Molecular dynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/forcefields.html">Force fields</a></li>


<li class="toctree-l2"><a class="reference internal" href="../mol_struct/reparameterize.html">Reparameterize force fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/md_setup.html">Ensembles and time integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mol_struct/md_run.html">Running a simulation</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Spectra and properties</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/spectra_aspects.html">General aspects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/resp_external.html">Responses to external fields</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/mol_prop.html">Molecular properties</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/first_order.html">First-order properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/linear_resp.html">Linear Response</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/quad_resp.html">Quadratic response</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/cubic_resp.html">Cubic response</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/elec_nuc.html">Electronic and nuclear contributions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/rovib.html">Rovibronic states</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/dipole_equiv.html">Dipole equivalence relations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/finite_field.html">Finite field method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/nto.html">Natural transition orbitals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/selection_rules.html">Selection rules</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/excoupl.html">Exciton coupling model</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/excoupl_impl.html">Implementation</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/expt_theory.html">Experiment to theory</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/uv_vis.html">UV/vis absorption</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/opa.html">One-photon absorption</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tpa.html">Two-photon absorption</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/optact.html">Optical activity</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/ecd.html">Electronic Circular Dichroism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/or.html">Optical Rotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tpcd.html">Two-photon circular dichroism</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tpor.html">Two-photon optical rotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/more_optact.html">More birefringences &amp; dichroisms</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/wavefunction.html">Wave function methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/hf.html">Hartree–Fock</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/orb_rot.html">Orbital rotations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/kappa_expansion.html">Time-dependence of observables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/orb_param_field.html">Field-dependence of parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/hf_param_energy.html">Energy determination of parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/hf_quasienergy.html">Quasi-energy determination of parameters</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/ci.html">Configuration interaction</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/adc.html">Algebraic-diagrammatic construction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/adc_pp.html">Polarization propagator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/adc_isr.html">Intermediate state representation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/adc_cvs.html">Core-valence separation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/adc_hpc.html">HPC-QC implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/adc_exercises_new.html">Exercises</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/tddft.html">Time-dependent DFT</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/tddft_foundation.html">Foundations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tddft_quasienergy.html">Quasi-energy</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/tddft_linear_response.html">Linear response</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tddft_lr_theory.html">Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tddft_lr_implementation.html">Implementation</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../spec_prop/tddft_excited_states.html">Excited states</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tddft_rsp_eq.html">TDDFT response equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tddft_tda.html">Tamm–Dancoff approximation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tddft_cvs.html">Core-valence separation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tddft_triplet_inst.html">Triplet instability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../spec_prop/tddft_spin_flip.html">Spin-flip</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/tddft_charge_transfer.html">Charge transfer</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../spec_prop/mr_response.html">Multireference methods</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/sa_mcscf.html">State-averaged MCSCF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spec_prop/mr_exercises.html">Exercises</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Environment</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="localprop.html">Localized properties</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="esp.html">ESP charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="chelpg.html">CHELPG charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="resp.html">RESP charges</a></li>
<li class="toctree-l2"><a class="reference internal" href="loprop.html">LoProp charges and polarisabilities</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="embedding.html">Embedding potentials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="nonpol_emb.html">Non-polarizable embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="pol_emb.html">Polarizable embedding</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="pcm.html">Polarizable continuum models</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Conductor-like polarizable continuum model</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Visualization</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/mol_struct.html">Molecular structure and dynamics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/struct_vis.html">Molecular structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/md_vis.html">MD trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/opt_vib_vis.html">Optimization and normal modes</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/elec_struct.html">Electronic structure</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/orb_vis.html">Orbitals and densities</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualize/spec_prop.html">Spectra and properties</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualize/exc_vis.html">Excited states</a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualize/broadening.html">Spectrum broadening</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorials and workflows</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/workflow.html">Constructing workflows</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/wf_build.html">Building systems</a></li>

<li class="toctree-l2"><a class="reference internal" href="../tutorials/wf_struct.html">Optimizing molecular structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/wf_scf.html">Optimizing electronic structure</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../tutorials/wf_construct.html">Assembling a full workflow</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/wf_methane.html">Methane combustion energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/wf_gwp.html">Global warming potential</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tutorials/wf_spectra.html">From structure to spectrum</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/uv_vis.html">UV/vis spectroscopies</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_absorption.html">Absorption</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_fluorescence.html">Fluorescence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_analysis.html">Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_rec.html">Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/uv_vis_exercises.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/vib_ir.html">Vibrational spectroscopies</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/vib_ir_calc.html">IR spectroscopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/vib_ir_raman.html">Raman spectroscopy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/vib_ir_exercises.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/openshells.html">Open shells</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/rest_unrest.html">Restricted versus unrestricted</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/correlation.html">Static versus dynamic correlation correlation</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/xray.html">X-ray spectroscopies</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_calc.html">Spectrum calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_analysis.html">Spectrum analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_aspects.html">Special aspects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/dire_xps.html">Core-hole localization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_large.html">Larger systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_nonstandard.html">Non-standard calculations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_rec.html">Recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_exercises.html">Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/xray_cheatsheet.html">Cheat sheet</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/colab.html">Google Colab notebooks</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bibliography</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../cite.html">How to cite and contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../refs.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/kthpanor/echem" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/kthpanor/echem/issues/new?title=Issue%20on%20page%20%2Fdocs/env/cpcm.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/docs/env/cpcm.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Conductor-like polarizable continuum model</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cavity-grid">Cavity grid</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#c-pcm-equations">C-PCM equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-definitions">Matrix definitions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scf-in-c-pcm">SCF in C-PCM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gradient">Gradient</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analytical-gradient">Analytical gradient:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unrelaxed-fixed-cavity-ufc-approximation">Unrelaxed fixed cavity (UFC) approximation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nuclear-contribution">Nuclear contribution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#electronic-contribution">Electronic contribution</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-gradient">Numerical gradient</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relaxed-fixed-cavity-rfc-gradient">Relaxed fixed cavity (RFC) gradient</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#full-gradient">Full gradient</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="conductor-like-polarizable-continuum-model">
<h1>Conductor-like polarizable continuum model<a class="headerlink" href="#conductor-like-polarizable-continuum-model" title="Link to this heading">#</a></h1>
<p>The <em>conductor-like polarizable continuum model</em> (C-PCM) <span id="id1">[<a class="reference internal" href="../refs.html#id6" title="Vincenzo Barone and Maurizio Cossi. Quantum calculation of molecular energies and energy gradients in solution by a conductor solvent model. The Journal of Physical Chemistry A, 102(11):1995-2001, 1998. URL: https://doi.org/10.1021/jp9716997, doi:10.1021/jp9716997.">BC98</a>]</span>—identical to the conductor-like screening model (COSMO) only in its original implementation—is one of the most widely used solvation models, offering reasonable accuracy at low computational cost. C-PCM belongs to the class of apparent surface charge models, which all have in common that the solvent effect—and thus the electrostatic environment—is represented by charges on the surface of a cavity enclosing the solute.</p>
<p>In C-PCM, the region inside the cavity is treated as vacuum, while the surrounding solvent is characterized by a dielectric constant <span class="math notranslate nohighlight">\(\varepsilon_\text{pol}\)</span>. The cavity is constructed from interlocking atom-centred spheres, one per atom, whose union defines the molecular cavity enclosing the solute (see figure below). In this way, only the portion of each atom-centered sphere that is exposed to the solvent contributes to the total cavity surface, <span class="math notranslate nohighlight">\(\Gamma\)</span>, ensuring that each surface point is uniquely associated with a single atom.</p>
<figure class="align-center" id="cavity-volume">
<img alt="../../_images/cavity_volume.png" src="../../_images/cavity_volume.png" />
<figcaption>
<p><span class="caption-number">Fig. 16 </span><span class="caption-text">Sketch of the cavity. The black dots represent the nuclei.</span><a class="headerlink" href="#cavity-volume" title="Link to this image">#</a></p>
</figcaption>
</figure>
<section id="cavity-grid">
<h2>Cavity grid<a class="headerlink" href="#cavity-grid" title="Link to this heading">#</a></h2>
<p>To solve the C-PCM equations for general molecules and cavity geometries, the cavity surface is discretized. We use a Lebedev quadrature scheme, to assign grid points <span class="math notranslate nohighlight">\(k\)</span>, with associated weights <span class="math notranslate nohighlight">\(w_k\)</span>, to the surface of a sphere which enables the numerical integration of a function <span class="math notranslate nohighlight">\(f\)</span>, over the surface, as</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} \int_0^{2 \pi} \hspace{-2.5mm} \int_0^\pi f(\theta, \varphi) \sin{\theta} \mathrm{d} \theta  \mathrm{d} \varphi \approx 4 \pi \sum_k^N w_k f(\theta_k, \varphi_k) \end{equation*}\]</div>
<p>Each grid point represents a small patch of the spherical surface, within which the quadrature effectively assumes the function to be constant. This is why a finer grid—comprising smaller surface elements—leads to more accurate results.</p>
<p>To begin our study of the C-PCM model, we define our solute (here a water molecule), and construct the cavity surface grid using the <code class="docutils literal notranslate"><span class="pre">CpcmDriver</span></code> available in VeloxChem.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">veloxchem</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">vlx</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">veloxchem</span><span class="w"> </span><span class="kn">import</span> <span class="n">bohr_in_angstrom</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">formatter</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;float_kind&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">{:.3e}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">})</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">mcolors</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">py3Dmol</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">p3d</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;py3Dmol required to visualize the grid!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">water_xyz</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;3</span>
<span class="s2">C2v</span>
<span class="s2">O    0.000000000000        0.000000000000        0.000000000000</span>
<span class="s2">H    0.000000000000        0.740848095288        0.582094932012</span>
<span class="s2">H    0.000000000000       -0.740848095288        0.582094932012</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">molecule</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">read_xyz_string</span><span class="p">(</span><span class="n">water_xyz</span><span class="p">)</span>
<span class="n">cpcm_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">CpcmDriver</span><span class="p">()</span>

<span class="c1"># non-hydrogen atoms</span>
<span class="n">grid_per_sphere</span>          <span class="o">=</span> <span class="mi">194</span>
<span class="c1"># for hydrogen atoms</span>
<span class="n">grid_per_sphere_h</span>        <span class="o">=</span> <span class="n">grid_per_sphere</span> 
<span class="n">cpcm_drv</span><span class="o">.</span><span class="n">grid_per_sphere</span> <span class="o">=</span> <span class="p">[</span><span class="n">grid_per_sphere</span><span class="p">,</span> <span class="n">grid_per_sphere_h</span><span class="p">]</span>

<span class="n">grid</span><span class="p">,</span> <span class="n">sw_f</span> <span class="o">=</span> <span class="n">cpcm_drv</span><span class="o">.</span><span class="n">generate_cpcm_grid</span><span class="p">(</span><span class="n">molecule</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Available grid levels: </span><span class="si">{</span><span class="p">[</span><span class="n">key</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">cpcm_drv</span><span class="o">.</span><span class="n">get_zeta_dict</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Available grid levels: [50, 110, 194, 302, 434, 590, 770, 974, 2030]
</pre></div>
</div>
</div>
</div>
<p>Grid levels are given as the number of points per atom of each sphere, corresponding to <span class="math notranslate nohighlight">\(N\)</span> in the equation above. Unless specified otherwise through the <code class="docutils literal notranslate"><span class="pre">cpcm_drv.grid_per_sphere</span></code> attribute, the standard number of points is 194 for non-hydrogen elements, while for hydrogen typically a smaller number is used. Try varying <code class="docutils literal notranslate"><span class="pre">grid_per_sphere</span></code> and re-run the visualization below. We will soon get to the other return object from the grid method, <code class="docutils literal notranslate"><span class="pre">sw_f</span></code>. We can visualize the grid by using another class method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cpcm_drv</span><span class="o">.</span><span class="n">visualize_cpcm_grid</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div id="3dmolviewer_1763995690609039"  style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_1763995690609039" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdn.jsdelivr.net/npm/3dmol@2.5.0/build/3Dmol-min.js');
}

var viewer_1763995690609039 = null;
var warn = document.getElementById("3dmolwarning_1763995690609039");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_1763995690609039 = $3Dmol.createViewer(document.getElementById("3dmolviewer_1763995690609039"),{backgroundColor:"white"});
viewer_1763995690609039.zoomTo();
	viewer_1763995690609039.addModel("3\n\nO              0.000000000000         0.000000000000         0.000000000000\nH              0.000000000000         0.740848095288         0.582094932012\nH              0.000000000000        -0.740848095288         0.582094932012\n","xyz");
	viewer_1763995690609039.setStyle({"stick": {}});
	viewer_1763995690609039.addModel("392\n\nHe 1.824 0.0 0.0\nHe -1.824 0.0 0.0\nHe 0.0 1.824 0.0\nHe 0.0 -1.824 0.0\nHe 0.0 0.0 1.824\nHe 0.0 0.0 -1.824\nHe 0.0 1.2897627688842626 -1.2897627688842626\nHe 0.0 -1.2897627688842626 -1.2897627688842626\nHe 1.2897627688842626 0.0 1.2897627688842626\nHe 1.2897627688842626 0.0 -1.2897627688842626\nHe -1.2897627688842626 0.0 1.2897627688842626\nHe -1.2897627688842626 0.0 -1.2897627688842626\nHe 1.2897627688842626 1.2897627688842626 0.0\nHe 1.2897627688842626 -1.2897627688842626 0.0\nHe -1.2897627688842626 1.2897627688842626 0.0\nHe -1.2897627688842626 -1.2897627688842626 0.0\nHe 1.0530868910018776 1.0530868910018776 1.0530868910018776\nHe 1.0530868910018776 1.0530868910018776 -1.0530868910018776\nHe 1.0530868910018776 -1.0530868910018776 1.0530868910018776\nHe 1.0530868910018776 -1.0530868910018776 -1.0530868910018776\nHe -1.0530868910018776 1.0530868910018776 1.0530868910018776\nHe -1.0530868910018776 1.0530868910018776 -1.0530868910018776\nHe -1.0530868910018776 -1.0530868910018776 1.0530868910018776\nHe -1.0530868910018776 -1.0530868910018776 -1.0530868910018776\nHe 1.2244463559476093 1.2244463559476093 0.5730953173890374\nHe 1.2244463559476093 1.2244463559476093 -0.5730953173890374\nHe 1.2244463559476093 -1.2244463559476093 0.5730953173890374\nHe 1.2244463559476093 -1.2244463559476093 -0.5730953173890374\nHe -1.2244463559476093 1.2244463559476093 0.5730953173890374\nHe -1.2244463559476093 1.2244463559476093 -0.5730953173890374\nHe -1.2244463559476093 -1.2244463559476093 0.5730953173890374\nHe -1.2244463559476093 -1.2244463559476093 -0.5730953173890374\nHe 1.2244463559476093 0.5730953173890374 1.2244463559476093\nHe 1.2244463559476093 -0.5730953173890374 1.2244463559476093\nHe 1.2244463559476093 0.5730953173890374 -1.2244463559476093\nHe 1.2244463559476093 -0.5730953173890374 -1.2244463559476093\nHe -1.2244463559476093 0.5730953173890374 1.2244463559476093\nHe -1.2244463559476093 -0.5730953173890374 1.2244463559476093\nHe -1.2244463559476093 0.5730953173890374 -1.2244463559476093\nHe -1.2244463559476093 -0.5730953173890374 -1.2244463559476093\nHe 0.5730953173890374 1.2244463559476093 1.2244463559476093\nHe -0.5730953173890374 1.2244463559476093 1.2244463559476093\nHe 0.5730953173890374 1.2244463559476093 -1.2244463559476093\nHe -0.5730953173890374 1.2244463559476093 -1.2244463559476093\nHe 0.5730953173890374 -1.2244463559476093 1.2244463559476093\nHe -0.5730953173890374 -1.2244463559476093 1.2244463559476093\nHe 0.5730953173890374 -1.2244463559476093 -1.2244463559476093\nHe -0.5730953173890374 -1.2244463559476093 -1.2244463559476093\nHe 0.5275857304697601 0.5275857304697601 1.664416592686272\nHe 0.5275857304697601 0.5275857304697601 -1.664416592686272\nHe 0.5275857304697601 -0.5275857304697601 1.664416592686272\nHe 0.5275857304697601 -0.5275857304697601 -1.664416592686272\nHe -0.5275857304697601 0.5275857304697601 1.664416592686272\nHe -0.5275857304697601 0.5275857304697601 -1.664416592686272\nHe -0.5275857304697601 -0.5275857304697601 1.664416592686272\nHe -0.5275857304697601 -0.5275857304697601 -1.664416592686272\nHe 0.5275857304697601 1.664416592686272 0.5275857304697601\nHe 0.5275857304697601 -1.664416592686272 0.5275857304697601\nHe 0.5275857304697601 1.664416592686272 -0.5275857304697601\nHe 0.5275857304697601 -1.664416592686272 -0.5275857304697601\nHe -0.5275857304697601 1.664416592686272 0.5275857304697601\nHe -0.5275857304697601 -1.664416592686272 0.5275857304697601\nHe -0.5275857304697601 1.664416592686272 -0.5275857304697601\nHe -0.5275857304697601 -1.664416592686272 -0.5275857304697601\nHe 1.664416592686272 0.5275857304697601 0.5275857304697601\nHe -1.664416592686272 0.5275857304697601 0.5275857304697601\nHe 1.664416592686272 0.5275857304697601 -0.5275857304697601\nHe -1.664416592686272 0.5275857304697601 -0.5275857304697601\nHe 1.664416592686272 -0.5275857304697601 0.5275857304697601\nHe -1.664416592686272 -0.5275857304697601 0.5275857304697601\nHe 1.664416592686272 -0.5275857304697601 -0.5275857304697601\nHe -1.664416592686272 -0.5275857304697601 -0.5275857304697601\nHe 0.8111206117980606 0.8111206117980606 1.4181476320301354\nHe 0.8111206117980606 0.8111206117980606 -1.4181476320301354\nHe 0.8111206117980606 -0.8111206117980606 1.4181476320301354\nHe 0.8111206117980606 -0.8111206117980606 -1.4181476320301354\nHe -0.8111206117980606 0.8111206117980606 1.4181476320301354\nHe -0.8111206117980606 0.8111206117980606 -1.4181476320301354\nHe -0.8111206117980606 -0.8111206117980606 1.4181476320301354\nHe -0.8111206117980606 -0.8111206117980606 -1.4181476320301354\nHe 0.8111206117980606 1.4181476320301354 0.8111206117980606\nHe 0.8111206117980606 -1.4181476320301354 0.8111206117980606\nHe 0.8111206117980606 1.4181476320301354 -0.8111206117980606\nHe 0.8111206117980606 -1.4181476320301354 -0.8111206117980606\nHe -0.8111206117980606 1.4181476320301354 0.8111206117980606\nHe -0.8111206117980606 -1.4181476320301354 0.8111206117980606\nHe -0.8111206117980606 1.4181476320301354 -0.8111206117980606\nHe -0.8111206117980606 -1.4181476320301354 -0.8111206117980606\nHe 1.4181476320301354 0.8111206117980606 0.8111206117980606\nHe -1.4181476320301354 0.8111206117980606 0.8111206117980606\nHe 1.4181476320301354 0.8111206117980606 -0.8111206117980606\nHe -1.4181476320301354 0.8111206117980606 -0.8111206117980606\nHe 1.4181476320301354 -0.8111206117980606 0.8111206117980606\nHe -1.4181476320301354 -0.8111206117980606 0.8111206117980606\nHe 1.4181476320301354 -0.8111206117980606 -0.8111206117980606\nHe -1.4181476320301354 -0.8111206117980606 -0.8111206117980606\nHe 0.23699878565137222 0.23699878565137222 1.79294148013803\nHe 0.23699878565137222 0.23699878565137222 -1.79294148013803\nHe 0.23699878565137222 -0.23699878565137222 1.79294148013803\nHe 0.23699878565137222 -0.23699878565137222 -1.79294148013803\nHe -0.23699878565137222 0.23699878565137222 1.79294148013803\nHe -0.23699878565137222 0.23699878565137222 -1.79294148013803\nHe -0.23699878565137222 -0.23699878565137222 1.79294148013803\nHe -0.23699878565137222 -0.23699878565137222 -1.79294148013803\nHe 0.23699878565137222 1.79294148013803 0.23699878565137222\nHe 0.23699878565137222 -1.79294148013803 0.23699878565137222\nHe 0.23699878565137222 1.79294148013803 -0.23699878565137222\nHe 0.23699878565137222 -1.79294148013803 -0.23699878565137222\nHe -0.23699878565137222 1.79294148013803 0.23699878565137222\nHe -0.23699878565137222 -1.79294148013803 0.23699878565137222\nHe -0.23699878565137222 1.79294148013803 -0.23699878565137222\nHe -0.23699878565137222 -1.79294148013803 -0.23699878565137222\nHe 1.79294148013803 0.23699878565137222 0.23699878565137222\nHe -1.79294148013803 0.23699878565137222 0.23699878565137222\nHe 1.79294148013803 0.23699878565137222 -0.23699878565137222\nHe -1.79294148013803 0.23699878565137222 -0.23699878565137222\nHe 1.79294148013803 -0.23699878565137222 0.23699878565137222\nHe -1.79294148013803 -0.23699878565137222 0.23699878565137222\nHe 1.79294148013803 -0.23699878565137222 -0.23699878565137222\nHe -1.79294148013803 -0.23699878565137222 -0.23699878565137222\nHe 0.6306848808442981 1.7114942538829672 0.0\nHe 0.6306848808442981 -1.7114942538829672 0.0\nHe -0.6306848808442981 1.7114942538829672 0.0\nHe -0.6306848808442981 -1.7114942538829672 0.0\nHe 1.7114942538829672 0.6306848808442981 0.0\nHe 1.7114942538829672 -0.6306848808442981 0.0\nHe -1.7114942538829672 0.6306848808442981 0.0\nHe -1.7114942538829672 -0.6306848808442981 0.0\nHe 0.6306848808442981 0.0 1.7114942538829672\nHe 0.6306848808442981 0.0 -1.7114942538829672\nHe -0.6306848808442981 0.0 1.7114942538829672\nHe -0.6306848808442981 0.0 -1.7114942538829672\nHe 1.7114942538829672 0.0 0.6306848808442981\nHe 1.7114942538829672 0.0 -0.6306848808442981\nHe -1.7114942538829672 0.0 0.6306848808442981\nHe -1.7114942538829672 0.0 -0.6306848808442981\nHe 0.0 0.6306848808442981 1.7114942538829672\nHe 0.0 0.6306848808442981 -1.7114942538829672\nHe 0.0 -0.6306848808442981 1.7114942538829672\nHe 0.0 -0.6306848808442981 -1.7114942538829672\nHe 0.0 1.7114942538829672 0.6306848808442981\nHe 0.0 1.7114942538829672 -0.6306848808442981\nHe 0.0 -1.7114942538829672 0.6306848808442981\nHe 0.0 -1.7114942538829672 -0.6306848808442981\nHe 0.29009208002195586 1.5249296922400049 -0.957816276137203\nHe 0.29009208002195586 -1.5249296922400049 -0.957816276137203\nHe -0.29009208002195586 1.5249296922400049 -0.957816276137203\nHe -0.29009208002195586 -1.5249296922400049 -0.957816276137203\nHe 0.29009208002195586 0.957816276137203 1.5249296922400049\nHe 0.29009208002195586 0.957816276137203 -1.5249296922400049\nHe 0.29009208002195586 -0.957816276137203 1.5249296922400049\nHe 0.29009208002195586 -0.957816276137203 -1.5249296922400049\nHe -0.29009208002195586 0.957816276137203 1.5249296922400049\nHe -0.29009208002195586 0.957816276137203 -1.5249296922400049\nHe -0.29009208002195586 -0.957816276137203 1.5249296922400049\nHe -0.29009208002195586 -0.957816276137203 -1.5249296922400049\nHe 1.5249296922400049 0.29009208002195586 0.957816276137203\nHe 1.5249296922400049 0.29009208002195586 -0.957816276137203\nHe 1.5249296922400049 -0.29009208002195586 0.957816276137203\nHe 1.5249296922400049 -0.29009208002195586 -0.957816276137203\nHe -1.5249296922400049 0.29009208002195586 0.957816276137203\nHe -1.5249296922400049 0.29009208002195586 -0.957816276137203\nHe -1.5249296922400049 -0.29009208002195586 0.957816276137203\nHe -1.5249296922400049 -0.29009208002195586 -0.957816276137203\nHe 1.5249296922400049 0.957816276137203 0.29009208002195586\nHe 1.5249296922400049 0.957816276137203 -0.29009208002195586\nHe 1.5249296922400049 -0.957816276137203 0.29009208002195586\nHe 1.5249296922400049 -0.957816276137203 -0.29009208002195586\nHe -1.5249296922400049 0.957816276137203 0.29009208002195586\nHe -1.5249296922400049 0.957816276137203 -0.29009208002195586\nHe -1.5249296922400049 -0.957816276137203 0.29009208002195586\nHe -1.5249296922400049 -0.957816276137203 -0.29009208002195586\nHe 0.957816276137203 0.29009208002195586 1.5249296922400049\nHe 0.957816276137203 0.29009208002195586 -1.5249296922400049\nHe 0.957816276137203 -0.29009208002195586 1.5249296922400049\nHe 0.957816276137203 -0.29009208002195586 -1.5249296922400049\nHe -0.957816276137203 0.29009208002195586 1.5249296922400049\nHe -0.957816276137203 0.29009208002195586 -1.5249296922400049\nHe -0.957816276137203 -0.29009208002195586 1.5249296922400049\nHe -0.957816276137203 -0.29009208002195586 -1.5249296922400049\nHe 0.957816276137203 1.5249296922400049 0.29009208002195586\nHe 0.957816276137203 1.5249296922400049 -0.29009208002195586\nHe 0.957816276137203 -1.5249296922400049 0.29009208002195586\nHe 0.957816276137203 -1.5249296922400049 -0.29009208002195586\nHe -0.957816276137203 1.5249296922400049 0.29009208002195586\nHe -0.957816276137203 1.5249296922400049 -0.29009208002195586\nHe -0.957816276137203 -1.5249296922400049 0.29009208002195586\nHe -0.957816276137203 -1.5249296922400049 -0.29009208002195586\nHe 0.0 2.060848095288 0.582094932012\nHe 0.0 0.740848095288 1.9020949320120002\nHe 0.0 1.6742290464542426 1.5154758831782429\nHe 0.0 1.6742290464542426 -0.3512860191542426\nHe 0.9333809511662426 0.740848095288 1.5154758831782429\nHe -0.9333809511662426 0.740848095288 1.5154758831782429\nHe 0.9333809511662426 1.6742290464542426 0.582094932012\nHe -0.9333809511662426 1.6742290464542426 0.582094932012\nHe 0.7621023553303061 1.502950450618306 1.3441972873423063\nHe 0.7621023553303061 1.502950450618306 -0.18000742331830605\nHe -0.7621023553303061 1.502950450618306 1.3441972873423063\nHe -0.7621023553303061 1.502950450618306 -0.18000742331830605\nHe 0.8861124944357698 1.6269605897237698 0.996834964333014\nHe 0.8861124944357698 1.6269605897237698 0.1673548996909861\nHe -0.8861124944357698 1.6269605897237698 0.996834964333014\nHe -0.8861124944357698 1.6269605897237698 0.1673548996909861\nHe 0.8861124944357698 1.1555881276090139 1.4682074264477698\nHe 0.8861124944357698 0.326108062966986 1.4682074264477698\nHe -0.8861124944357698 1.1555881276090139 1.4682074264477698\nHe -0.8861124944357698 0.326108062966986 1.4682074264477698\nHe 0.4147400323210139 1.6269605897237698 1.4682074264477698\nHe -0.4147400323210139 1.6269605897237698 1.4682074264477698\nHe 0.4147400323210139 1.6269605897237698 -0.30401756242376976\nHe -0.4147400323210139 1.6269605897237698 -0.30401756242376976\nHe 0.381805462839958 1.1226535581279578 1.7866069398770654\nHe 0.381805462839958 0.35904263244804197 1.7866069398770654\nHe -0.381805462839958 1.1226535581279578 1.7866069398770654\nHe -0.381805462839958 0.35904263244804197 1.7866069398770654\nHe 0.381805462839958 1.9453601031530654 0.963900394851958\nHe 0.381805462839958 1.9453601031530654 0.20028946917204207\nHe -0.381805462839958 1.9453601031530654 0.963900394851958\nHe -0.381805462839958 1.9453601031530654 0.20028946917204207\nHe 1.2045120078650655 1.1226535581279578 0.963900394851958\nHe -1.2045120078650655 1.1226535581279578 0.963900394851958\nHe 1.2045120078650655 1.1226535581279578 0.20028946917204207\nHe -1.2045120078650655 1.1226535581279578 0.20028946917204207\nHe 1.2045120078650655 0.35904263244804197 0.963900394851958\nHe -1.2045120078650655 0.35904263244804197 0.963900394851958\nHe 0.5869951795907017 1.3278432748787017 1.6083859815074926\nHe 0.5869951795907017 0.15385291569729823 1.6083859815074926\nHe -0.5869951795907017 1.3278432748787017 1.6083859815074926\nHe -0.5869951795907017 0.15385291569729823 1.6083859815074926\nHe 0.5869951795907017 1.7671391447834925 1.1690901116027017\nHe 0.5869951795907017 1.7671391447834925 -0.004900247578701679\nHe -0.5869951795907017 1.7671391447834925 1.1690901116027017\nHe -0.5869951795907017 1.7671391447834925 -0.004900247578701679\nHe 1.0262910494954927 1.3278432748787017 1.1690901116027017\nHe -1.0262910494954927 1.3278432748787017 1.1690901116027017\nHe 1.0262910494954927 1.3278432748787017 -0.004900247578701679\nHe -1.0262910494954927 1.3278432748787017 -0.004900247578701679\nHe 1.0262910494954927 0.15385291569729823 1.1690901116027017\nHe -1.0262910494954927 0.15385291569729823 1.1690901116027017\nHe 0.17151227908980887 0.9123603743778088 1.8796183715855743\nHe 0.17151227908980887 0.5693358161981911 1.8796183715855743\nHe -0.17151227908980887 0.9123603743778088 1.8796183715855743\nHe -0.17151227908980887 0.5693358161981911 1.8796183715855743\nHe 0.17151227908980887 2.0383715348615743 0.753607211101809\nHe 0.17151227908980887 2.0383715348615743 0.4105826529221912\nHe -0.17151227908980887 2.0383715348615743 0.753607211101809\nHe -0.17151227908980887 2.0383715348615743 0.4105826529221912\nHe 1.2975234395735742 0.9123603743778088 0.753607211101809\nHe -1.2975234395735742 0.9123603743778088 0.753607211101809\nHe 1.2975234395735742 0.9123603743778088 0.4105826529221912\nHe -1.2975234395735742 0.9123603743778088 0.4105826529221912\nHe 1.2975234395735742 0.5693358161981911 0.753607211101809\nHe -1.2975234395735742 0.5693358161981911 0.753607211101809\nHe 0.45641669008468944 1.9794294632296208 0.582094932012\nHe -0.45641669008468944 1.9794294632296208 0.582094932012\nHe 1.2385813679416209 1.1972647853726892 0.582094932012\nHe -1.2385813679416209 1.1972647853726892 0.582094932012\nHe 0.45641669008468944 0.740848095288 1.8206762999536208\nHe -0.45641669008468944 0.740848095288 1.8206762999536208\nHe 1.2385813679416209 0.740848095288 1.0385116220966895\nHe -1.2385813679416209 0.740848095288 1.0385116220966895\nHe 0.0 1.1972647853726892 1.8206762999536208\nHe 0.0 0.2844314052033105 1.8206762999536208\nHe 0.0 1.9794294632296208 1.0385116220966895\nHe 0.0 1.9794294632296208 0.1256782419273106\nHe 0.20993505791062597 1.8444156357248458 1.2752514476376073\nHe 0.20993505791062597 1.8444156357248458 -0.11106158361360742\nHe -0.20993505791062597 1.8444156357248458 1.2752514476376073\nHe -0.20993505791062597 1.8444156357248458 -0.11106158361360742\nHe 0.20993505791062597 1.4340046109136073 1.6856624724488458\nHe 0.20993505791062597 0.047691579662392486 1.6856624724488458\nHe -0.20993505791062597 1.4340046109136073 1.6856624724488458\nHe -0.20993505791062597 0.047691579662392486 1.6856624724488458\nHe 1.1035675404368457 0.9507831531986258 1.2752514476376073\nHe 1.1035675404368457 0.530913037377374 1.2752514476376073\nHe -1.1035675404368457 0.9507831531986258 1.2752514476376073\nHe -1.1035675404368457 0.530913037377374 1.2752514476376073\nHe 1.1035675404368457 1.4340046109136073 0.792029989922626\nHe 1.1035675404368457 1.4340046109136073 0.3721598741013741\nHe -1.1035675404368457 1.4340046109136073 0.792029989922626\nHe -1.1035675404368457 1.4340046109136073 0.3721598741013741\nHe 0.6931565156256074 0.9507831531986258 1.6856624724488458\nHe 0.6931565156256074 0.530913037377374 1.6856624724488458\nHe -0.6931565156256074 0.9507831531986258 1.6856624724488458\nHe -0.6931565156256074 0.530913037377374 1.6856624724488458\nHe 0.6931565156256074 1.8444156357248458 0.792029989922626\nHe 0.6931565156256074 1.8444156357248458 0.3721598741013741\nHe -0.6931565156256074 1.8444156357248458 0.792029989922626\nHe -0.6931565156256074 1.8444156357248458 0.3721598741013741\nHe 0.0 -2.060848095288 0.582094932012\nHe 0.0 -0.740848095288 1.9020949320120002\nHe 0.0 -1.6742290464542426 1.5154758831782429\nHe 0.0 -1.6742290464542426 -0.3512860191542426\nHe 0.9333809511662426 -0.740848095288 1.5154758831782429\nHe -0.9333809511662426 -0.740848095288 1.5154758831782429\nHe 0.9333809511662426 -1.6742290464542426 0.582094932012\nHe -0.9333809511662426 -1.6742290464542426 0.582094932012\nHe 0.7621023553303061 -1.502950450618306 1.3441972873423063\nHe 0.7621023553303061 -1.502950450618306 -0.18000742331830605\nHe -0.7621023553303061 -1.502950450618306 1.3441972873423063\nHe -0.7621023553303061 -1.502950450618306 -0.18000742331830605\nHe 0.8861124944357698 -1.6269605897237698 0.996834964333014\nHe 0.8861124944357698 -1.6269605897237698 0.1673548996909861\nHe -0.8861124944357698 -1.6269605897237698 0.996834964333014\nHe -0.8861124944357698 -1.6269605897237698 0.1673548996909861\nHe 0.8861124944357698 -0.326108062966986 1.4682074264477698\nHe 0.8861124944357698 -1.1555881276090139 1.4682074264477698\nHe -0.8861124944357698 -0.326108062966986 1.4682074264477698\nHe -0.8861124944357698 -1.1555881276090139 1.4682074264477698\nHe 0.4147400323210139 -1.6269605897237698 1.4682074264477698\nHe -0.4147400323210139 -1.6269605897237698 1.4682074264477698\nHe 0.4147400323210139 -1.6269605897237698 -0.30401756242376976\nHe -0.4147400323210139 -1.6269605897237698 -0.30401756242376976\nHe 0.381805462839958 -0.35904263244804197 1.7866069398770654\nHe 0.381805462839958 -1.1226535581279578 1.7866069398770654\nHe -0.381805462839958 -0.35904263244804197 1.7866069398770654\nHe -0.381805462839958 -1.1226535581279578 1.7866069398770654\nHe 0.381805462839958 -1.9453601031530654 0.963900394851958\nHe 0.381805462839958 -1.9453601031530654 0.20028946917204207\nHe -0.381805462839958 -1.9453601031530654 0.963900394851958\nHe -0.381805462839958 -1.9453601031530654 0.20028946917204207\nHe 1.2045120078650655 -0.35904263244804197 0.963900394851958\nHe -1.2045120078650655 -0.35904263244804197 0.963900394851958\nHe 1.2045120078650655 -1.1226535581279578 0.963900394851958\nHe -1.2045120078650655 -1.1226535581279578 0.963900394851958\nHe 1.2045120078650655 -1.1226535581279578 0.20028946917204207\nHe -1.2045120078650655 -1.1226535581279578 0.20028946917204207\nHe 0.5869951795907017 -0.15385291569729823 1.6083859815074926\nHe 0.5869951795907017 -1.3278432748787017 1.6083859815074926\nHe -0.5869951795907017 -0.15385291569729823 1.6083859815074926\nHe -0.5869951795907017 -1.3278432748787017 1.6083859815074926\nHe 0.5869951795907017 -1.7671391447834925 1.1690901116027017\nHe 0.5869951795907017 -1.7671391447834925 -0.004900247578701679\nHe -0.5869951795907017 -1.7671391447834925 1.1690901116027017\nHe -0.5869951795907017 -1.7671391447834925 -0.004900247578701679\nHe 1.0262910494954927 -0.15385291569729823 1.1690901116027017\nHe -1.0262910494954927 -0.15385291569729823 1.1690901116027017\nHe 1.0262910494954927 -1.3278432748787017 1.1690901116027017\nHe -1.0262910494954927 -1.3278432748787017 1.1690901116027017\nHe 1.0262910494954927 -1.3278432748787017 -0.004900247578701679\nHe -1.0262910494954927 -1.3278432748787017 -0.004900247578701679\nHe 0.17151227908980887 -0.5693358161981911 1.8796183715855743\nHe 0.17151227908980887 -0.9123603743778088 1.8796183715855743\nHe -0.17151227908980887 -0.5693358161981911 1.8796183715855743\nHe -0.17151227908980887 -0.9123603743778088 1.8796183715855743\nHe 0.17151227908980887 -2.0383715348615743 0.753607211101809\nHe 0.17151227908980887 -2.0383715348615743 0.4105826529221912\nHe -0.17151227908980887 -2.0383715348615743 0.753607211101809\nHe -0.17151227908980887 -2.0383715348615743 0.4105826529221912\nHe 1.2975234395735742 -0.5693358161981911 0.753607211101809\nHe -1.2975234395735742 -0.5693358161981911 0.753607211101809\nHe 1.2975234395735742 -0.9123603743778088 0.753607211101809\nHe -1.2975234395735742 -0.9123603743778088 0.753607211101809\nHe 1.2975234395735742 -0.9123603743778088 0.4105826529221912\nHe -1.2975234395735742 -0.9123603743778088 0.4105826529221912\nHe 0.45641669008468944 -1.9794294632296208 0.582094932012\nHe -0.45641669008468944 -1.9794294632296208 0.582094932012\nHe 1.2385813679416209 -1.1972647853726892 0.582094932012\nHe -1.2385813679416209 -1.1972647853726892 0.582094932012\nHe 0.45641669008468944 -0.740848095288 1.8206762999536208\nHe -0.45641669008468944 -0.740848095288 1.8206762999536208\nHe 1.2385813679416209 -0.740848095288 1.0385116220966895\nHe -1.2385813679416209 -0.740848095288 1.0385116220966895\nHe 0.0 -0.2844314052033105 1.8206762999536208\nHe 0.0 -1.1972647853726892 1.8206762999536208\nHe 0.0 -1.9794294632296208 1.0385116220966895\nHe 0.0 -1.9794294632296208 0.1256782419273106\nHe 0.20993505791062597 -1.8444156357248458 1.2752514476376073\nHe 0.20993505791062597 -1.8444156357248458 -0.11106158361360742\nHe -0.20993505791062597 -1.8444156357248458 1.2752514476376073\nHe -0.20993505791062597 -1.8444156357248458 -0.11106158361360742\nHe 0.20993505791062597 -0.047691579662392486 1.6856624724488458\nHe 0.20993505791062597 -1.4340046109136073 1.6856624724488458\nHe -0.20993505791062597 -0.047691579662392486 1.6856624724488458\nHe -0.20993505791062597 -1.4340046109136073 1.6856624724488458\nHe 1.1035675404368457 -0.530913037377374 1.2752514476376073\nHe 1.1035675404368457 -0.9507831531986258 1.2752514476376073\nHe -1.1035675404368457 -0.530913037377374 1.2752514476376073\nHe -1.1035675404368457 -0.9507831531986258 1.2752514476376073\nHe 1.1035675404368457 -1.4340046109136073 0.792029989922626\nHe 1.1035675404368457 -1.4340046109136073 0.3721598741013741\nHe -1.1035675404368457 -1.4340046109136073 0.792029989922626\nHe -1.1035675404368457 -1.4340046109136073 0.3721598741013741\nHe 0.6931565156256074 -0.530913037377374 1.6856624724488458\nHe 0.6931565156256074 -0.9507831531986258 1.6856624724488458\nHe -0.6931565156256074 -0.530913037377374 1.6856624724488458\nHe -0.6931565156256074 -0.9507831531986258 1.6856624724488458\nHe 0.6931565156256074 -1.8444156357248458 0.792029989922626\nHe 0.6931565156256074 -1.8444156357248458 0.3721598741013741\nHe -0.6931565156256074 -1.8444156357248458 0.792029989922626\nHe -0.6931565156256074 -1.8444156357248458 0.3721598741013741\n","xyz");
	viewer_1763995690609039.setStyle({"elem": "He"},{"sphere": {"radius": 0.05, "color": "red", "opacity": 0.5}});
	viewer_1763995690609039.zoomTo();
viewer_1763995690609039.render();
});
</script></div></div>
</div>
<p>Note that each sphere radius is determined by the element’s van der Waals (vDW) radius, making the oxygen sphere the largest and the dominant contributor to the total surface area.</p>
<p>We can define a function to visualize the full atomic spheres, as opposed to the clipped ones used in the actual grid construction.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">veloxchem.veloxchemlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">gen_lebedev_grid</span>

<span class="k">def</span><span class="w"> </span><span class="nf">raw_grid</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">grid_per_sphere</span><span class="p">,</span> <span class="n">scaling_factor</span><span class="o">=</span><span class="mf">1.2</span><span class="p">):</span>
    <span class="n">cpcm_drv</span><span class="o">.</span><span class="n">grid_per_sphere</span> <span class="o">=</span> <span class="n">grid_per_sphere</span>
    <span class="n">unit_grid</span> <span class="o">=</span> <span class="n">gen_lebedev_grid</span><span class="p">(</span><span class="n">grid_per_sphere</span><span class="p">)</span>
    <span class="n">unit_grid_coords</span> <span class="o">=</span> <span class="n">unit_grid</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">unit_grid_weights</span> <span class="o">=</span> <span class="n">unit_grid</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:]</span>
    <span class="n">unit_grid_weights</span> <span class="o">*=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

    <span class="n">zeta</span> <span class="o">=</span> <span class="n">cpcm_drv</span><span class="o">.</span><span class="n">get_zeta_dict</span><span class="p">()[</span><span class="n">grid_per_sphere</span><span class="p">]</span>
    <span class="n">atom_coords</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">get_coordinates_in_bohr</span><span class="p">()</span>
    <span class="n">atom_radii</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">vdw_radii_to_numpy</span><span class="p">()</span> <span class="o">*</span> <span class="n">scaling_factor</span>

    <span class="n">cpcm_grid_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">number_of_atoms</span><span class="p">()):</span>
        <span class="c1"># scale and shift unit grid</span>
        <span class="n">atom_grid_coords</span> <span class="o">=</span> <span class="n">unit_grid_coords</span> <span class="o">*</span> <span class="n">atom_radii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">atom_coords</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">grid_zeta</span> <span class="o">=</span> <span class="n">zeta</span> <span class="o">/</span> <span class="p">(</span><span class="n">atom_radii</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">unit_grid_weights</span><span class="p">))</span>
        <span class="n">atom_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">grid_zeta</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="n">atom_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
            <span class="p">(</span><span class="n">atom_grid_coords</span><span class="p">,</span> <span class="n">unit_grid_weights</span><span class="p">,</span> <span class="n">grid_zeta</span><span class="p">,</span> <span class="n">atom_idx</span><span class="p">))</span>
        <span class="n">cpcm_grid_raw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">cpcm_grid_raw</span><span class="p">,</span> <span class="n">atom_grid</span><span class="p">))</span>

    <span class="n">sw_func_raw</span> <span class="o">=</span> <span class="n">cpcm_drv</span><span class="o">.</span><span class="n">get_switching_function</span><span class="p">(</span><span class="n">atom_coords</span><span class="p">,</span> <span class="n">atom_radii</span><span class="p">,</span> <span class="n">cpcm_grid_raw</span><span class="p">)</span>
    <span class="n">sw_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">sw_func_raw</span> <span class="o">&gt;</span> <span class="mf">1.0e-8</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cpcm_grid_raw</span><span class="p">,</span> <span class="n">sw_func_raw</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">full_grid</span><span class="p">,</span> <span class="n">full_sw_f</span> <span class="o">=</span> <span class="n">raw_grid</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">grid_per_sphere</span><span class="p">)</span>
<span class="n">cpcm_drv</span><span class="o">.</span><span class="n">visualize_cpcm_grid</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">full_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div id="3dmolviewer_17639956906300852"  style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_17639956906300852" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdn.jsdelivr.net/npm/3dmol@2.5.0/build/3Dmol-min.js');
}

var viewer_17639956906300852 = null;
var warn = document.getElementById("3dmolwarning_17639956906300852");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_17639956906300852 = $3Dmol.createViewer(document.getElementById("3dmolviewer_17639956906300852"),{backgroundColor:"white"});
viewer_17639956906300852.zoomTo();
	viewer_17639956906300852.addModel("3\n\nO              0.000000000000         0.000000000000         0.000000000000\nH              0.000000000000         0.740848095288         0.582094932012\nH              0.000000000000        -0.740848095288         0.582094932012\n","xyz");
	viewer_17639956906300852.setStyle({"stick": {}});
	viewer_17639956906300852.addModel("582\n\nHe 1.824 0.0 0.0\nHe -1.824 0.0 0.0\nHe 0.0 1.824 0.0\nHe 0.0 -1.824 0.0\nHe 0.0 0.0 1.824\nHe 0.0 0.0 -1.824\nHe 0.0 1.2897627688842626 1.2897627688842626\nHe 0.0 1.2897627688842626 -1.2897627688842626\nHe 0.0 -1.2897627688842626 1.2897627688842626\nHe 0.0 -1.2897627688842626 -1.2897627688842626\nHe 1.2897627688842626 0.0 1.2897627688842626\nHe 1.2897627688842626 0.0 -1.2897627688842626\nHe -1.2897627688842626 0.0 1.2897627688842626\nHe -1.2897627688842626 0.0 -1.2897627688842626\nHe 1.2897627688842626 1.2897627688842626 0.0\nHe 1.2897627688842626 -1.2897627688842626 0.0\nHe -1.2897627688842626 1.2897627688842626 0.0\nHe -1.2897627688842626 -1.2897627688842626 0.0\nHe 1.0530868910018776 1.0530868910018776 1.0530868910018776\nHe 1.0530868910018776 1.0530868910018776 -1.0530868910018776\nHe 1.0530868910018776 -1.0530868910018776 1.0530868910018776\nHe 1.0530868910018776 -1.0530868910018776 -1.0530868910018776\nHe -1.0530868910018776 1.0530868910018776 1.0530868910018776\nHe -1.0530868910018776 1.0530868910018776 -1.0530868910018776\nHe -1.0530868910018776 -1.0530868910018776 1.0530868910018776\nHe -1.0530868910018776 -1.0530868910018776 -1.0530868910018776\nHe 1.2244463559476093 1.2244463559476093 0.5730953173890374\nHe 1.2244463559476093 1.2244463559476093 -0.5730953173890374\nHe 1.2244463559476093 -1.2244463559476093 0.5730953173890374\nHe 1.2244463559476093 -1.2244463559476093 -0.5730953173890374\nHe -1.2244463559476093 1.2244463559476093 0.5730953173890374\nHe -1.2244463559476093 1.2244463559476093 -0.5730953173890374\nHe -1.2244463559476093 -1.2244463559476093 0.5730953173890374\nHe -1.2244463559476093 -1.2244463559476093 -0.5730953173890374\nHe 1.2244463559476093 0.5730953173890374 1.2244463559476093\nHe 1.2244463559476093 -0.5730953173890374 1.2244463559476093\nHe 1.2244463559476093 0.5730953173890374 -1.2244463559476093\nHe 1.2244463559476093 -0.5730953173890374 -1.2244463559476093\nHe -1.2244463559476093 0.5730953173890374 1.2244463559476093\nHe -1.2244463559476093 -0.5730953173890374 1.2244463559476093\nHe -1.2244463559476093 0.5730953173890374 -1.2244463559476093\nHe -1.2244463559476093 -0.5730953173890374 -1.2244463559476093\nHe 0.5730953173890374 1.2244463559476093 1.2244463559476093\nHe -0.5730953173890374 1.2244463559476093 1.2244463559476093\nHe 0.5730953173890374 1.2244463559476093 -1.2244463559476093\nHe -0.5730953173890374 1.2244463559476093 -1.2244463559476093\nHe 0.5730953173890374 -1.2244463559476093 1.2244463559476093\nHe -0.5730953173890374 -1.2244463559476093 1.2244463559476093\nHe 0.5730953173890374 -1.2244463559476093 -1.2244463559476093\nHe -0.5730953173890374 -1.2244463559476093 -1.2244463559476093\nHe 0.5275857304697601 0.5275857304697601 1.664416592686272\nHe 0.5275857304697601 0.5275857304697601 -1.664416592686272\nHe 0.5275857304697601 -0.5275857304697601 1.664416592686272\nHe 0.5275857304697601 -0.5275857304697601 -1.664416592686272\nHe -0.5275857304697601 0.5275857304697601 1.664416592686272\nHe -0.5275857304697601 0.5275857304697601 -1.664416592686272\nHe -0.5275857304697601 -0.5275857304697601 1.664416592686272\nHe -0.5275857304697601 -0.5275857304697601 -1.664416592686272\nHe 0.5275857304697601 1.664416592686272 0.5275857304697601\nHe 0.5275857304697601 -1.664416592686272 0.5275857304697601\nHe 0.5275857304697601 1.664416592686272 -0.5275857304697601\nHe 0.5275857304697601 -1.664416592686272 -0.5275857304697601\nHe -0.5275857304697601 1.664416592686272 0.5275857304697601\nHe -0.5275857304697601 -1.664416592686272 0.5275857304697601\nHe -0.5275857304697601 1.664416592686272 -0.5275857304697601\nHe -0.5275857304697601 -1.664416592686272 -0.5275857304697601\nHe 1.664416592686272 0.5275857304697601 0.5275857304697601\nHe -1.664416592686272 0.5275857304697601 0.5275857304697601\nHe 1.664416592686272 0.5275857304697601 -0.5275857304697601\nHe -1.664416592686272 0.5275857304697601 -0.5275857304697601\nHe 1.664416592686272 -0.5275857304697601 0.5275857304697601\nHe -1.664416592686272 -0.5275857304697601 0.5275857304697601\nHe 1.664416592686272 -0.5275857304697601 -0.5275857304697601\nHe -1.664416592686272 -0.5275857304697601 -0.5275857304697601\nHe 0.8111206117980606 0.8111206117980606 1.4181476320301354\nHe 0.8111206117980606 0.8111206117980606 -1.4181476320301354\nHe 0.8111206117980606 -0.8111206117980606 1.4181476320301354\nHe 0.8111206117980606 -0.8111206117980606 -1.4181476320301354\nHe -0.8111206117980606 0.8111206117980606 1.4181476320301354\nHe -0.8111206117980606 0.8111206117980606 -1.4181476320301354\nHe -0.8111206117980606 -0.8111206117980606 1.4181476320301354\nHe -0.8111206117980606 -0.8111206117980606 -1.4181476320301354\nHe 0.8111206117980606 1.4181476320301354 0.8111206117980606\nHe 0.8111206117980606 -1.4181476320301354 0.8111206117980606\nHe 0.8111206117980606 1.4181476320301354 -0.8111206117980606\nHe 0.8111206117980606 -1.4181476320301354 -0.8111206117980606\nHe -0.8111206117980606 1.4181476320301354 0.8111206117980606\nHe -0.8111206117980606 -1.4181476320301354 0.8111206117980606\nHe -0.8111206117980606 1.4181476320301354 -0.8111206117980606\nHe -0.8111206117980606 -1.4181476320301354 -0.8111206117980606\nHe 1.4181476320301354 0.8111206117980606 0.8111206117980606\nHe -1.4181476320301354 0.8111206117980606 0.8111206117980606\nHe 1.4181476320301354 0.8111206117980606 -0.8111206117980606\nHe -1.4181476320301354 0.8111206117980606 -0.8111206117980606\nHe 1.4181476320301354 -0.8111206117980606 0.8111206117980606\nHe -1.4181476320301354 -0.8111206117980606 0.8111206117980606\nHe 1.4181476320301354 -0.8111206117980606 -0.8111206117980606\nHe -1.4181476320301354 -0.8111206117980606 -0.8111206117980606\nHe 0.23699878565137222 0.23699878565137222 1.79294148013803\nHe 0.23699878565137222 0.23699878565137222 -1.79294148013803\nHe 0.23699878565137222 -0.23699878565137222 1.79294148013803\nHe 0.23699878565137222 -0.23699878565137222 -1.79294148013803\nHe -0.23699878565137222 0.23699878565137222 1.79294148013803\nHe -0.23699878565137222 0.23699878565137222 -1.79294148013803\nHe -0.23699878565137222 -0.23699878565137222 1.79294148013803\nHe -0.23699878565137222 -0.23699878565137222 -1.79294148013803\nHe 0.23699878565137222 1.79294148013803 0.23699878565137222\nHe 0.23699878565137222 -1.79294148013803 0.23699878565137222\nHe 0.23699878565137222 1.79294148013803 -0.23699878565137222\nHe 0.23699878565137222 -1.79294148013803 -0.23699878565137222\nHe -0.23699878565137222 1.79294148013803 0.23699878565137222\nHe -0.23699878565137222 -1.79294148013803 0.23699878565137222\nHe -0.23699878565137222 1.79294148013803 -0.23699878565137222\nHe -0.23699878565137222 -1.79294148013803 -0.23699878565137222\nHe 1.79294148013803 0.23699878565137222 0.23699878565137222\nHe -1.79294148013803 0.23699878565137222 0.23699878565137222\nHe 1.79294148013803 0.23699878565137222 -0.23699878565137222\nHe -1.79294148013803 0.23699878565137222 -0.23699878565137222\nHe 1.79294148013803 -0.23699878565137222 0.23699878565137222\nHe -1.79294148013803 -0.23699878565137222 0.23699878565137222\nHe 1.79294148013803 -0.23699878565137222 -0.23699878565137222\nHe -1.79294148013803 -0.23699878565137222 -0.23699878565137222\nHe 0.6306848808442981 1.7114942538829672 0.0\nHe 0.6306848808442981 -1.7114942538829672 0.0\nHe -0.6306848808442981 1.7114942538829672 0.0\nHe -0.6306848808442981 -1.7114942538829672 0.0\nHe 1.7114942538829672 0.6306848808442981 0.0\nHe 1.7114942538829672 -0.6306848808442981 0.0\nHe -1.7114942538829672 0.6306848808442981 0.0\nHe -1.7114942538829672 -0.6306848808442981 0.0\nHe 0.6306848808442981 0.0 1.7114942538829672\nHe 0.6306848808442981 0.0 -1.7114942538829672\nHe -0.6306848808442981 0.0 1.7114942538829672\nHe -0.6306848808442981 0.0 -1.7114942538829672\nHe 1.7114942538829672 0.0 0.6306848808442981\nHe 1.7114942538829672 0.0 -0.6306848808442981\nHe -1.7114942538829672 0.0 0.6306848808442981\nHe -1.7114942538829672 0.0 -0.6306848808442981\nHe 0.0 0.6306848808442981 1.7114942538829672\nHe 0.0 0.6306848808442981 -1.7114942538829672\nHe 0.0 -0.6306848808442981 1.7114942538829672\nHe 0.0 -0.6306848808442981 -1.7114942538829672\nHe 0.0 1.7114942538829672 0.6306848808442981\nHe 0.0 1.7114942538829672 -0.6306848808442981\nHe 0.0 -1.7114942538829672 0.6306848808442981\nHe 0.0 -1.7114942538829672 -0.6306848808442981\nHe 0.29009208002195586 1.5249296922400049 0.957816276137203\nHe 0.29009208002195586 1.5249296922400049 -0.957816276137203\nHe 0.29009208002195586 -1.5249296922400049 0.957816276137203\nHe 0.29009208002195586 -1.5249296922400049 -0.957816276137203\nHe -0.29009208002195586 1.5249296922400049 0.957816276137203\nHe -0.29009208002195586 1.5249296922400049 -0.957816276137203\nHe -0.29009208002195586 -1.5249296922400049 0.957816276137203\nHe -0.29009208002195586 -1.5249296922400049 -0.957816276137203\nHe 0.29009208002195586 0.957816276137203 1.5249296922400049\nHe 0.29009208002195586 0.957816276137203 -1.5249296922400049\nHe 0.29009208002195586 -0.957816276137203 1.5249296922400049\nHe 0.29009208002195586 -0.957816276137203 -1.5249296922400049\nHe -0.29009208002195586 0.957816276137203 1.5249296922400049\nHe -0.29009208002195586 0.957816276137203 -1.5249296922400049\nHe -0.29009208002195586 -0.957816276137203 1.5249296922400049\nHe -0.29009208002195586 -0.957816276137203 -1.5249296922400049\nHe 1.5249296922400049 0.29009208002195586 0.957816276137203\nHe 1.5249296922400049 0.29009208002195586 -0.957816276137203\nHe 1.5249296922400049 -0.29009208002195586 0.957816276137203\nHe 1.5249296922400049 -0.29009208002195586 -0.957816276137203\nHe -1.5249296922400049 0.29009208002195586 0.957816276137203\nHe -1.5249296922400049 0.29009208002195586 -0.957816276137203\nHe -1.5249296922400049 -0.29009208002195586 0.957816276137203\nHe -1.5249296922400049 -0.29009208002195586 -0.957816276137203\nHe 1.5249296922400049 0.957816276137203 0.29009208002195586\nHe 1.5249296922400049 0.957816276137203 -0.29009208002195586\nHe 1.5249296922400049 -0.957816276137203 0.29009208002195586\nHe 1.5249296922400049 -0.957816276137203 -0.29009208002195586\nHe -1.5249296922400049 0.957816276137203 0.29009208002195586\nHe -1.5249296922400049 0.957816276137203 -0.29009208002195586\nHe -1.5249296922400049 -0.957816276137203 0.29009208002195586\nHe -1.5249296922400049 -0.957816276137203 -0.29009208002195586\nHe 0.957816276137203 0.29009208002195586 1.5249296922400049\nHe 0.957816276137203 0.29009208002195586 -1.5249296922400049\nHe 0.957816276137203 -0.29009208002195586 1.5249296922400049\nHe 0.957816276137203 -0.29009208002195586 -1.5249296922400049\nHe -0.957816276137203 0.29009208002195586 1.5249296922400049\nHe -0.957816276137203 0.29009208002195586 -1.5249296922400049\nHe -0.957816276137203 -0.29009208002195586 1.5249296922400049\nHe -0.957816276137203 -0.29009208002195586 -1.5249296922400049\nHe 0.957816276137203 1.5249296922400049 0.29009208002195586\nHe 0.957816276137203 1.5249296922400049 -0.29009208002195586\nHe 0.957816276137203 -1.5249296922400049 0.29009208002195586\nHe 0.957816276137203 -1.5249296922400049 -0.29009208002195586\nHe -0.957816276137203 1.5249296922400049 0.29009208002195586\nHe -0.957816276137203 1.5249296922400049 -0.29009208002195586\nHe -0.957816276137203 -1.5249296922400049 0.29009208002195586\nHe -0.957816276137203 -1.5249296922400049 -0.29009208002195586\nHe 1.32 0.740848095288 0.582094932012\nHe -1.32 0.740848095288 0.582094932012\nHe 0.0 2.060848095288 0.582094932012\nHe 0.0 -0.5791519047120001 0.582094932012\nHe 0.0 0.740848095288 1.9020949320120002\nHe 0.0 0.740848095288 -0.737905067988\nHe 0.0 1.6742290464542426 1.5154758831782429\nHe 0.0 1.6742290464542426 -0.3512860191542426\nHe 0.0 -0.19253285587824273 1.5154758831782429\nHe 0.0 -0.19253285587824273 -0.3512860191542426\nHe 0.9333809511662426 0.740848095288 1.5154758831782429\nHe 0.9333809511662426 0.740848095288 -0.3512860191542426\nHe -0.9333809511662426 0.740848095288 1.5154758831782429\nHe -0.9333809511662426 0.740848095288 -0.3512860191542426\nHe 0.9333809511662426 1.6742290464542426 0.582094932012\nHe 0.9333809511662426 -0.19253285587824273 0.582094932012\nHe -0.9333809511662426 1.6742290464542426 0.582094932012\nHe -0.9333809511662426 -0.19253285587824273 0.582094932012\nHe 0.7621023553303061 1.502950450618306 1.3441972873423063\nHe 0.7621023553303061 1.502950450618306 -0.18000742331830605\nHe 0.7621023553303061 -0.021254260042306156 1.3441972873423063\nHe 0.7621023553303061 -0.021254260042306156 -0.18000742331830605\nHe -0.7621023553303061 1.502950450618306 1.3441972873423063\nHe -0.7621023553303061 1.502950450618306 -0.18000742331830605\nHe -0.7621023553303061 -0.021254260042306156 1.3441972873423063\nHe -0.7621023553303061 -0.021254260042306156 -0.18000742331830605\nHe 0.8861124944357698 1.6269605897237698 0.996834964333014\nHe 0.8861124944357698 1.6269605897237698 0.1673548996909861\nHe 0.8861124944357698 -0.14526439914776984 0.996834964333014\nHe 0.8861124944357698 -0.14526439914776984 0.1673548996909861\nHe -0.8861124944357698 1.6269605897237698 0.996834964333014\nHe -0.8861124944357698 1.6269605897237698 0.1673548996909861\nHe -0.8861124944357698 -0.14526439914776984 0.996834964333014\nHe -0.8861124944357698 -0.14526439914776984 0.1673548996909861\nHe 0.8861124944357698 1.1555881276090139 1.4682074264477698\nHe 0.8861124944357698 0.326108062966986 1.4682074264477698\nHe 0.8861124944357698 1.1555881276090139 -0.30401756242376976\nHe 0.8861124944357698 0.326108062966986 -0.30401756242376976\nHe -0.8861124944357698 1.1555881276090139 1.4682074264477698\nHe -0.8861124944357698 0.326108062966986 1.4682074264477698\nHe -0.8861124944357698 1.1555881276090139 -0.30401756242376976\nHe -0.8861124944357698 0.326108062966986 -0.30401756242376976\nHe 0.4147400323210139 1.6269605897237698 1.4682074264477698\nHe -0.4147400323210139 1.6269605897237698 1.4682074264477698\nHe 0.4147400323210139 1.6269605897237698 -0.30401756242376976\nHe -0.4147400323210139 1.6269605897237698 -0.30401756242376976\nHe 0.4147400323210139 -0.14526439914776984 1.4682074264477698\nHe -0.4147400323210139 -0.14526439914776984 1.4682074264477698\nHe 0.4147400323210139 -0.14526439914776984 -0.30401756242376976\nHe -0.4147400323210139 -0.14526439914776984 -0.30401756242376976\nHe 0.381805462839958 1.1226535581279578 1.7866069398770654\nHe 0.381805462839958 1.1226535581279578 -0.6224170758530654\nHe 0.381805462839958 0.35904263244804197 1.7866069398770654\nHe 0.381805462839958 0.35904263244804197 -0.6224170758530654\nHe -0.381805462839958 1.1226535581279578 1.7866069398770654\nHe -0.381805462839958 1.1226535581279578 -0.6224170758530654\nHe -0.381805462839958 0.35904263244804197 1.7866069398770654\nHe -0.381805462839958 0.35904263244804197 -0.6224170758530654\nHe 0.381805462839958 1.9453601031530654 0.963900394851958\nHe 0.381805462839958 -0.4636639125770655 0.963900394851958\nHe 0.381805462839958 1.9453601031530654 0.20028946917204207\nHe 0.381805462839958 -0.4636639125770655 0.20028946917204207\nHe -0.381805462839958 1.9453601031530654 0.963900394851958\nHe -0.381805462839958 -0.4636639125770655 0.963900394851958\nHe -0.381805462839958 1.9453601031530654 0.20028946917204207\nHe -0.381805462839958 -0.4636639125770655 0.20028946917204207\nHe 1.2045120078650655 1.1226535581279578 0.963900394851958\nHe -1.2045120078650655 1.1226535581279578 0.963900394851958\nHe 1.2045120078650655 1.1226535581279578 0.20028946917204207\nHe -1.2045120078650655 1.1226535581279578 0.20028946917204207\nHe 1.2045120078650655 0.35904263244804197 0.963900394851958\nHe -1.2045120078650655 0.35904263244804197 0.963900394851958\nHe 1.2045120078650655 0.35904263244804197 0.20028946917204207\nHe -1.2045120078650655 0.35904263244804197 0.20028946917204207\nHe 0.5869951795907017 1.3278432748787017 1.6083859815074926\nHe 0.5869951795907017 1.3278432748787017 -0.4441961174834926\nHe 0.5869951795907017 0.15385291569729823 1.6083859815074926\nHe 0.5869951795907017 0.15385291569729823 -0.4441961174834926\nHe -0.5869951795907017 1.3278432748787017 1.6083859815074926\nHe -0.5869951795907017 1.3278432748787017 -0.4441961174834926\nHe -0.5869951795907017 0.15385291569729823 1.6083859815074926\nHe -0.5869951795907017 0.15385291569729823 -0.4441961174834926\nHe 0.5869951795907017 1.7671391447834925 1.1690901116027017\nHe 0.5869951795907017 -0.28544295420749266 1.1690901116027017\nHe 0.5869951795907017 1.7671391447834925 -0.004900247578701679\nHe 0.5869951795907017 -0.28544295420749266 -0.004900247578701679\nHe -0.5869951795907017 1.7671391447834925 1.1690901116027017\nHe -0.5869951795907017 -0.28544295420749266 1.1690901116027017\nHe -0.5869951795907017 1.7671391447834925 -0.004900247578701679\nHe -0.5869951795907017 -0.28544295420749266 -0.004900247578701679\nHe 1.0262910494954927 1.3278432748787017 1.1690901116027017\nHe -1.0262910494954927 1.3278432748787017 1.1690901116027017\nHe 1.0262910494954927 1.3278432748787017 -0.004900247578701679\nHe -1.0262910494954927 1.3278432748787017 -0.004900247578701679\nHe 1.0262910494954927 0.15385291569729823 1.1690901116027017\nHe -1.0262910494954927 0.15385291569729823 1.1690901116027017\nHe 1.0262910494954927 0.15385291569729823 -0.004900247578701679\nHe -1.0262910494954927 0.15385291569729823 -0.004900247578701679\nHe 0.17151227908980887 0.9123603743778088 1.8796183715855743\nHe 0.17151227908980887 0.9123603743778088 -0.7154285075615742\nHe 0.17151227908980887 0.5693358161981911 1.8796183715855743\nHe 0.17151227908980887 0.5693358161981911 -0.7154285075615742\nHe -0.17151227908980887 0.9123603743778088 1.8796183715855743\nHe -0.17151227908980887 0.9123603743778088 -0.7154285075615742\nHe -0.17151227908980887 0.5693358161981911 1.8796183715855743\nHe -0.17151227908980887 0.5693358161981911 -0.7154285075615742\nHe 0.17151227908980887 2.0383715348615743 0.753607211101809\nHe 0.17151227908980887 -0.5566753442855743 0.753607211101809\nHe 0.17151227908980887 2.0383715348615743 0.4105826529221912\nHe 0.17151227908980887 -0.5566753442855743 0.4105826529221912\nHe -0.17151227908980887 2.0383715348615743 0.753607211101809\nHe -0.17151227908980887 -0.5566753442855743 0.753607211101809\nHe -0.17151227908980887 2.0383715348615743 0.4105826529221912\nHe -0.17151227908980887 -0.5566753442855743 0.4105826529221912\nHe 1.2975234395735742 0.9123603743778088 0.753607211101809\nHe -1.2975234395735742 0.9123603743778088 0.753607211101809\nHe 1.2975234395735742 0.9123603743778088 0.4105826529221912\nHe -1.2975234395735742 0.9123603743778088 0.4105826529221912\nHe 1.2975234395735742 0.5693358161981911 0.753607211101809\nHe -1.2975234395735742 0.5693358161981911 0.753607211101809\nHe 1.2975234395735742 0.5693358161981911 0.4105826529221912\nHe -1.2975234395735742 0.5693358161981911 0.4105826529221912\nHe 0.45641669008468944 1.9794294632296208 0.582094932012\nHe 0.45641669008468944 -0.49773327265362083 0.582094932012\nHe -0.45641669008468944 1.9794294632296208 0.582094932012\nHe -0.45641669008468944 -0.49773327265362083 0.582094932012\nHe 1.2385813679416209 1.1972647853726892 0.582094932012\nHe 1.2385813679416209 0.2844314052033105 0.582094932012\nHe -1.2385813679416209 1.1972647853726892 0.582094932012\nHe -1.2385813679416209 0.2844314052033105 0.582094932012\nHe 0.45641669008468944 0.740848095288 1.8206762999536208\nHe 0.45641669008468944 0.740848095288 -0.6564864359296207\nHe -0.45641669008468944 0.740848095288 1.8206762999536208\nHe -0.45641669008468944 0.740848095288 -0.6564864359296207\nHe 1.2385813679416209 0.740848095288 1.0385116220966895\nHe 1.2385813679416209 0.740848095288 0.1256782419273106\nHe -1.2385813679416209 0.740848095288 1.0385116220966895\nHe -1.2385813679416209 0.740848095288 0.1256782419273106\nHe 0.0 1.1972647853726892 1.8206762999536208\nHe 0.0 1.1972647853726892 -0.6564864359296207\nHe 0.0 0.2844314052033105 1.8206762999536208\nHe 0.0 0.2844314052033105 -0.6564864359296207\nHe 0.0 1.9794294632296208 1.0385116220966895\nHe 0.0 1.9794294632296208 0.1256782419273106\nHe 0.0 -0.49773327265362083 1.0385116220966895\nHe 0.0 -0.49773327265362083 0.1256782419273106\nHe 0.20993505791062597 1.8444156357248458 1.2752514476376073\nHe 0.20993505791062597 1.8444156357248458 -0.11106158361360742\nHe 0.20993505791062597 -0.36271944514884585 1.2752514476376073\nHe 0.20993505791062597 -0.36271944514884585 -0.11106158361360742\nHe -0.20993505791062597 1.8444156357248458 1.2752514476376073\nHe -0.20993505791062597 1.8444156357248458 -0.11106158361360742\nHe -0.20993505791062597 -0.36271944514884585 1.2752514476376073\nHe -0.20993505791062597 -0.36271944514884585 -0.11106158361360742\nHe 0.20993505791062597 1.4340046109136073 1.6856624724488458\nHe 0.20993505791062597 1.4340046109136073 -0.5214726084248458\nHe 0.20993505791062597 0.047691579662392486 1.6856624724488458\nHe 0.20993505791062597 0.047691579662392486 -0.5214726084248458\nHe -0.20993505791062597 1.4340046109136073 1.6856624724488458\nHe -0.20993505791062597 1.4340046109136073 -0.5214726084248458\nHe -0.20993505791062597 0.047691579662392486 1.6856624724488458\nHe -0.20993505791062597 0.047691579662392486 -0.5214726084248458\nHe 1.1035675404368457 0.9507831531986258 1.2752514476376073\nHe 1.1035675404368457 0.9507831531986258 -0.11106158361360742\nHe 1.1035675404368457 0.530913037377374 1.2752514476376073\nHe 1.1035675404368457 0.530913037377374 -0.11106158361360742\nHe -1.1035675404368457 0.9507831531986258 1.2752514476376073\nHe -1.1035675404368457 0.9507831531986258 -0.11106158361360742\nHe -1.1035675404368457 0.530913037377374 1.2752514476376073\nHe -1.1035675404368457 0.530913037377374 -0.11106158361360742\nHe 1.1035675404368457 1.4340046109136073 0.792029989922626\nHe 1.1035675404368457 1.4340046109136073 0.3721598741013741\nHe 1.1035675404368457 0.047691579662392486 0.792029989922626\nHe 1.1035675404368457 0.047691579662392486 0.3721598741013741\nHe -1.1035675404368457 1.4340046109136073 0.792029989922626\nHe -1.1035675404368457 1.4340046109136073 0.3721598741013741\nHe -1.1035675404368457 0.047691579662392486 0.792029989922626\nHe -1.1035675404368457 0.047691579662392486 0.3721598741013741\nHe 0.6931565156256074 0.9507831531986258 1.6856624724488458\nHe 0.6931565156256074 0.9507831531986258 -0.5214726084248458\nHe 0.6931565156256074 0.530913037377374 1.6856624724488458\nHe 0.6931565156256074 0.530913037377374 -0.5214726084248458\nHe -0.6931565156256074 0.9507831531986258 1.6856624724488458\nHe -0.6931565156256074 0.9507831531986258 -0.5214726084248458\nHe -0.6931565156256074 0.530913037377374 1.6856624724488458\nHe -0.6931565156256074 0.530913037377374 -0.5214726084248458\nHe 0.6931565156256074 1.8444156357248458 0.792029989922626\nHe 0.6931565156256074 1.8444156357248458 0.3721598741013741\nHe 0.6931565156256074 -0.36271944514884585 0.792029989922626\nHe 0.6931565156256074 -0.36271944514884585 0.3721598741013741\nHe -0.6931565156256074 1.8444156357248458 0.792029989922626\nHe -0.6931565156256074 1.8444156357248458 0.3721598741013741\nHe -0.6931565156256074 -0.36271944514884585 0.792029989922626\nHe -0.6931565156256074 -0.36271944514884585 0.3721598741013741\nHe 1.32 -0.740848095288 0.582094932012\nHe -1.32 -0.740848095288 0.582094932012\nHe 0.0 0.5791519047120001 0.582094932012\nHe 0.0 -2.060848095288 0.582094932012\nHe 0.0 -0.740848095288 1.9020949320120002\nHe 0.0 -0.740848095288 -0.737905067988\nHe 0.0 0.19253285587824273 1.5154758831782429\nHe 0.0 0.19253285587824273 -0.3512860191542426\nHe 0.0 -1.6742290464542426 1.5154758831782429\nHe 0.0 -1.6742290464542426 -0.3512860191542426\nHe 0.9333809511662426 -0.740848095288 1.5154758831782429\nHe 0.9333809511662426 -0.740848095288 -0.3512860191542426\nHe -0.9333809511662426 -0.740848095288 1.5154758831782429\nHe -0.9333809511662426 -0.740848095288 -0.3512860191542426\nHe 0.9333809511662426 0.19253285587824273 0.582094932012\nHe 0.9333809511662426 -1.6742290464542426 0.582094932012\nHe -0.9333809511662426 0.19253285587824273 0.582094932012\nHe -0.9333809511662426 -1.6742290464542426 0.582094932012\nHe 0.7621023553303061 0.021254260042306156 1.3441972873423063\nHe 0.7621023553303061 0.021254260042306156 -0.18000742331830605\nHe 0.7621023553303061 -1.502950450618306 1.3441972873423063\nHe 0.7621023553303061 -1.502950450618306 -0.18000742331830605\nHe -0.7621023553303061 0.021254260042306156 1.3441972873423063\nHe -0.7621023553303061 0.021254260042306156 -0.18000742331830605\nHe -0.7621023553303061 -1.502950450618306 1.3441972873423063\nHe -0.7621023553303061 -1.502950450618306 -0.18000742331830605\nHe 0.8861124944357698 0.14526439914776984 0.996834964333014\nHe 0.8861124944357698 0.14526439914776984 0.1673548996909861\nHe 0.8861124944357698 -1.6269605897237698 0.996834964333014\nHe 0.8861124944357698 -1.6269605897237698 0.1673548996909861\nHe -0.8861124944357698 0.14526439914776984 0.996834964333014\nHe -0.8861124944357698 0.14526439914776984 0.1673548996909861\nHe -0.8861124944357698 -1.6269605897237698 0.996834964333014\nHe -0.8861124944357698 -1.6269605897237698 0.1673548996909861\nHe 0.8861124944357698 -0.326108062966986 1.4682074264477698\nHe 0.8861124944357698 -1.1555881276090139 1.4682074264477698\nHe 0.8861124944357698 -0.326108062966986 -0.30401756242376976\nHe 0.8861124944357698 -1.1555881276090139 -0.30401756242376976\nHe -0.8861124944357698 -0.326108062966986 1.4682074264477698\nHe -0.8861124944357698 -1.1555881276090139 1.4682074264477698\nHe -0.8861124944357698 -0.326108062966986 -0.30401756242376976\nHe -0.8861124944357698 -1.1555881276090139 -0.30401756242376976\nHe 0.4147400323210139 0.14526439914776984 1.4682074264477698\nHe -0.4147400323210139 0.14526439914776984 1.4682074264477698\nHe 0.4147400323210139 0.14526439914776984 -0.30401756242376976\nHe -0.4147400323210139 0.14526439914776984 -0.30401756242376976\nHe 0.4147400323210139 -1.6269605897237698 1.4682074264477698\nHe -0.4147400323210139 -1.6269605897237698 1.4682074264477698\nHe 0.4147400323210139 -1.6269605897237698 -0.30401756242376976\nHe -0.4147400323210139 -1.6269605897237698 -0.30401756242376976\nHe 0.381805462839958 -0.35904263244804197 1.7866069398770654\nHe 0.381805462839958 -0.35904263244804197 -0.6224170758530654\nHe 0.381805462839958 -1.1226535581279578 1.7866069398770654\nHe 0.381805462839958 -1.1226535581279578 -0.6224170758530654\nHe -0.381805462839958 -0.35904263244804197 1.7866069398770654\nHe -0.381805462839958 -0.35904263244804197 -0.6224170758530654\nHe -0.381805462839958 -1.1226535581279578 1.7866069398770654\nHe -0.381805462839958 -1.1226535581279578 -0.6224170758530654\nHe 0.381805462839958 0.4636639125770655 0.963900394851958\nHe 0.381805462839958 -1.9453601031530654 0.963900394851958\nHe 0.381805462839958 0.4636639125770655 0.20028946917204207\nHe 0.381805462839958 -1.9453601031530654 0.20028946917204207\nHe -0.381805462839958 0.4636639125770655 0.963900394851958\nHe -0.381805462839958 -1.9453601031530654 0.963900394851958\nHe -0.381805462839958 0.4636639125770655 0.20028946917204207\nHe -0.381805462839958 -1.9453601031530654 0.20028946917204207\nHe 1.2045120078650655 -0.35904263244804197 0.963900394851958\nHe -1.2045120078650655 -0.35904263244804197 0.963900394851958\nHe 1.2045120078650655 -0.35904263244804197 0.20028946917204207\nHe -1.2045120078650655 -0.35904263244804197 0.20028946917204207\nHe 1.2045120078650655 -1.1226535581279578 0.963900394851958\nHe -1.2045120078650655 -1.1226535581279578 0.963900394851958\nHe 1.2045120078650655 -1.1226535581279578 0.20028946917204207\nHe -1.2045120078650655 -1.1226535581279578 0.20028946917204207\nHe 0.5869951795907017 -0.15385291569729823 1.6083859815074926\nHe 0.5869951795907017 -0.15385291569729823 -0.4441961174834926\nHe 0.5869951795907017 -1.3278432748787017 1.6083859815074926\nHe 0.5869951795907017 -1.3278432748787017 -0.4441961174834926\nHe -0.5869951795907017 -0.15385291569729823 1.6083859815074926\nHe -0.5869951795907017 -0.15385291569729823 -0.4441961174834926\nHe -0.5869951795907017 -1.3278432748787017 1.6083859815074926\nHe -0.5869951795907017 -1.3278432748787017 -0.4441961174834926\nHe 0.5869951795907017 0.28544295420749266 1.1690901116027017\nHe 0.5869951795907017 -1.7671391447834925 1.1690901116027017\nHe 0.5869951795907017 0.28544295420749266 -0.004900247578701679\nHe 0.5869951795907017 -1.7671391447834925 -0.004900247578701679\nHe -0.5869951795907017 0.28544295420749266 1.1690901116027017\nHe -0.5869951795907017 -1.7671391447834925 1.1690901116027017\nHe -0.5869951795907017 0.28544295420749266 -0.004900247578701679\nHe -0.5869951795907017 -1.7671391447834925 -0.004900247578701679\nHe 1.0262910494954927 -0.15385291569729823 1.1690901116027017\nHe -1.0262910494954927 -0.15385291569729823 1.1690901116027017\nHe 1.0262910494954927 -0.15385291569729823 -0.004900247578701679\nHe -1.0262910494954927 -0.15385291569729823 -0.004900247578701679\nHe 1.0262910494954927 -1.3278432748787017 1.1690901116027017\nHe -1.0262910494954927 -1.3278432748787017 1.1690901116027017\nHe 1.0262910494954927 -1.3278432748787017 -0.004900247578701679\nHe -1.0262910494954927 -1.3278432748787017 -0.004900247578701679\nHe 0.17151227908980887 -0.5693358161981911 1.8796183715855743\nHe 0.17151227908980887 -0.5693358161981911 -0.7154285075615742\nHe 0.17151227908980887 -0.9123603743778088 1.8796183715855743\nHe 0.17151227908980887 -0.9123603743778088 -0.7154285075615742\nHe -0.17151227908980887 -0.5693358161981911 1.8796183715855743\nHe -0.17151227908980887 -0.5693358161981911 -0.7154285075615742\nHe -0.17151227908980887 -0.9123603743778088 1.8796183715855743\nHe -0.17151227908980887 -0.9123603743778088 -0.7154285075615742\nHe 0.17151227908980887 0.5566753442855743 0.753607211101809\nHe 0.17151227908980887 -2.0383715348615743 0.753607211101809\nHe 0.17151227908980887 0.5566753442855743 0.4105826529221912\nHe 0.17151227908980887 -2.0383715348615743 0.4105826529221912\nHe -0.17151227908980887 0.5566753442855743 0.753607211101809\nHe -0.17151227908980887 -2.0383715348615743 0.753607211101809\nHe -0.17151227908980887 0.5566753442855743 0.4105826529221912\nHe -0.17151227908980887 -2.0383715348615743 0.4105826529221912\nHe 1.2975234395735742 -0.5693358161981911 0.753607211101809\nHe -1.2975234395735742 -0.5693358161981911 0.753607211101809\nHe 1.2975234395735742 -0.5693358161981911 0.4105826529221912\nHe -1.2975234395735742 -0.5693358161981911 0.4105826529221912\nHe 1.2975234395735742 -0.9123603743778088 0.753607211101809\nHe -1.2975234395735742 -0.9123603743778088 0.753607211101809\nHe 1.2975234395735742 -0.9123603743778088 0.4105826529221912\nHe -1.2975234395735742 -0.9123603743778088 0.4105826529221912\nHe 0.45641669008468944 0.49773327265362083 0.582094932012\nHe 0.45641669008468944 -1.9794294632296208 0.582094932012\nHe -0.45641669008468944 0.49773327265362083 0.582094932012\nHe -0.45641669008468944 -1.9794294632296208 0.582094932012\nHe 1.2385813679416209 -0.2844314052033105 0.582094932012\nHe 1.2385813679416209 -1.1972647853726892 0.582094932012\nHe -1.2385813679416209 -0.2844314052033105 0.582094932012\nHe -1.2385813679416209 -1.1972647853726892 0.582094932012\nHe 0.45641669008468944 -0.740848095288 1.8206762999536208\nHe 0.45641669008468944 -0.740848095288 -0.6564864359296207\nHe -0.45641669008468944 -0.740848095288 1.8206762999536208\nHe -0.45641669008468944 -0.740848095288 -0.6564864359296207\nHe 1.2385813679416209 -0.740848095288 1.0385116220966895\nHe 1.2385813679416209 -0.740848095288 0.1256782419273106\nHe -1.2385813679416209 -0.740848095288 1.0385116220966895\nHe -1.2385813679416209 -0.740848095288 0.1256782419273106\nHe 0.0 -0.2844314052033105 1.8206762999536208\nHe 0.0 -0.2844314052033105 -0.6564864359296207\nHe 0.0 -1.1972647853726892 1.8206762999536208\nHe 0.0 -1.1972647853726892 -0.6564864359296207\nHe 0.0 0.49773327265362083 1.0385116220966895\nHe 0.0 0.49773327265362083 0.1256782419273106\nHe 0.0 -1.9794294632296208 1.0385116220966895\nHe 0.0 -1.9794294632296208 0.1256782419273106\nHe 0.20993505791062597 0.36271944514884585 1.2752514476376073\nHe 0.20993505791062597 0.36271944514884585 -0.11106158361360742\nHe 0.20993505791062597 -1.8444156357248458 1.2752514476376073\nHe 0.20993505791062597 -1.8444156357248458 -0.11106158361360742\nHe -0.20993505791062597 0.36271944514884585 1.2752514476376073\nHe -0.20993505791062597 0.36271944514884585 -0.11106158361360742\nHe -0.20993505791062597 -1.8444156357248458 1.2752514476376073\nHe -0.20993505791062597 -1.8444156357248458 -0.11106158361360742\nHe 0.20993505791062597 -0.047691579662392486 1.6856624724488458\nHe 0.20993505791062597 -0.047691579662392486 -0.5214726084248458\nHe 0.20993505791062597 -1.4340046109136073 1.6856624724488458\nHe 0.20993505791062597 -1.4340046109136073 -0.5214726084248458\nHe -0.20993505791062597 -0.047691579662392486 1.6856624724488458\nHe -0.20993505791062597 -0.047691579662392486 -0.5214726084248458\nHe -0.20993505791062597 -1.4340046109136073 1.6856624724488458\nHe -0.20993505791062597 -1.4340046109136073 -0.5214726084248458\nHe 1.1035675404368457 -0.530913037377374 1.2752514476376073\nHe 1.1035675404368457 -0.530913037377374 -0.11106158361360742\nHe 1.1035675404368457 -0.9507831531986258 1.2752514476376073\nHe 1.1035675404368457 -0.9507831531986258 -0.11106158361360742\nHe -1.1035675404368457 -0.530913037377374 1.2752514476376073\nHe -1.1035675404368457 -0.530913037377374 -0.11106158361360742\nHe -1.1035675404368457 -0.9507831531986258 1.2752514476376073\nHe -1.1035675404368457 -0.9507831531986258 -0.11106158361360742\nHe 1.1035675404368457 -0.047691579662392486 0.792029989922626\nHe 1.1035675404368457 -0.047691579662392486 0.3721598741013741\nHe 1.1035675404368457 -1.4340046109136073 0.792029989922626\nHe 1.1035675404368457 -1.4340046109136073 0.3721598741013741\nHe -1.1035675404368457 -0.047691579662392486 0.792029989922626\nHe -1.1035675404368457 -0.047691579662392486 0.3721598741013741\nHe -1.1035675404368457 -1.4340046109136073 0.792029989922626\nHe -1.1035675404368457 -1.4340046109136073 0.3721598741013741\nHe 0.6931565156256074 -0.530913037377374 1.6856624724488458\nHe 0.6931565156256074 -0.530913037377374 -0.5214726084248458\nHe 0.6931565156256074 -0.9507831531986258 1.6856624724488458\nHe 0.6931565156256074 -0.9507831531986258 -0.5214726084248458\nHe -0.6931565156256074 -0.530913037377374 1.6856624724488458\nHe -0.6931565156256074 -0.530913037377374 -0.5214726084248458\nHe -0.6931565156256074 -0.9507831531986258 1.6856624724488458\nHe -0.6931565156256074 -0.9507831531986258 -0.5214726084248458\nHe 0.6931565156256074 0.36271944514884585 0.792029989922626\nHe 0.6931565156256074 0.36271944514884585 0.3721598741013741\nHe 0.6931565156256074 -1.8444156357248458 0.792029989922626\nHe 0.6931565156256074 -1.8444156357248458 0.3721598741013741\nHe -0.6931565156256074 0.36271944514884585 0.792029989922626\nHe -0.6931565156256074 0.36271944514884585 0.3721598741013741\nHe -0.6931565156256074 -1.8444156357248458 0.792029989922626\nHe -0.6931565156256074 -1.8444156357248458 0.3721598741013741\n","xyz");
	viewer_17639956906300852.setStyle({"elem": "He"},{"sphere": {"radius": 0.05, "color": "red", "opacity": 0.5}});
	viewer_17639956906300852.zoomTo();
viewer_17639956906300852.render();
});
</script></div></div>
</div>
<p>As expected, by comparing to the previous figure, the points within the cavity volume are those removed, and the regions where grid points cluster densely correspond to intersections between neighbouring spheres.</p>
<p>There are three main issues with this grid construction:</p>
<ol class="arabic simple">
<li><p>Crevices may form, allowing surface charges to come unnaturally close to the solute—unnatural in the sense that the continuum is meant to represent surrounding solvent molecules, which themselves occupy physical volume and should not fit into such crevices;</p></li>
<li><p>Intersecting surface regions bring charges <em>very</em> close together, especially after resolving issue 3 via the use of a switching function, which can lead to diverging Coulomb interactions;</p></li>
<li><p>Perturbing an atomic position of the molecule (e.g., during  nuclear derivative calculations) can change the <em>number</em> of surface points—and hence the number of charges—discontinuously, resulting in a discontinuous potential energy surface.</p></li>
</ol>
<p>Let us tackle each point one at a time.</p>
<p>1: A common solution to the first issue is to uniformly scale the (VDW) radii by a constant factor, typically 1.2. Increasing the scaling factor smooths the cavity surface, which gradually approaches the shape of a sphere in the limit. A 20% increase is usually sufficient to eliminate these pathological cases.</p>
<p>Try varying the scaling factor below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># standard: scaling_factor = 1.2</span>
<span class="n">scaling_factor</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">full_grid</span><span class="p">,</span> <span class="n">full_sw_f</span> <span class="o">=</span> <span class="n">raw_grid</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">grid_per_sphere</span><span class="p">,</span> <span class="n">scaling_factor</span><span class="o">=</span><span class="n">scaling_factor</span><span class="p">)</span>
<span class="n">cpcm_drv</span><span class="o">.</span><span class="n">visualize_cpcm_grid</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">full_grid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div id="3dmolviewer_1763995690649039"  style="position: relative; width: 400px; height: 400px;">
        <p id="3dmolwarning_1763995690649039" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdn.jsdelivr.net/npm/3dmol@2.5.0/build/3Dmol-min.js');
}

var viewer_1763995690649039 = null;
var warn = document.getElementById("3dmolwarning_1763995690649039");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_1763995690649039 = $3Dmol.createViewer(document.getElementById("3dmolviewer_1763995690649039"),{backgroundColor:"white"});
viewer_1763995690649039.zoomTo();
	viewer_1763995690649039.addModel("3\n\nO              0.000000000000         0.000000000000         0.000000000000\nH              0.000000000000         0.740848095288         0.582094932012\nH              0.000000000000        -0.740848095288         0.582094932012\n","xyz");
	viewer_1763995690649039.setStyle({"stick": {}});
	viewer_1763995690649039.addModel("582\n\nHe 0.912 0.0 0.0\nHe -0.912 0.0 0.0\nHe 0.0 0.912 0.0\nHe 0.0 -0.912 0.0\nHe 0.0 0.0 0.912\nHe 0.0 0.0 -0.912\nHe 0.0 0.6448813844421313 0.6448813844421313\nHe 0.0 0.6448813844421313 -0.6448813844421313\nHe 0.0 -0.6448813844421313 0.6448813844421313\nHe 0.0 -0.6448813844421313 -0.6448813844421313\nHe 0.6448813844421313 0.0 0.6448813844421313\nHe 0.6448813844421313 0.0 -0.6448813844421313\nHe -0.6448813844421313 0.0 0.6448813844421313\nHe -0.6448813844421313 0.0 -0.6448813844421313\nHe 0.6448813844421313 0.6448813844421313 0.0\nHe 0.6448813844421313 -0.6448813844421313 0.0\nHe -0.6448813844421313 0.6448813844421313 0.0\nHe -0.6448813844421313 -0.6448813844421313 0.0\nHe 0.5265434455009388 0.5265434455009388 0.5265434455009388\nHe 0.5265434455009388 0.5265434455009388 -0.5265434455009388\nHe 0.5265434455009388 -0.5265434455009388 0.5265434455009388\nHe 0.5265434455009388 -0.5265434455009388 -0.5265434455009388\nHe -0.5265434455009388 0.5265434455009388 0.5265434455009388\nHe -0.5265434455009388 0.5265434455009388 -0.5265434455009388\nHe -0.5265434455009388 -0.5265434455009388 0.5265434455009388\nHe -0.5265434455009388 -0.5265434455009388 -0.5265434455009388\nHe 0.6122231779738047 0.6122231779738047 0.2865476586945187\nHe 0.6122231779738047 0.6122231779738047 -0.2865476586945187\nHe 0.6122231779738047 -0.6122231779738047 0.2865476586945187\nHe 0.6122231779738047 -0.6122231779738047 -0.2865476586945187\nHe -0.6122231779738047 0.6122231779738047 0.2865476586945187\nHe -0.6122231779738047 0.6122231779738047 -0.2865476586945187\nHe -0.6122231779738047 -0.6122231779738047 0.2865476586945187\nHe -0.6122231779738047 -0.6122231779738047 -0.2865476586945187\nHe 0.6122231779738047 0.2865476586945187 0.6122231779738047\nHe 0.6122231779738047 -0.2865476586945187 0.6122231779738047\nHe 0.6122231779738047 0.2865476586945187 -0.6122231779738047\nHe 0.6122231779738047 -0.2865476586945187 -0.6122231779738047\nHe -0.6122231779738047 0.2865476586945187 0.6122231779738047\nHe -0.6122231779738047 -0.2865476586945187 0.6122231779738047\nHe -0.6122231779738047 0.2865476586945187 -0.6122231779738047\nHe -0.6122231779738047 -0.2865476586945187 -0.6122231779738047\nHe 0.2865476586945187 0.6122231779738047 0.6122231779738047\nHe -0.2865476586945187 0.6122231779738047 0.6122231779738047\nHe 0.2865476586945187 0.6122231779738047 -0.6122231779738047\nHe -0.2865476586945187 0.6122231779738047 -0.6122231779738047\nHe 0.2865476586945187 -0.6122231779738047 0.6122231779738047\nHe -0.2865476586945187 -0.6122231779738047 0.6122231779738047\nHe 0.2865476586945187 -0.6122231779738047 -0.6122231779738047\nHe -0.2865476586945187 -0.6122231779738047 -0.6122231779738047\nHe 0.26379286523488005 0.26379286523488005 0.832208296343136\nHe 0.26379286523488005 0.26379286523488005 -0.832208296343136\nHe 0.26379286523488005 -0.26379286523488005 0.832208296343136\nHe 0.26379286523488005 -0.26379286523488005 -0.832208296343136\nHe -0.26379286523488005 0.26379286523488005 0.832208296343136\nHe -0.26379286523488005 0.26379286523488005 -0.832208296343136\nHe -0.26379286523488005 -0.26379286523488005 0.832208296343136\nHe -0.26379286523488005 -0.26379286523488005 -0.832208296343136\nHe 0.26379286523488005 0.832208296343136 0.26379286523488005\nHe 0.26379286523488005 -0.832208296343136 0.26379286523488005\nHe 0.26379286523488005 0.832208296343136 -0.26379286523488005\nHe 0.26379286523488005 -0.832208296343136 -0.26379286523488005\nHe -0.26379286523488005 0.832208296343136 0.26379286523488005\nHe -0.26379286523488005 -0.832208296343136 0.26379286523488005\nHe -0.26379286523488005 0.832208296343136 -0.26379286523488005\nHe -0.26379286523488005 -0.832208296343136 -0.26379286523488005\nHe 0.832208296343136 0.26379286523488005 0.26379286523488005\nHe -0.832208296343136 0.26379286523488005 0.26379286523488005\nHe 0.832208296343136 0.26379286523488005 -0.26379286523488005\nHe -0.832208296343136 0.26379286523488005 -0.26379286523488005\nHe 0.832208296343136 -0.26379286523488005 0.26379286523488005\nHe -0.832208296343136 -0.26379286523488005 0.26379286523488005\nHe 0.832208296343136 -0.26379286523488005 -0.26379286523488005\nHe -0.832208296343136 -0.26379286523488005 -0.26379286523488005\nHe 0.4055603058990303 0.4055603058990303 0.7090738160150677\nHe 0.4055603058990303 0.4055603058990303 -0.7090738160150677\nHe 0.4055603058990303 -0.4055603058990303 0.7090738160150677\nHe 0.4055603058990303 -0.4055603058990303 -0.7090738160150677\nHe -0.4055603058990303 0.4055603058990303 0.7090738160150677\nHe -0.4055603058990303 0.4055603058990303 -0.7090738160150677\nHe -0.4055603058990303 -0.4055603058990303 0.7090738160150677\nHe -0.4055603058990303 -0.4055603058990303 -0.7090738160150677\nHe 0.4055603058990303 0.7090738160150677 0.4055603058990303\nHe 0.4055603058990303 -0.7090738160150677 0.4055603058990303\nHe 0.4055603058990303 0.7090738160150677 -0.4055603058990303\nHe 0.4055603058990303 -0.7090738160150677 -0.4055603058990303\nHe -0.4055603058990303 0.7090738160150677 0.4055603058990303\nHe -0.4055603058990303 -0.7090738160150677 0.4055603058990303\nHe -0.4055603058990303 0.7090738160150677 -0.4055603058990303\nHe -0.4055603058990303 -0.7090738160150677 -0.4055603058990303\nHe 0.7090738160150677 0.4055603058990303 0.4055603058990303\nHe -0.7090738160150677 0.4055603058990303 0.4055603058990303\nHe 0.7090738160150677 0.4055603058990303 -0.4055603058990303\nHe -0.7090738160150677 0.4055603058990303 -0.4055603058990303\nHe 0.7090738160150677 -0.4055603058990303 0.4055603058990303\nHe -0.7090738160150677 -0.4055603058990303 0.4055603058990303\nHe 0.7090738160150677 -0.4055603058990303 -0.4055603058990303\nHe -0.7090738160150677 -0.4055603058990303 -0.4055603058990303\nHe 0.11849939282568611 0.11849939282568611 0.896470740069015\nHe 0.11849939282568611 0.11849939282568611 -0.896470740069015\nHe 0.11849939282568611 -0.11849939282568611 0.896470740069015\nHe 0.11849939282568611 -0.11849939282568611 -0.896470740069015\nHe -0.11849939282568611 0.11849939282568611 0.896470740069015\nHe -0.11849939282568611 0.11849939282568611 -0.896470740069015\nHe -0.11849939282568611 -0.11849939282568611 0.896470740069015\nHe -0.11849939282568611 -0.11849939282568611 -0.896470740069015\nHe 0.11849939282568611 0.896470740069015 0.11849939282568611\nHe 0.11849939282568611 -0.896470740069015 0.11849939282568611\nHe 0.11849939282568611 0.896470740069015 -0.11849939282568611\nHe 0.11849939282568611 -0.896470740069015 -0.11849939282568611\nHe -0.11849939282568611 0.896470740069015 0.11849939282568611\nHe -0.11849939282568611 -0.896470740069015 0.11849939282568611\nHe -0.11849939282568611 0.896470740069015 -0.11849939282568611\nHe -0.11849939282568611 -0.896470740069015 -0.11849939282568611\nHe 0.896470740069015 0.11849939282568611 0.11849939282568611\nHe -0.896470740069015 0.11849939282568611 0.11849939282568611\nHe 0.896470740069015 0.11849939282568611 -0.11849939282568611\nHe -0.896470740069015 0.11849939282568611 -0.11849939282568611\nHe 0.896470740069015 -0.11849939282568611 0.11849939282568611\nHe -0.896470740069015 -0.11849939282568611 0.11849939282568611\nHe 0.896470740069015 -0.11849939282568611 -0.11849939282568611\nHe -0.896470740069015 -0.11849939282568611 -0.11849939282568611\nHe 0.31534244042214904 0.8557471269414836 0.0\nHe 0.31534244042214904 -0.8557471269414836 0.0\nHe -0.31534244042214904 0.8557471269414836 0.0\nHe -0.31534244042214904 -0.8557471269414836 0.0\nHe 0.8557471269414836 0.31534244042214904 0.0\nHe 0.8557471269414836 -0.31534244042214904 0.0\nHe -0.8557471269414836 0.31534244042214904 0.0\nHe -0.8557471269414836 -0.31534244042214904 0.0\nHe 0.31534244042214904 0.0 0.8557471269414836\nHe 0.31534244042214904 0.0 -0.8557471269414836\nHe -0.31534244042214904 0.0 0.8557471269414836\nHe -0.31534244042214904 0.0 -0.8557471269414836\nHe 0.8557471269414836 0.0 0.31534244042214904\nHe 0.8557471269414836 0.0 -0.31534244042214904\nHe -0.8557471269414836 0.0 0.31534244042214904\nHe -0.8557471269414836 0.0 -0.31534244042214904\nHe 0.0 0.31534244042214904 0.8557471269414836\nHe 0.0 0.31534244042214904 -0.8557471269414836\nHe 0.0 -0.31534244042214904 0.8557471269414836\nHe 0.0 -0.31534244042214904 -0.8557471269414836\nHe 0.0 0.8557471269414836 0.31534244042214904\nHe 0.0 0.8557471269414836 -0.31534244042214904\nHe 0.0 -0.8557471269414836 0.31534244042214904\nHe 0.0 -0.8557471269414836 -0.31534244042214904\nHe 0.14504604001097793 0.7624648461200024 0.4789081380686015\nHe 0.14504604001097793 0.7624648461200024 -0.4789081380686015\nHe 0.14504604001097793 -0.7624648461200024 0.4789081380686015\nHe 0.14504604001097793 -0.7624648461200024 -0.4789081380686015\nHe -0.14504604001097793 0.7624648461200024 0.4789081380686015\nHe -0.14504604001097793 0.7624648461200024 -0.4789081380686015\nHe -0.14504604001097793 -0.7624648461200024 0.4789081380686015\nHe -0.14504604001097793 -0.7624648461200024 -0.4789081380686015\nHe 0.14504604001097793 0.4789081380686015 0.7624648461200024\nHe 0.14504604001097793 0.4789081380686015 -0.7624648461200024\nHe 0.14504604001097793 -0.4789081380686015 0.7624648461200024\nHe 0.14504604001097793 -0.4789081380686015 -0.7624648461200024\nHe -0.14504604001097793 0.4789081380686015 0.7624648461200024\nHe -0.14504604001097793 0.4789081380686015 -0.7624648461200024\nHe -0.14504604001097793 -0.4789081380686015 0.7624648461200024\nHe -0.14504604001097793 -0.4789081380686015 -0.7624648461200024\nHe 0.7624648461200024 0.14504604001097793 0.4789081380686015\nHe 0.7624648461200024 0.14504604001097793 -0.4789081380686015\nHe 0.7624648461200024 -0.14504604001097793 0.4789081380686015\nHe 0.7624648461200024 -0.14504604001097793 -0.4789081380686015\nHe -0.7624648461200024 0.14504604001097793 0.4789081380686015\nHe -0.7624648461200024 0.14504604001097793 -0.4789081380686015\nHe -0.7624648461200024 -0.14504604001097793 0.4789081380686015\nHe -0.7624648461200024 -0.14504604001097793 -0.4789081380686015\nHe 0.7624648461200024 0.4789081380686015 0.14504604001097793\nHe 0.7624648461200024 0.4789081380686015 -0.14504604001097793\nHe 0.7624648461200024 -0.4789081380686015 0.14504604001097793\nHe 0.7624648461200024 -0.4789081380686015 -0.14504604001097793\nHe -0.7624648461200024 0.4789081380686015 0.14504604001097793\nHe -0.7624648461200024 0.4789081380686015 -0.14504604001097793\nHe -0.7624648461200024 -0.4789081380686015 0.14504604001097793\nHe -0.7624648461200024 -0.4789081380686015 -0.14504604001097793\nHe 0.4789081380686015 0.14504604001097793 0.7624648461200024\nHe 0.4789081380686015 0.14504604001097793 -0.7624648461200024\nHe 0.4789081380686015 -0.14504604001097793 0.7624648461200024\nHe 0.4789081380686015 -0.14504604001097793 -0.7624648461200024\nHe -0.4789081380686015 0.14504604001097793 0.7624648461200024\nHe -0.4789081380686015 0.14504604001097793 -0.7624648461200024\nHe -0.4789081380686015 -0.14504604001097793 0.7624648461200024\nHe -0.4789081380686015 -0.14504604001097793 -0.7624648461200024\nHe 0.4789081380686015 0.7624648461200024 0.14504604001097793\nHe 0.4789081380686015 0.7624648461200024 -0.14504604001097793\nHe 0.4789081380686015 -0.7624648461200024 0.14504604001097793\nHe 0.4789081380686015 -0.7624648461200024 -0.14504604001097793\nHe -0.4789081380686015 0.7624648461200024 0.14504604001097793\nHe -0.4789081380686015 0.7624648461200024 -0.14504604001097793\nHe -0.4789081380686015 -0.7624648461200024 0.14504604001097793\nHe -0.4789081380686015 -0.7624648461200024 -0.14504604001097793\nHe 0.66 0.740848095288 0.582094932012\nHe -0.66 0.740848095288 0.582094932012\nHe 0.0 1.400848095288 0.582094932012\nHe 0.0 0.08084809528799992 0.582094932012\nHe 0.0 0.740848095288 1.2420949320120003\nHe 0.0 0.740848095288 -0.07790506798799998\nHe 0.0 1.2075385708711213 1.0487854075951213\nHe 0.0 1.2075385708711213 0.11540445642887871\nHe 0.0 0.2741576197048786 1.0487854075951213\nHe 0.0 0.2741576197048786 0.11540445642887871\nHe 0.4666904755831213 0.740848095288 1.0487854075951213\nHe 0.4666904755831213 0.740848095288 0.11540445642887871\nHe -0.4666904755831213 0.740848095288 1.0487854075951213\nHe -0.4666904755831213 0.740848095288 0.11540445642887871\nHe 0.4666904755831213 1.2075385708711213 0.582094932012\nHe 0.4666904755831213 0.2741576197048786 0.582094932012\nHe -0.4666904755831213 1.2075385708711213 0.582094932012\nHe -0.4666904755831213 0.2741576197048786 0.582094932012\nHe 0.38105117766515306 1.121899272953153 0.9631461096771531\nHe 0.38105117766515306 1.121899272953153 0.201043754346847\nHe 0.38105117766515306 0.3597969176228469 0.9631461096771531\nHe 0.38105117766515306 0.3597969176228469 0.201043754346847\nHe -0.38105117766515306 1.121899272953153 0.9631461096771531\nHe -0.38105117766515306 1.121899272953153 0.201043754346847\nHe -0.38105117766515306 0.3597969176228469 0.9631461096771531\nHe -0.38105117766515306 0.3597969176228469 0.201043754346847\nHe 0.4430562472178849 1.183904342505885 0.789464948172507\nHe 0.4430562472178849 1.183904342505885 0.3747249158514931\nHe 0.4430562472178849 0.29779184807011505 0.789464948172507\nHe 0.4430562472178849 0.29779184807011505 0.3747249158514931\nHe -0.4430562472178849 1.183904342505885 0.789464948172507\nHe -0.4430562472178849 1.183904342505885 0.3747249158514931\nHe -0.4430562472178849 0.29779184807011505 0.789464948172507\nHe -0.4430562472178849 0.29779184807011505 0.3747249158514931\nHe 0.4430562472178849 0.9482181114485069 1.0251511792298849\nHe 0.4430562472178849 0.533478079127493 1.0251511792298849\nHe 0.4430562472178849 0.9482181114485069 0.13903868479411516\nHe 0.4430562472178849 0.533478079127493 0.13903868479411516\nHe -0.4430562472178849 0.9482181114485069 1.0251511792298849\nHe -0.4430562472178849 0.533478079127493 1.0251511792298849\nHe -0.4430562472178849 0.9482181114485069 0.13903868479411516\nHe -0.4430562472178849 0.533478079127493 0.13903868479411516\nHe 0.20737001616050696 1.183904342505885 1.0251511792298849\nHe -0.20737001616050696 1.183904342505885 1.0251511792298849\nHe 0.20737001616050696 1.183904342505885 0.13903868479411516\nHe -0.20737001616050696 1.183904342505885 0.13903868479411516\nHe 0.20737001616050696 0.29779184807011505 1.0251511792298849\nHe -0.20737001616050696 0.29779184807011505 1.0251511792298849\nHe 0.20737001616050696 0.29779184807011505 0.13903868479411516\nHe -0.20737001616050696 0.29779184807011505 0.13903868479411516\nHe 0.190902731419979 0.931750826707979 1.184350935944533\nHe 0.190902731419979 0.931750826707979 -0.02016107192053269\nHe 0.190902731419979 0.549945363868021 1.184350935944533\nHe 0.190902731419979 0.549945363868021 -0.02016107192053269\nHe -0.190902731419979 0.931750826707979 1.184350935944533\nHe -0.190902731419979 0.931750826707979 -0.02016107192053269\nHe -0.190902731419979 0.549945363868021 1.184350935944533\nHe -0.190902731419979 0.549945363868021 -0.02016107192053269\nHe 0.190902731419979 1.3431040992205328 0.7729976634319791\nHe 0.190902731419979 0.1385920913554672 0.7729976634319791\nHe 0.190902731419979 1.3431040992205328 0.3911922005920211\nHe 0.190902731419979 0.1385920913554672 0.3911922005920211\nHe -0.190902731419979 1.3431040992205328 0.7729976634319791\nHe -0.190902731419979 0.1385920913554672 0.7729976634319791\nHe -0.190902731419979 1.3431040992205328 0.3911922005920211\nHe -0.190902731419979 0.1385920913554672 0.3911922005920211\nHe 0.6022560039325328 0.931750826707979 0.7729976634319791\nHe -0.6022560039325328 0.931750826707979 0.7729976634319791\nHe 0.6022560039325328 0.931750826707979 0.3911922005920211\nHe -0.6022560039325328 0.931750826707979 0.3911922005920211\nHe 0.6022560039325328 0.549945363868021 0.7729976634319791\nHe -0.6022560039325328 0.549945363868021 0.7729976634319791\nHe 0.6022560039325328 0.549945363868021 0.3911922005920211\nHe -0.6022560039325328 0.549945363868021 0.3911922005920211\nHe 0.29349758979535084 1.0343456850833508 1.0952404567597465\nHe 0.29349758979535084 1.0343456850833508 0.06894940726425373\nHe 0.29349758979535084 0.4473505054926491 1.0952404567597465\nHe 0.29349758979535084 0.4473505054926491 0.06894940726425373\nHe -0.29349758979535084 1.0343456850833508 1.0952404567597465\nHe -0.29349758979535084 1.0343456850833508 0.06894940726425373\nHe -0.29349758979535084 0.4473505054926491 1.0952404567597465\nHe -0.29349758979535084 0.4473505054926491 0.06894940726425373\nHe 0.29349758979535084 1.2539936200357462 0.8755925218073509\nHe 0.29349758979535084 0.22770257054025364 0.8755925218073509\nHe 0.29349758979535084 1.2539936200357462 0.2885973422166492\nHe 0.29349758979535084 0.22770257054025364 0.2885973422166492\nHe -0.29349758979535084 1.2539936200357462 0.8755925218073509\nHe -0.29349758979535084 0.22770257054025364 0.8755925218073509\nHe -0.29349758979535084 1.2539936200357462 0.2885973422166492\nHe -0.29349758979535084 0.22770257054025364 0.2885973422166492\nHe 0.5131455247477463 1.0343456850833508 0.8755925218073509\nHe -0.5131455247477463 1.0343456850833508 0.8755925218073509\nHe 0.5131455247477463 1.0343456850833508 0.2885973422166492\nHe -0.5131455247477463 1.0343456850833508 0.2885973422166492\nHe 0.5131455247477463 0.4473505054926491 0.8755925218073509\nHe -0.5131455247477463 0.4473505054926491 0.8755925218073509\nHe 0.5131455247477463 0.4473505054926491 0.2885973422166492\nHe -0.5131455247477463 0.4473505054926491 0.2885973422166492\nHe 0.08575613954490444 0.8266042348329045 1.2308566517987871\nHe 0.08575613954490444 0.8266042348329045 -0.06666678777478707\nHe 0.08575613954490444 0.6550919557430954 1.2308566517987871\nHe 0.08575613954490444 0.6550919557430954 -0.06666678777478707\nHe -0.08575613954490444 0.8266042348329045 1.2308566517987871\nHe -0.08575613954490444 0.8266042348329045 -0.06666678777478707\nHe -0.08575613954490444 0.6550919557430954 1.2308566517987871\nHe -0.08575613954490444 0.6550919557430954 -0.06666678777478707\nHe 0.08575613954490444 1.389609815074787 0.6678510715569045\nHe 0.08575613954490444 0.09208637550121283 0.6678510715569045\nHe 0.08575613954490444 1.389609815074787 0.4963387924670956\nHe 0.08575613954490444 0.09208637550121283 0.4963387924670956\nHe -0.08575613954490444 1.389609815074787 0.6678510715569045\nHe -0.08575613954490444 0.09208637550121283 0.6678510715569045\nHe -0.08575613954490444 1.389609815074787 0.4963387924670956\nHe -0.08575613954490444 0.09208637550121283 0.4963387924670956\nHe 0.6487617197867871 0.8266042348329045 0.6678510715569045\nHe -0.6487617197867871 0.8266042348329045 0.6678510715569045\nHe 0.6487617197867871 0.8266042348329045 0.4963387924670956\nHe -0.6487617197867871 0.8266042348329045 0.4963387924670956\nHe 0.6487617197867871 0.6550919557430954 0.6678510715569045\nHe -0.6487617197867871 0.6550919557430954 0.6678510715569045\nHe 0.6487617197867871 0.6550919557430954 0.4963387924670956\nHe -0.6487617197867871 0.6550919557430954 0.4963387924670956\nHe 0.22820834504234472 1.3601387792588104 0.582094932012\nHe 0.22820834504234472 0.12155741131718954 0.582094932012\nHe -0.22820834504234472 1.3601387792588104 0.582094932012\nHe -0.22820834504234472 0.12155741131718954 0.582094932012\nHe 0.6192906839708104 0.9690564403303448 0.582094932012\nHe 0.6192906839708104 0.5126397502456552 0.582094932012\nHe -0.6192906839708104 0.9690564403303448 0.582094932012\nHe -0.6192906839708104 0.5126397502456552 0.582094932012\nHe 0.22820834504234472 0.740848095288 1.2013856159828105\nHe 0.22820834504234472 0.740848095288 -0.03719575195881036\nHe -0.22820834504234472 0.740848095288 1.2013856159828105\nHe -0.22820834504234472 0.740848095288 -0.03719575195881036\nHe 0.6192906839708104 0.740848095288 0.8103032770543448\nHe 0.6192906839708104 0.740848095288 0.35388658696965536\nHe -0.6192906839708104 0.740848095288 0.8103032770543448\nHe -0.6192906839708104 0.740848095288 0.35388658696965536\nHe 0.0 0.9690564403303448 1.2013856159828105\nHe 0.0 0.9690564403303448 -0.03719575195881036\nHe 0.0 0.5126397502456552 1.2013856159828105\nHe 0.0 0.5126397502456552 -0.03719575195881036\nHe 0.0 1.3601387792588104 0.8103032770543448\nHe 0.0 1.3601387792588104 0.35388658696965536\nHe 0.0 0.12155741131718954 0.8103032770543448\nHe 0.0 0.12155741131718954 0.35388658696965536\nHe 0.10496752895531299 1.292631865506423 0.9286731898248038\nHe 0.10496752895531299 1.292631865506423 0.2355166741991963\nHe 0.10496752895531299 0.18906432506957704 0.9286731898248038\nHe 0.10496752895531299 0.18906432506957704 0.2355166741991963\nHe -0.10496752895531299 1.292631865506423 0.9286731898248038\nHe -0.10496752895531299 1.292631865506423 0.2355166741991963\nHe -0.10496752895531299 0.18906432506957704 0.9286731898248038\nHe -0.10496752895531299 0.18906432506957704 0.2355166741991963\nHe 0.10496752895531299 1.0874263531008037 1.133878702230423\nHe 0.10496752895531299 1.0874263531008037 0.030311161793577148\nHe 0.10496752895531299 0.3942698374751962 1.133878702230423\nHe 0.10496752895531299 0.3942698374751962 0.030311161793577148\nHe -0.10496752895531299 1.0874263531008037 1.133878702230423\nHe -0.10496752895531299 1.0874263531008037 0.030311161793577148\nHe -0.10496752895531299 0.3942698374751962 1.133878702230423\nHe -0.10496752895531299 0.3942698374751962 0.030311161793577148\nHe 0.5517837702184228 0.8458156242433129 0.9286731898248038\nHe 0.5517837702184228 0.8458156242433129 0.2355166741991963\nHe 0.5517837702184228 0.635880566332687 0.9286731898248038\nHe 0.5517837702184228 0.635880566332687 0.2355166741991963\nHe -0.5517837702184228 0.8458156242433129 0.9286731898248038\nHe -0.5517837702184228 0.8458156242433129 0.2355166741991963\nHe -0.5517837702184228 0.635880566332687 0.9286731898248038\nHe -0.5517837702184228 0.635880566332687 0.2355166741991963\nHe 0.5517837702184228 1.0874263531008037 0.687062460967313\nHe 0.5517837702184228 1.0874263531008037 0.4771274030566871\nHe 0.5517837702184228 0.3942698374751962 0.687062460967313\nHe 0.5517837702184228 0.3942698374751962 0.4771274030566871\nHe -0.5517837702184228 1.0874263531008037 0.687062460967313\nHe -0.5517837702184228 1.0874263531008037 0.4771274030566871\nHe -0.5517837702184228 0.3942698374751962 0.687062460967313\nHe -0.5517837702184228 0.3942698374751962 0.4771274030566871\nHe 0.3465782578128037 0.8458156242433129 1.133878702230423\nHe 0.3465782578128037 0.8458156242433129 0.030311161793577148\nHe 0.3465782578128037 0.635880566332687 1.133878702230423\nHe 0.3465782578128037 0.635880566332687 0.030311161793577148\nHe -0.3465782578128037 0.8458156242433129 1.133878702230423\nHe -0.3465782578128037 0.8458156242433129 0.030311161793577148\nHe -0.3465782578128037 0.635880566332687 1.133878702230423\nHe -0.3465782578128037 0.635880566332687 0.030311161793577148\nHe 0.3465782578128037 1.292631865506423 0.687062460967313\nHe 0.3465782578128037 1.292631865506423 0.4771274030566871\nHe 0.3465782578128037 0.18906432506957704 0.687062460967313\nHe 0.3465782578128037 0.18906432506957704 0.4771274030566871\nHe -0.3465782578128037 1.292631865506423 0.687062460967313\nHe -0.3465782578128037 1.292631865506423 0.4771274030566871\nHe -0.3465782578128037 0.18906432506957704 0.687062460967313\nHe -0.3465782578128037 0.18906432506957704 0.4771274030566871\nHe 0.66 -0.740848095288 0.582094932012\nHe -0.66 -0.740848095288 0.582094932012\nHe 0.0 -0.08084809528799992 0.582094932012\nHe 0.0 -1.400848095288 0.582094932012\nHe 0.0 -0.740848095288 1.2420949320120003\nHe 0.0 -0.740848095288 -0.07790506798799998\nHe 0.0 -0.2741576197048786 1.0487854075951213\nHe 0.0 -0.2741576197048786 0.11540445642887871\nHe 0.0 -1.2075385708711213 1.0487854075951213\nHe 0.0 -1.2075385708711213 0.11540445642887871\nHe 0.4666904755831213 -0.740848095288 1.0487854075951213\nHe 0.4666904755831213 -0.740848095288 0.11540445642887871\nHe -0.4666904755831213 -0.740848095288 1.0487854075951213\nHe -0.4666904755831213 -0.740848095288 0.11540445642887871\nHe 0.4666904755831213 -0.2741576197048786 0.582094932012\nHe 0.4666904755831213 -1.2075385708711213 0.582094932012\nHe -0.4666904755831213 -0.2741576197048786 0.582094932012\nHe -0.4666904755831213 -1.2075385708711213 0.582094932012\nHe 0.38105117766515306 -0.3597969176228469 0.9631461096771531\nHe 0.38105117766515306 -0.3597969176228469 0.201043754346847\nHe 0.38105117766515306 -1.121899272953153 0.9631461096771531\nHe 0.38105117766515306 -1.121899272953153 0.201043754346847\nHe -0.38105117766515306 -0.3597969176228469 0.9631461096771531\nHe -0.38105117766515306 -0.3597969176228469 0.201043754346847\nHe -0.38105117766515306 -1.121899272953153 0.9631461096771531\nHe -0.38105117766515306 -1.121899272953153 0.201043754346847\nHe 0.4430562472178849 -0.29779184807011505 0.789464948172507\nHe 0.4430562472178849 -0.29779184807011505 0.3747249158514931\nHe 0.4430562472178849 -1.183904342505885 0.789464948172507\nHe 0.4430562472178849 -1.183904342505885 0.3747249158514931\nHe -0.4430562472178849 -0.29779184807011505 0.789464948172507\nHe -0.4430562472178849 -0.29779184807011505 0.3747249158514931\nHe -0.4430562472178849 -1.183904342505885 0.789464948172507\nHe -0.4430562472178849 -1.183904342505885 0.3747249158514931\nHe 0.4430562472178849 -0.533478079127493 1.0251511792298849\nHe 0.4430562472178849 -0.9482181114485069 1.0251511792298849\nHe 0.4430562472178849 -0.533478079127493 0.13903868479411516\nHe 0.4430562472178849 -0.9482181114485069 0.13903868479411516\nHe -0.4430562472178849 -0.533478079127493 1.0251511792298849\nHe -0.4430562472178849 -0.9482181114485069 1.0251511792298849\nHe -0.4430562472178849 -0.533478079127493 0.13903868479411516\nHe -0.4430562472178849 -0.9482181114485069 0.13903868479411516\nHe 0.20737001616050696 -0.29779184807011505 1.0251511792298849\nHe -0.20737001616050696 -0.29779184807011505 1.0251511792298849\nHe 0.20737001616050696 -0.29779184807011505 0.13903868479411516\nHe -0.20737001616050696 -0.29779184807011505 0.13903868479411516\nHe 0.20737001616050696 -1.183904342505885 1.0251511792298849\nHe -0.20737001616050696 -1.183904342505885 1.0251511792298849\nHe 0.20737001616050696 -1.183904342505885 0.13903868479411516\nHe -0.20737001616050696 -1.183904342505885 0.13903868479411516\nHe 0.190902731419979 -0.549945363868021 1.184350935944533\nHe 0.190902731419979 -0.549945363868021 -0.02016107192053269\nHe 0.190902731419979 -0.931750826707979 1.184350935944533\nHe 0.190902731419979 -0.931750826707979 -0.02016107192053269\nHe -0.190902731419979 -0.549945363868021 1.184350935944533\nHe -0.190902731419979 -0.549945363868021 -0.02016107192053269\nHe -0.190902731419979 -0.931750826707979 1.184350935944533\nHe -0.190902731419979 -0.931750826707979 -0.02016107192053269\nHe 0.190902731419979 -0.1385920913554672 0.7729976634319791\nHe 0.190902731419979 -1.3431040992205328 0.7729976634319791\nHe 0.190902731419979 -0.1385920913554672 0.3911922005920211\nHe 0.190902731419979 -1.3431040992205328 0.3911922005920211\nHe -0.190902731419979 -0.1385920913554672 0.7729976634319791\nHe -0.190902731419979 -1.3431040992205328 0.7729976634319791\nHe -0.190902731419979 -0.1385920913554672 0.3911922005920211\nHe -0.190902731419979 -1.3431040992205328 0.3911922005920211\nHe 0.6022560039325328 -0.549945363868021 0.7729976634319791\nHe -0.6022560039325328 -0.549945363868021 0.7729976634319791\nHe 0.6022560039325328 -0.549945363868021 0.3911922005920211\nHe -0.6022560039325328 -0.549945363868021 0.3911922005920211\nHe 0.6022560039325328 -0.931750826707979 0.7729976634319791\nHe -0.6022560039325328 -0.931750826707979 0.7729976634319791\nHe 0.6022560039325328 -0.931750826707979 0.3911922005920211\nHe -0.6022560039325328 -0.931750826707979 0.3911922005920211\nHe 0.29349758979535084 -0.4473505054926491 1.0952404567597465\nHe 0.29349758979535084 -0.4473505054926491 0.06894940726425373\nHe 0.29349758979535084 -1.0343456850833508 1.0952404567597465\nHe 0.29349758979535084 -1.0343456850833508 0.06894940726425373\nHe -0.29349758979535084 -0.4473505054926491 1.0952404567597465\nHe -0.29349758979535084 -0.4473505054926491 0.06894940726425373\nHe -0.29349758979535084 -1.0343456850833508 1.0952404567597465\nHe -0.29349758979535084 -1.0343456850833508 0.06894940726425373\nHe 0.29349758979535084 -0.22770257054025364 0.8755925218073509\nHe 0.29349758979535084 -1.2539936200357462 0.8755925218073509\nHe 0.29349758979535084 -0.22770257054025364 0.2885973422166492\nHe 0.29349758979535084 -1.2539936200357462 0.2885973422166492\nHe -0.29349758979535084 -0.22770257054025364 0.8755925218073509\nHe -0.29349758979535084 -1.2539936200357462 0.8755925218073509\nHe -0.29349758979535084 -0.22770257054025364 0.2885973422166492\nHe -0.29349758979535084 -1.2539936200357462 0.2885973422166492\nHe 0.5131455247477463 -0.4473505054926491 0.8755925218073509\nHe -0.5131455247477463 -0.4473505054926491 0.8755925218073509\nHe 0.5131455247477463 -0.4473505054926491 0.2885973422166492\nHe -0.5131455247477463 -0.4473505054926491 0.2885973422166492\nHe 0.5131455247477463 -1.0343456850833508 0.8755925218073509\nHe -0.5131455247477463 -1.0343456850833508 0.8755925218073509\nHe 0.5131455247477463 -1.0343456850833508 0.2885973422166492\nHe -0.5131455247477463 -1.0343456850833508 0.2885973422166492\nHe 0.08575613954490444 -0.6550919557430954 1.2308566517987871\nHe 0.08575613954490444 -0.6550919557430954 -0.06666678777478707\nHe 0.08575613954490444 -0.8266042348329045 1.2308566517987871\nHe 0.08575613954490444 -0.8266042348329045 -0.06666678777478707\nHe -0.08575613954490444 -0.6550919557430954 1.2308566517987871\nHe -0.08575613954490444 -0.6550919557430954 -0.06666678777478707\nHe -0.08575613954490444 -0.8266042348329045 1.2308566517987871\nHe -0.08575613954490444 -0.8266042348329045 -0.06666678777478707\nHe 0.08575613954490444 -0.09208637550121283 0.6678510715569045\nHe 0.08575613954490444 -1.389609815074787 0.6678510715569045\nHe 0.08575613954490444 -0.09208637550121283 0.4963387924670956\nHe 0.08575613954490444 -1.389609815074787 0.4963387924670956\nHe -0.08575613954490444 -0.09208637550121283 0.6678510715569045\nHe -0.08575613954490444 -1.389609815074787 0.6678510715569045\nHe -0.08575613954490444 -0.09208637550121283 0.4963387924670956\nHe -0.08575613954490444 -1.389609815074787 0.4963387924670956\nHe 0.6487617197867871 -0.6550919557430954 0.6678510715569045\nHe -0.6487617197867871 -0.6550919557430954 0.6678510715569045\nHe 0.6487617197867871 -0.6550919557430954 0.4963387924670956\nHe -0.6487617197867871 -0.6550919557430954 0.4963387924670956\nHe 0.6487617197867871 -0.8266042348329045 0.6678510715569045\nHe -0.6487617197867871 -0.8266042348329045 0.6678510715569045\nHe 0.6487617197867871 -0.8266042348329045 0.4963387924670956\nHe -0.6487617197867871 -0.8266042348329045 0.4963387924670956\nHe 0.22820834504234472 -0.12155741131718954 0.582094932012\nHe 0.22820834504234472 -1.3601387792588104 0.582094932012\nHe -0.22820834504234472 -0.12155741131718954 0.582094932012\nHe -0.22820834504234472 -1.3601387792588104 0.582094932012\nHe 0.6192906839708104 -0.5126397502456552 0.582094932012\nHe 0.6192906839708104 -0.9690564403303448 0.582094932012\nHe -0.6192906839708104 -0.5126397502456552 0.582094932012\nHe -0.6192906839708104 -0.9690564403303448 0.582094932012\nHe 0.22820834504234472 -0.740848095288 1.2013856159828105\nHe 0.22820834504234472 -0.740848095288 -0.03719575195881036\nHe -0.22820834504234472 -0.740848095288 1.2013856159828105\nHe -0.22820834504234472 -0.740848095288 -0.03719575195881036\nHe 0.6192906839708104 -0.740848095288 0.8103032770543448\nHe 0.6192906839708104 -0.740848095288 0.35388658696965536\nHe -0.6192906839708104 -0.740848095288 0.8103032770543448\nHe -0.6192906839708104 -0.740848095288 0.35388658696965536\nHe 0.0 -0.5126397502456552 1.2013856159828105\nHe 0.0 -0.5126397502456552 -0.03719575195881036\nHe 0.0 -0.9690564403303448 1.2013856159828105\nHe 0.0 -0.9690564403303448 -0.03719575195881036\nHe 0.0 -0.12155741131718954 0.8103032770543448\nHe 0.0 -0.12155741131718954 0.35388658696965536\nHe 0.0 -1.3601387792588104 0.8103032770543448\nHe 0.0 -1.3601387792588104 0.35388658696965536\nHe 0.10496752895531299 -0.18906432506957704 0.9286731898248038\nHe 0.10496752895531299 -0.18906432506957704 0.2355166741991963\nHe 0.10496752895531299 -1.292631865506423 0.9286731898248038\nHe 0.10496752895531299 -1.292631865506423 0.2355166741991963\nHe -0.10496752895531299 -0.18906432506957704 0.9286731898248038\nHe -0.10496752895531299 -0.18906432506957704 0.2355166741991963\nHe -0.10496752895531299 -1.292631865506423 0.9286731898248038\nHe -0.10496752895531299 -1.292631865506423 0.2355166741991963\nHe 0.10496752895531299 -0.3942698374751962 1.133878702230423\nHe 0.10496752895531299 -0.3942698374751962 0.030311161793577148\nHe 0.10496752895531299 -1.0874263531008037 1.133878702230423\nHe 0.10496752895531299 -1.0874263531008037 0.030311161793577148\nHe -0.10496752895531299 -0.3942698374751962 1.133878702230423\nHe -0.10496752895531299 -0.3942698374751962 0.030311161793577148\nHe -0.10496752895531299 -1.0874263531008037 1.133878702230423\nHe -0.10496752895531299 -1.0874263531008037 0.030311161793577148\nHe 0.5517837702184228 -0.635880566332687 0.9286731898248038\nHe 0.5517837702184228 -0.635880566332687 0.2355166741991963\nHe 0.5517837702184228 -0.8458156242433129 0.9286731898248038\nHe 0.5517837702184228 -0.8458156242433129 0.2355166741991963\nHe -0.5517837702184228 -0.635880566332687 0.9286731898248038\nHe -0.5517837702184228 -0.635880566332687 0.2355166741991963\nHe -0.5517837702184228 -0.8458156242433129 0.9286731898248038\nHe -0.5517837702184228 -0.8458156242433129 0.2355166741991963\nHe 0.5517837702184228 -0.3942698374751962 0.687062460967313\nHe 0.5517837702184228 -0.3942698374751962 0.4771274030566871\nHe 0.5517837702184228 -1.0874263531008037 0.687062460967313\nHe 0.5517837702184228 -1.0874263531008037 0.4771274030566871\nHe -0.5517837702184228 -0.3942698374751962 0.687062460967313\nHe -0.5517837702184228 -0.3942698374751962 0.4771274030566871\nHe -0.5517837702184228 -1.0874263531008037 0.687062460967313\nHe -0.5517837702184228 -1.0874263531008037 0.4771274030566871\nHe 0.3465782578128037 -0.635880566332687 1.133878702230423\nHe 0.3465782578128037 -0.635880566332687 0.030311161793577148\nHe 0.3465782578128037 -0.8458156242433129 1.133878702230423\nHe 0.3465782578128037 -0.8458156242433129 0.030311161793577148\nHe -0.3465782578128037 -0.635880566332687 1.133878702230423\nHe -0.3465782578128037 -0.635880566332687 0.030311161793577148\nHe -0.3465782578128037 -0.8458156242433129 1.133878702230423\nHe -0.3465782578128037 -0.8458156242433129 0.030311161793577148\nHe 0.3465782578128037 -0.18906432506957704 0.687062460967313\nHe 0.3465782578128037 -0.18906432506957704 0.4771274030566871\nHe 0.3465782578128037 -1.292631865506423 0.687062460967313\nHe 0.3465782578128037 -1.292631865506423 0.4771274030566871\nHe -0.3465782578128037 -0.18906432506957704 0.687062460967313\nHe -0.3465782578128037 -0.18906432506957704 0.4771274030566871\nHe -0.3465782578128037 -1.292631865506423 0.687062460967313\nHe -0.3465782578128037 -1.292631865506423 0.4771274030566871\n","xyz");
	viewer_1763995690649039.setStyle({"elem": "He"},{"sphere": {"radius": 0.05, "color": "red", "opacity": 0.5}});
	viewer_1763995690649039.zoomTo();
viewer_1763995690649039.render();
});
</script></div></div>
</div>
<p>2: The second issue can also be addressed quite simply; rather than describing each surface grid charge as a point charge, one can instead use spherical Gaussians. This is done by introducing a Gaussian basis <span class="math notranslate nohighlight">\(\chi_k\)</span> at each surface charge <span class="math notranslate nohighlight">\(q_k\)</span>, effectively smearing the charge into a normalized density <span class="math notranslate nohighlight">\(g_k\)</span> (keeping the total charge fixed, <em>i.e.</em>, <span class="math notranslate nohighlight">\(\int g_k \text{d}^3 r = q_k\)</span>), centered at <span class="math notranslate nohighlight">\(\mathbf{s}_k\)</span>,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
    \displaystyle g_k(r) = q_k \chi_k(r) = q_k \left( \frac{\zeta_k^2}{\pi} \right)^{3/2} e^{-\zeta_k^2 |\mathbf{r} - \mathbf{s}_k|^2}
\end{equation*}\]</div>
<p>where each point is assigned a width parameter</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\displaystyle \zeta_k = \frac{\zeta}{R_k \sqrt{w_k}}
\end{equation*}\]</div>
<p>that is naturally related to the quadrature weight <span class="math notranslate nohighlight">\(w_k\)</span>. Note that as the width goes to zero we approach the point charge description. The parameter <span class="math notranslate nohighlight">\(\zeta\)</span> is optimized for each Lebedev quadrature level. With this representation, Coulomb interactions become <em>screened</em>—approaching a constant value for small separations—thereby resolving the divergence problem in intersecting regions.</p>
<p>3: For the third issue, consider a specific grid point <span class="math notranslate nohighlight">\(j \in \Gamma_J\)</span>, where <span class="math notranslate nohighlight">\(\Gamma_J \subset \Gamma\)</span> is the portion of the cavity surface associated with atom <span class="math notranslate nohighlight">\(J\)</span>. When atom <span class="math notranslate nohighlight">\(J\)</span> is perturbed, the corresponding surface <span class="math notranslate nohighlight">\(\Gamma_J\)</span>, and so grid point <span class="math notranslate nohighlight">\(j\)</span>, is also displaced. After the perturbation, it might be that point <span class="math notranslate nohighlight">\(j\)</span> winds up inside a neighbouring atomic sphere. In that case, it is no longer part of the cavity surface and so no longer represent a surface charge – it is effectively turned off (see figure below). The problem is that both the total cavity surface and the electrostatic energy, which depends on interactions with these grid points, become discontinuous functions of the nuclear coordinates.</p>
<figure class="align-center" id="cavity-perturbation">
<img alt="../../_images/cavity_perturb.png" src="../../_images/cavity_perturb.png" />
<figcaption>
<p><span class="caption-number">Fig. 17 </span><span class="caption-text">Two-dimensional slice of a diatomic molecule.</span><a class="headerlink" href="#cavity-perturbation" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Ideally, the switching on/off of surface points should be a smooth function of the nuclear coordinates. A switching function <span class="math notranslate nohighlight">\(F_k\)</span> is introduced for each grid point <span class="math notranslate nohighlight">\(k\)</span>, with <span class="math notranslate nohighlight">\(0 \leq F_k \leq 1\)</span> indicating whether it is on, off, or—crucially—<em>partially</em> on.</p>
<p>The switching function must account for all atoms in the molecule – except the one to which the grid point is inherently associated, since it is, by definition, always on that atom’s surface. To achieve this, the switching function <span class="math notranslate nohighlight">\(F_k\)</span> is constructed as a product of elementary switching functions <span class="math notranslate nohighlight">\(f\)</span>, taken over all atoms:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} F_k = \prod_{J, k \notin J}^{\text{atoms}} f(\mathbf{s}_k, \mathbf{R}_J) \end{equation*}\]</div>
<p>The position of atom <span class="math notranslate nohighlight">\(J\)</span> is denoted <span class="math notranslate nohighlight">\(\mathbf{R}_J\)</span>, and the elementary switching function satisfies <span class="math notranslate nohighlight">\(0 \leq f(\mathbf{s}_k, \mathbf{R}_J) \leq 1\)</span>. The idea behind the elementary switching function <span class="math notranslate nohighlight">\(f\)</span> is to exploit the spatial extent of the Gaussian surface charges. This is done by computing the fraction of normalized charge that lies inside the sphere of atom <span class="math notranslate nohighlight">\(J\)</span>—which is preciesly the quantity in curly braces in the following expression:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} f(\mathbf{s}_k, \mathbf{R}_J) =  1 - \frac{1}{2} \left\{ \text{erf} (\zeta_{k} [ R_J + |\mathbf{R}_J - \mathbf{s}_k |) + \text{erf} (\zeta_{k} [ R_J - |\mathbf{R}_J - \mathbf{s}_k|) \right\} \end{equation*}\]</div>
<p>Using the function below, one can see the switching function value of each grid point.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">visualize_cpcm_grid</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">sw_f</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Visualizes grid for surface discretization.</span>

<span class="sd">    :param molecule:</span>
<span class="sd">        The molecule.</span>
<span class="sd">    :param grid:</span>
<span class="sd">        The grid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">grid_in_angstrom</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">bohr_in_angstrom</span><span class="p">()</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">p3d</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>

    <span class="n">v</span><span class="o">.</span><span class="n">addModel</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">get_xyz_string</span><span class="p">(),</span> <span class="s1">&#39;xyz&#39;</span><span class="p">)</span>
    <span class="n">v</span><span class="o">.</span><span class="n">setStyle</span><span class="p">({</span><span class="s1">&#39;stick&#39;</span><span class="p">:</span> <span class="p">{}})</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">grid_in_angstrom</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">grid_in_angstrom</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>

        <span class="n">color</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">to_hex</span><span class="p">(</span><span class="n">cmap</span><span class="p">(</span><span class="n">sw_f</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
        <span class="n">v</span><span class="o">.</span><span class="n">addSphere</span><span class="p">({</span>
            <span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="n">z</span><span class="p">},</span>
            <span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="n">color</span><span class="p">,</span>
            <span class="s1">&#39;opacity&#39;</span><span class="p">:</span> <span class="mf">0.6</span>
        <span class="p">})</span>

    <span class="n">v</span><span class="o">.</span><span class="n">zoomTo</span><span class="p">()</span>
    <span class="n">v</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">colorbar</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    
        <span class="n">sm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;Switching-function value&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gps</span> <span class="o">=</span> <span class="mi">194</span>
<span class="n">full_grid</span><span class="p">,</span> <span class="n">full_sw_f</span> <span class="o">=</span> <span class="n">raw_grid</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">gps</span><span class="p">)</span>

<span class="n">visualize_cpcm_grid</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">full_grid</span><span class="p">,</span> <span class="n">full_sw_f</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div id="3dmolviewer_1763995690714717"  style="position: relative; width: 600px; height: 600px;">
        <p id="3dmolwarning_1763995690714717" style="background-color:#ffcccc;color:black">3Dmol.js failed to load for some reason.  Please check your browser console for error messages.<br></p>
        </div>
<script>

var loadScriptAsync = function(uri){
  return new Promise((resolve, reject) => {
    //this is to ignore the existence of requirejs amd
    var savedexports, savedmodule;
    if (typeof exports !== 'undefined') savedexports = exports;
    else exports = {}
    if (typeof module !== 'undefined') savedmodule = module;
    else module = {}

    var tag = document.createElement('script');
    tag.src = uri;
    tag.async = true;
    tag.onload = () => {
        exports = savedexports;
        module = savedmodule;
        resolve();
    };
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
});
};

if(typeof $3Dmolpromise === 'undefined') {
$3Dmolpromise = null;
  $3Dmolpromise = loadScriptAsync('https://cdn.jsdelivr.net/npm/3dmol@2.5.0/build/3Dmol-min.js');
}

var viewer_1763995690714717 = null;
var warn = document.getElementById("3dmolwarning_1763995690714717");
if(warn) {
    warn.parentNode.removeChild(warn);
}
$3Dmolpromise.then(function() {
viewer_1763995690714717 = $3Dmol.createViewer(document.getElementById("3dmolviewer_1763995690714717"),{backgroundColor:"white"});
viewer_1763995690714717.zoomTo();
	viewer_1763995690714717.addModel("3\n\nO              0.000000000000         0.000000000000         0.000000000000\nH              0.000000000000         0.740848095288         0.582094932012\nH              0.000000000000        -0.740848095288         0.582094932012\n","xyz");
	viewer_1763995690714717.setStyle({"stick": {}});
	viewer_1763995690714717.addSphere({"center": {"x": 1.824, "y": 0.0, "z": 0.0}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.824, "y": 0.0, "z": 0.0}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 1.824, "z": 0.0}, "radius": 0.05, "color": "#450457", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -1.824, "z": 0.0}, "radius": 0.05, "color": "#450457", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 0.0, "z": 1.824}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 0.0, "z": -1.824}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 1.2897627688842626, "z": 1.2897627688842626}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 1.2897627688842626, "z": -1.2897627688842626}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -1.2897627688842626, "z": 1.2897627688842626}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -1.2897627688842626, "z": -1.2897627688842626}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2897627688842626, "y": 0.0, "z": 1.2897627688842626}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2897627688842626, "y": 0.0, "z": -1.2897627688842626}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2897627688842626, "y": 0.0, "z": 1.2897627688842626}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2897627688842626, "y": 0.0, "z": -1.2897627688842626}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2897627688842626, "y": 1.2897627688842626, "z": 0.0}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2897627688842626, "y": -1.2897627688842626, "z": 0.0}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2897627688842626, "y": 1.2897627688842626, "z": 0.0}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2897627688842626, "y": -1.2897627688842626, "z": 0.0}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.0530868910018776, "y": 1.0530868910018776, "z": 1.0530868910018776}, "radius": 0.05, "color": "#470e61", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.0530868910018776, "y": 1.0530868910018776, "z": -1.0530868910018776}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.0530868910018776, "y": -1.0530868910018776, "z": 1.0530868910018776}, "radius": 0.05, "color": "#470e61", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.0530868910018776, "y": -1.0530868910018776, "z": -1.0530868910018776}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.0530868910018776, "y": 1.0530868910018776, "z": 1.0530868910018776}, "radius": 0.05, "color": "#470e61", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.0530868910018776, "y": 1.0530868910018776, "z": -1.0530868910018776}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.0530868910018776, "y": -1.0530868910018776, "z": 1.0530868910018776}, "radius": 0.05, "color": "#470e61", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.0530868910018776, "y": -1.0530868910018776, "z": -1.0530868910018776}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2244463559476093, "y": 1.2244463559476093, "z": 0.5730953173890374}, "radius": 0.05, "color": "#228b8d", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2244463559476093, "y": 1.2244463559476093, "z": -0.5730953173890374}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2244463559476093, "y": -1.2244463559476093, "z": 0.5730953173890374}, "radius": 0.05, "color": "#228b8d", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2244463559476093, "y": -1.2244463559476093, "z": -0.5730953173890374}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2244463559476093, "y": 1.2244463559476093, "z": 0.5730953173890374}, "radius": 0.05, "color": "#228b8d", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2244463559476093, "y": 1.2244463559476093, "z": -0.5730953173890374}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2244463559476093, "y": -1.2244463559476093, "z": 0.5730953173890374}, "radius": 0.05, "color": "#228b8d", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2244463559476093, "y": -1.2244463559476093, "z": -0.5730953173890374}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2244463559476093, "y": 0.5730953173890374, "z": 1.2244463559476093}, "radius": 0.05, "color": "#9dd93b", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2244463559476093, "y": -0.5730953173890374, "z": 1.2244463559476093}, "radius": 0.05, "color": "#9dd93b", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2244463559476093, "y": 0.5730953173890374, "z": -1.2244463559476093}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2244463559476093, "y": -0.5730953173890374, "z": -1.2244463559476093}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2244463559476093, "y": 0.5730953173890374, "z": 1.2244463559476093}, "radius": 0.05, "color": "#9dd93b", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2244463559476093, "y": -0.5730953173890374, "z": 1.2244463559476093}, "radius": 0.05, "color": "#9dd93b", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2244463559476093, "y": 0.5730953173890374, "z": -1.2244463559476093}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2244463559476093, "y": -0.5730953173890374, "z": -1.2244463559476093}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5730953173890374, "y": 1.2244463559476093, "z": 1.2244463559476093}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5730953173890374, "y": 1.2244463559476093, "z": 1.2244463559476093}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5730953173890374, "y": 1.2244463559476093, "z": -1.2244463559476093}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5730953173890374, "y": 1.2244463559476093, "z": -1.2244463559476093}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5730953173890374, "y": -1.2244463559476093, "z": 1.2244463559476093}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5730953173890374, "y": -1.2244463559476093, "z": 1.2244463559476093}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5730953173890374, "y": -1.2244463559476093, "z": -1.2244463559476093}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5730953173890374, "y": -1.2244463559476093, "z": -1.2244463559476093}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5275857304697601, "y": 0.5275857304697601, "z": 1.664416592686272}, "radius": 0.05, "color": "#481b6d", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5275857304697601, "y": 0.5275857304697601, "z": -1.664416592686272}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5275857304697601, "y": -0.5275857304697601, "z": 1.664416592686272}, "radius": 0.05, "color": "#481b6d", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5275857304697601, "y": -0.5275857304697601, "z": -1.664416592686272}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5275857304697601, "y": 0.5275857304697601, "z": 1.664416592686272}, "radius": 0.05, "color": "#481b6d", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5275857304697601, "y": 0.5275857304697601, "z": -1.664416592686272}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5275857304697601, "y": -0.5275857304697601, "z": 1.664416592686272}, "radius": 0.05, "color": "#481b6d", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5275857304697601, "y": -0.5275857304697601, "z": -1.664416592686272}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5275857304697601, "y": 1.664416592686272, "z": 0.5275857304697601}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5275857304697601, "y": -1.664416592686272, "z": 0.5275857304697601}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5275857304697601, "y": 1.664416592686272, "z": -0.5275857304697601}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5275857304697601, "y": -1.664416592686272, "z": -0.5275857304697601}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5275857304697601, "y": 1.664416592686272, "z": 0.5275857304697601}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5275857304697601, "y": -1.664416592686272, "z": 0.5275857304697601}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5275857304697601, "y": 1.664416592686272, "z": -0.5275857304697601}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5275857304697601, "y": -1.664416592686272, "z": -0.5275857304697601}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.664416592686272, "y": 0.5275857304697601, "z": 0.5275857304697601}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.664416592686272, "y": 0.5275857304697601, "z": 0.5275857304697601}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.664416592686272, "y": 0.5275857304697601, "z": -0.5275857304697601}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.664416592686272, "y": 0.5275857304697601, "z": -0.5275857304697601}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.664416592686272, "y": -0.5275857304697601, "z": 0.5275857304697601}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.664416592686272, "y": -0.5275857304697601, "z": 0.5275857304697601}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.664416592686272, "y": -0.5275857304697601, "z": -0.5275857304697601}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.664416592686272, "y": -0.5275857304697601, "z": -0.5275857304697601}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8111206117980606, "y": 0.8111206117980606, "z": 1.4181476320301354}, "radius": 0.05, "color": "#450559", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8111206117980606, "y": 0.8111206117980606, "z": -1.4181476320301354}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8111206117980606, "y": -0.8111206117980606, "z": 1.4181476320301354}, "radius": 0.05, "color": "#450559", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8111206117980606, "y": -0.8111206117980606, "z": -1.4181476320301354}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8111206117980606, "y": 0.8111206117980606, "z": 1.4181476320301354}, "radius": 0.05, "color": "#450559", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8111206117980606, "y": 0.8111206117980606, "z": -1.4181476320301354}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8111206117980606, "y": -0.8111206117980606, "z": 1.4181476320301354}, "radius": 0.05, "color": "#450559", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8111206117980606, "y": -0.8111206117980606, "z": -1.4181476320301354}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8111206117980606, "y": 1.4181476320301354, "z": 0.8111206117980606}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8111206117980606, "y": -1.4181476320301354, "z": 0.8111206117980606}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8111206117980606, "y": 1.4181476320301354, "z": -0.8111206117980606}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8111206117980606, "y": -1.4181476320301354, "z": -0.8111206117980606}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8111206117980606, "y": 1.4181476320301354, "z": 0.8111206117980606}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8111206117980606, "y": -1.4181476320301354, "z": 0.8111206117980606}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8111206117980606, "y": 1.4181476320301354, "z": -0.8111206117980606}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8111206117980606, "y": -1.4181476320301354, "z": -0.8111206117980606}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.4181476320301354, "y": 0.8111206117980606, "z": 0.8111206117980606}, "radius": 0.05, "color": "#e2e418", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.4181476320301354, "y": 0.8111206117980606, "z": 0.8111206117980606}, "radius": 0.05, "color": "#e2e418", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.4181476320301354, "y": 0.8111206117980606, "z": -0.8111206117980606}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.4181476320301354, "y": 0.8111206117980606, "z": -0.8111206117980606}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.4181476320301354, "y": -0.8111206117980606, "z": 0.8111206117980606}, "radius": 0.05, "color": "#e2e418", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.4181476320301354, "y": -0.8111206117980606, "z": 0.8111206117980606}, "radius": 0.05, "color": "#e2e418", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.4181476320301354, "y": -0.8111206117980606, "z": -0.8111206117980606}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.4181476320301354, "y": -0.8111206117980606, "z": -0.8111206117980606}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.23699878565137222, "y": 0.23699878565137222, "z": 1.79294148013803}, "radius": 0.05, "color": "#20a486", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.23699878565137222, "y": 0.23699878565137222, "z": -1.79294148013803}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.23699878565137222, "y": -0.23699878565137222, "z": 1.79294148013803}, "radius": 0.05, "color": "#20a486", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.23699878565137222, "y": -0.23699878565137222, "z": -1.79294148013803}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.23699878565137222, "y": 0.23699878565137222, "z": 1.79294148013803}, "radius": 0.05, "color": "#20a486", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.23699878565137222, "y": 0.23699878565137222, "z": -1.79294148013803}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.23699878565137222, "y": -0.23699878565137222, "z": 1.79294148013803}, "radius": 0.05, "color": "#20a486", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.23699878565137222, "y": -0.23699878565137222, "z": -1.79294148013803}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.23699878565137222, "y": 1.79294148013803, "z": 0.23699878565137222}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.23699878565137222, "y": -1.79294148013803, "z": 0.23699878565137222}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.23699878565137222, "y": 1.79294148013803, "z": -0.23699878565137222}, "radius": 0.05, "color": "#4cc26c", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.23699878565137222, "y": -1.79294148013803, "z": -0.23699878565137222}, "radius": 0.05, "color": "#4cc26c", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.23699878565137222, "y": 1.79294148013803, "z": 0.23699878565137222}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.23699878565137222, "y": -1.79294148013803, "z": 0.23699878565137222}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.23699878565137222, "y": 1.79294148013803, "z": -0.23699878565137222}, "radius": 0.05, "color": "#4cc26c", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.23699878565137222, "y": -1.79294148013803, "z": -0.23699878565137222}, "radius": 0.05, "color": "#4cc26c", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.79294148013803, "y": 0.23699878565137222, "z": 0.23699878565137222}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.79294148013803, "y": 0.23699878565137222, "z": 0.23699878565137222}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.79294148013803, "y": 0.23699878565137222, "z": -0.23699878565137222}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.79294148013803, "y": 0.23699878565137222, "z": -0.23699878565137222}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.79294148013803, "y": -0.23699878565137222, "z": 0.23699878565137222}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.79294148013803, "y": -0.23699878565137222, "z": 0.23699878565137222}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.79294148013803, "y": -0.23699878565137222, "z": -0.23699878565137222}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.79294148013803, "y": -0.23699878565137222, "z": -0.23699878565137222}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6306848808442981, "y": 1.7114942538829672, "z": 0.0}, "radius": 0.05, "color": "#2e6e8e", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6306848808442981, "y": -1.7114942538829672, "z": 0.0}, "radius": 0.05, "color": "#2e6e8e", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6306848808442981, "y": 1.7114942538829672, "z": 0.0}, "radius": 0.05, "color": "#2e6e8e", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6306848808442981, "y": -1.7114942538829672, "z": 0.0}, "radius": 0.05, "color": "#2e6e8e", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.7114942538829672, "y": 0.6306848808442981, "z": 0.0}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.7114942538829672, "y": -0.6306848808442981, "z": 0.0}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.7114942538829672, "y": 0.6306848808442981, "z": 0.0}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.7114942538829672, "y": -0.6306848808442981, "z": 0.0}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6306848808442981, "y": 0.0, "z": 1.7114942538829672}, "radius": 0.05, "color": "#f8e621", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6306848808442981, "y": 0.0, "z": -1.7114942538829672}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6306848808442981, "y": 0.0, "z": 1.7114942538829672}, "radius": 0.05, "color": "#f8e621", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6306848808442981, "y": 0.0, "z": -1.7114942538829672}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.7114942538829672, "y": 0.0, "z": 0.6306848808442981}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.7114942538829672, "y": 0.0, "z": -0.6306848808442981}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.7114942538829672, "y": 0.0, "z": 0.6306848808442981}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.7114942538829672, "y": 0.0, "z": -0.6306848808442981}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 0.6306848808442981, "z": 1.7114942538829672}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 0.6306848808442981, "z": -1.7114942538829672}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -0.6306848808442981, "z": 1.7114942538829672}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -0.6306848808442981, "z": -1.7114942538829672}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 1.7114942538829672, "z": 0.6306848808442981}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 1.7114942538829672, "z": -0.6306848808442981}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -1.7114942538829672, "z": 0.6306848808442981}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -1.7114942538829672, "z": -0.6306848808442981}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.29009208002195586, "y": 1.5249296922400049, "z": 0.957816276137203}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.29009208002195586, "y": 1.5249296922400049, "z": -0.957816276137203}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.29009208002195586, "y": -1.5249296922400049, "z": 0.957816276137203}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.29009208002195586, "y": -1.5249296922400049, "z": -0.957816276137203}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.29009208002195586, "y": 1.5249296922400049, "z": 0.957816276137203}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.29009208002195586, "y": 1.5249296922400049, "z": -0.957816276137203}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.29009208002195586, "y": -1.5249296922400049, "z": 0.957816276137203}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.29009208002195586, "y": -1.5249296922400049, "z": -0.957816276137203}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.29009208002195586, "y": 0.957816276137203, "z": 1.5249296922400049}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.29009208002195586, "y": 0.957816276137203, "z": -1.5249296922400049}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.29009208002195586, "y": -0.957816276137203, "z": 1.5249296922400049}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.29009208002195586, "y": -0.957816276137203, "z": -1.5249296922400049}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.29009208002195586, "y": 0.957816276137203, "z": 1.5249296922400049}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.29009208002195586, "y": 0.957816276137203, "z": -1.5249296922400049}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.29009208002195586, "y": -0.957816276137203, "z": 1.5249296922400049}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.29009208002195586, "y": -0.957816276137203, "z": -1.5249296922400049}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.5249296922400049, "y": 0.29009208002195586, "z": 0.957816276137203}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.5249296922400049, "y": 0.29009208002195586, "z": -0.957816276137203}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.5249296922400049, "y": -0.29009208002195586, "z": 0.957816276137203}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.5249296922400049, "y": -0.29009208002195586, "z": -0.957816276137203}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.5249296922400049, "y": 0.29009208002195586, "z": 0.957816276137203}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.5249296922400049, "y": 0.29009208002195586, "z": -0.957816276137203}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.5249296922400049, "y": -0.29009208002195586, "z": 0.957816276137203}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.5249296922400049, "y": -0.29009208002195586, "z": -0.957816276137203}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.5249296922400049, "y": 0.957816276137203, "z": 0.29009208002195586}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.5249296922400049, "y": 0.957816276137203, "z": -0.29009208002195586}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.5249296922400049, "y": -0.957816276137203, "z": 0.29009208002195586}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.5249296922400049, "y": -0.957816276137203, "z": -0.29009208002195586}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.5249296922400049, "y": 0.957816276137203, "z": 0.29009208002195586}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.5249296922400049, "y": 0.957816276137203, "z": -0.29009208002195586}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.5249296922400049, "y": -0.957816276137203, "z": 0.29009208002195586}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.5249296922400049, "y": -0.957816276137203, "z": -0.29009208002195586}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.957816276137203, "y": 0.29009208002195586, "z": 1.5249296922400049}, "radius": 0.05, "color": "#cae11f", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.957816276137203, "y": 0.29009208002195586, "z": -1.5249296922400049}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.957816276137203, "y": -0.29009208002195586, "z": 1.5249296922400049}, "radius": 0.05, "color": "#cae11f", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.957816276137203, "y": -0.29009208002195586, "z": -1.5249296922400049}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.957816276137203, "y": 0.29009208002195586, "z": 1.5249296922400049}, "radius": 0.05, "color": "#cae11f", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.957816276137203, "y": 0.29009208002195586, "z": -1.5249296922400049}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.957816276137203, "y": -0.29009208002195586, "z": 1.5249296922400049}, "radius": 0.05, "color": "#cae11f", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.957816276137203, "y": -0.29009208002195586, "z": -1.5249296922400049}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.957816276137203, "y": 1.5249296922400049, "z": 0.29009208002195586}, "radius": 0.05, "color": "#3c508b", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.957816276137203, "y": 1.5249296922400049, "z": -0.29009208002195586}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.957816276137203, "y": -1.5249296922400049, "z": 0.29009208002195586}, "radius": 0.05, "color": "#3c508b", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.957816276137203, "y": -1.5249296922400049, "z": -0.29009208002195586}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.957816276137203, "y": 1.5249296922400049, "z": 0.29009208002195586}, "radius": 0.05, "color": "#3c508b", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.957816276137203, "y": 1.5249296922400049, "z": -0.29009208002195586}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.957816276137203, "y": -1.5249296922400049, "z": 0.29009208002195586}, "radius": 0.05, "color": "#3c508b", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.957816276137203, "y": -1.5249296922400049, "z": -0.29009208002195586}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.32, "y": 0.740848095288, "z": 0.582094932012}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.32, "y": 0.740848095288, "z": 0.582094932012}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 2.060848095288, "z": 0.582094932012}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -0.5791519047120001, "z": 0.582094932012}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 0.740848095288, "z": 1.9020949320120002}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 0.740848095288, "z": -0.737905067988}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 1.6742290464542426, "z": 1.5154758831782429}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 1.6742290464542426, "z": -0.3512860191542426}, "radius": 0.05, "color": "#450559", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -0.19253285587824273, "z": 1.5154758831782429}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -0.19253285587824273, "z": -0.3512860191542426}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.9333809511662426, "y": 0.740848095288, "z": 1.5154758831782429}, "radius": 0.05, "color": "#f1e51d", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.9333809511662426, "y": 0.740848095288, "z": -0.3512860191542426}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.9333809511662426, "y": 0.740848095288, "z": 1.5154758831782429}, "radius": 0.05, "color": "#f1e51d", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.9333809511662426, "y": 0.740848095288, "z": -0.3512860191542426}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.9333809511662426, "y": 1.6742290464542426, "z": 0.582094932012}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.9333809511662426, "y": -0.19253285587824273, "z": 0.582094932012}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.9333809511662426, "y": 1.6742290464542426, "z": 0.582094932012}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.9333809511662426, "y": -0.19253285587824273, "z": 0.582094932012}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.7621023553303061, "y": 1.502950450618306, "z": 1.3441972873423063}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.7621023553303061, "y": 1.502950450618306, "z": -0.18000742331830605}, "radius": 0.05, "color": "#440256", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.7621023553303061, "y": -0.021254260042306156, "z": 1.3441972873423063}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.7621023553303061, "y": -0.021254260042306156, "z": -0.18000742331830605}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.7621023553303061, "y": 1.502950450618306, "z": 1.3441972873423063}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.7621023553303061, "y": 1.502950450618306, "z": -0.18000742331830605}, "radius": 0.05, "color": "#440256", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.7621023553303061, "y": -0.021254260042306156, "z": 1.3441972873423063}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.7621023553303061, "y": -0.021254260042306156, "z": -0.18000742331830605}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8861124944357698, "y": 1.6269605897237698, "z": 0.996834964333014}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8861124944357698, "y": 1.6269605897237698, "z": 0.1673548996909861}, "radius": 0.05, "color": "#65cb5e", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8861124944357698, "y": -0.14526439914776984, "z": 0.996834964333014}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8861124944357698, "y": -0.14526439914776984, "z": 0.1673548996909861}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8861124944357698, "y": 1.6269605897237698, "z": 0.996834964333014}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8861124944357698, "y": 1.6269605897237698, "z": 0.1673548996909861}, "radius": 0.05, "color": "#65cb5e", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8861124944357698, "y": -0.14526439914776984, "z": 0.996834964333014}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8861124944357698, "y": -0.14526439914776984, "z": 0.1673548996909861}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8861124944357698, "y": 1.1555881276090139, "z": 1.4682074264477698}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8861124944357698, "y": 0.326108062966986, "z": 1.4682074264477698}, "radius": 0.05, "color": "#481769", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8861124944357698, "y": 1.1555881276090139, "z": -0.30401756242376976}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8861124944357698, "y": 0.326108062966986, "z": -0.30401756242376976}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8861124944357698, "y": 1.1555881276090139, "z": 1.4682074264477698}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8861124944357698, "y": 0.326108062966986, "z": 1.4682074264477698}, "radius": 0.05, "color": "#481769", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8861124944357698, "y": 1.1555881276090139, "z": -0.30401756242376976}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8861124944357698, "y": 0.326108062966986, "z": -0.30401756242376976}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.4147400323210139, "y": 1.6269605897237698, "z": 1.4682074264477698}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.4147400323210139, "y": 1.6269605897237698, "z": 1.4682074264477698}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.4147400323210139, "y": 1.6269605897237698, "z": -0.30401756242376976}, "radius": 0.05, "color": "#450457", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.4147400323210139, "y": 1.6269605897237698, "z": -0.30401756242376976}, "radius": 0.05, "color": "#450457", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.4147400323210139, "y": -0.14526439914776984, "z": 1.4682074264477698}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.4147400323210139, "y": -0.14526439914776984, "z": 1.4682074264477698}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.4147400323210139, "y": -0.14526439914776984, "z": -0.30401756242376976}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.4147400323210139, "y": -0.14526439914776984, "z": -0.30401756242376976}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.381805462839958, "y": 1.1226535581279578, "z": 1.7866069398770654}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.381805462839958, "y": 1.1226535581279578, "z": -0.6224170758530654}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.381805462839958, "y": 0.35904263244804197, "z": 1.7866069398770654}, "radius": 0.05, "color": "#70cf57", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.381805462839958, "y": 0.35904263244804197, "z": -0.6224170758530654}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.381805462839958, "y": 1.1226535581279578, "z": 1.7866069398770654}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.381805462839958, "y": 1.1226535581279578, "z": -0.6224170758530654}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.381805462839958, "y": 0.35904263244804197, "z": 1.7866069398770654}, "radius": 0.05, "color": "#70cf57", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.381805462839958, "y": 0.35904263244804197, "z": -0.6224170758530654}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.381805462839958, "y": 1.9453601031530654, "z": 0.963900394851958}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.381805462839958, "y": -0.4636639125770655, "z": 0.963900394851958}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.381805462839958, "y": 1.9453601031530654, "z": 0.20028946917204207}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.381805462839958, "y": -0.4636639125770655, "z": 0.20028946917204207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.381805462839958, "y": 1.9453601031530654, "z": 0.963900394851958}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.381805462839958, "y": -0.4636639125770655, "z": 0.963900394851958}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.381805462839958, "y": 1.9453601031530654, "z": 0.20028946917204207}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.381805462839958, "y": -0.4636639125770655, "z": 0.20028946917204207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2045120078650655, "y": 1.1226535581279578, "z": 0.963900394851958}, "radius": 0.05, "color": "#e5e419", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2045120078650655, "y": 1.1226535581279578, "z": 0.963900394851958}, "radius": 0.05, "color": "#e5e419", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2045120078650655, "y": 1.1226535581279578, "z": 0.20028946917204207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2045120078650655, "y": 1.1226535581279578, "z": 0.20028946917204207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2045120078650655, "y": 0.35904263244804197, "z": 0.963900394851958}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2045120078650655, "y": 0.35904263244804197, "z": 0.963900394851958}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2045120078650655, "y": 0.35904263244804197, "z": 0.20028946917204207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2045120078650655, "y": 0.35904263244804197, "z": 0.20028946917204207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5869951795907017, "y": 1.3278432748787017, "z": 1.6083859815074926}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5869951795907017, "y": 1.3278432748787017, "z": -0.4441961174834926}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5869951795907017, "y": 0.15385291569729823, "z": 1.6083859815074926}, "radius": 0.05, "color": "#46075a", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5869951795907017, "y": 0.15385291569729823, "z": -0.4441961174834926}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5869951795907017, "y": 1.3278432748787017, "z": 1.6083859815074926}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5869951795907017, "y": 1.3278432748787017, "z": -0.4441961174834926}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5869951795907017, "y": 0.15385291569729823, "z": 1.6083859815074926}, "radius": 0.05, "color": "#46075a", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5869951795907017, "y": 0.15385291569729823, "z": -0.4441961174834926}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5869951795907017, "y": 1.7671391447834925, "z": 1.1690901116027017}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5869951795907017, "y": -0.28544295420749266, "z": 1.1690901116027017}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5869951795907017, "y": 1.7671391447834925, "z": -0.004900247578701679}, "radius": 0.05, "color": "#6ccd5a", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5869951795907017, "y": -0.28544295420749266, "z": -0.004900247578701679}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5869951795907017, "y": 1.7671391447834925, "z": 1.1690901116027017}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5869951795907017, "y": -0.28544295420749266, "z": 1.1690901116027017}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5869951795907017, "y": 1.7671391447834925, "z": -0.004900247578701679}, "radius": 0.05, "color": "#6ccd5a", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5869951795907017, "y": -0.28544295420749266, "z": -0.004900247578701679}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.0262910494954927, "y": 1.3278432748787017, "z": 1.1690901116027017}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.0262910494954927, "y": 1.3278432748787017, "z": 1.1690901116027017}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.0262910494954927, "y": 1.3278432748787017, "z": -0.004900247578701679}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.0262910494954927, "y": 1.3278432748787017, "z": -0.004900247578701679}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.0262910494954927, "y": 0.15385291569729823, "z": 1.1690901116027017}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.0262910494954927, "y": 0.15385291569729823, "z": 1.1690901116027017}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.0262910494954927, "y": 0.15385291569729823, "z": -0.004900247578701679}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.0262910494954927, "y": 0.15385291569729823, "z": -0.004900247578701679}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.17151227908980887, "y": 0.9123603743778088, "z": 1.8796183715855743}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.17151227908980887, "y": 0.9123603743778088, "z": -0.7154285075615742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.17151227908980887, "y": 0.5693358161981911, "z": 1.8796183715855743}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.17151227908980887, "y": 0.5693358161981911, "z": -0.7154285075615742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.17151227908980887, "y": 0.9123603743778088, "z": 1.8796183715855743}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.17151227908980887, "y": 0.9123603743778088, "z": -0.7154285075615742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.17151227908980887, "y": 0.5693358161981911, "z": 1.8796183715855743}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.17151227908980887, "y": 0.5693358161981911, "z": -0.7154285075615742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.17151227908980887, "y": 2.0383715348615743, "z": 0.753607211101809}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.17151227908980887, "y": -0.5566753442855743, "z": 0.753607211101809}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.17151227908980887, "y": 2.0383715348615743, "z": 0.4105826529221912}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.17151227908980887, "y": -0.5566753442855743, "z": 0.4105826529221912}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.17151227908980887, "y": 2.0383715348615743, "z": 0.753607211101809}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.17151227908980887, "y": -0.5566753442855743, "z": 0.753607211101809}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.17151227908980887, "y": 2.0383715348615743, "z": 0.4105826529221912}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.17151227908980887, "y": -0.5566753442855743, "z": 0.4105826529221912}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2975234395735742, "y": 0.9123603743778088, "z": 0.753607211101809}, "radius": 0.05, "color": "#481668", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2975234395735742, "y": 0.9123603743778088, "z": 0.753607211101809}, "radius": 0.05, "color": "#481668", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2975234395735742, "y": 0.9123603743778088, "z": 0.4105826529221912}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2975234395735742, "y": 0.9123603743778088, "z": 0.4105826529221912}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2975234395735742, "y": 0.5693358161981911, "z": 0.753607211101809}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2975234395735742, "y": 0.5693358161981911, "z": 0.753607211101809}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2975234395735742, "y": 0.5693358161981911, "z": 0.4105826529221912}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2975234395735742, "y": 0.5693358161981911, "z": 0.4105826529221912}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.45641669008468944, "y": 1.9794294632296208, "z": 0.582094932012}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.45641669008468944, "y": -0.49773327265362083, "z": 0.582094932012}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.45641669008468944, "y": 1.9794294632296208, "z": 0.582094932012}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.45641669008468944, "y": -0.49773327265362083, "z": 0.582094932012}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2385813679416209, "y": 1.1972647853726892, "z": 0.582094932012}, "radius": 0.05, "color": "#25848e", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2385813679416209, "y": 0.2844314052033105, "z": 0.582094932012}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2385813679416209, "y": 1.1972647853726892, "z": 0.582094932012}, "radius": 0.05, "color": "#25848e", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2385813679416209, "y": 0.2844314052033105, "z": 0.582094932012}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.45641669008468944, "y": 0.740848095288, "z": 1.8206762999536208}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.45641669008468944, "y": 0.740848095288, "z": -0.6564864359296207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.45641669008468944, "y": 0.740848095288, "z": 1.8206762999536208}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.45641669008468944, "y": 0.740848095288, "z": -0.6564864359296207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2385813679416209, "y": 0.740848095288, "z": 1.0385116220966895}, "radius": 0.05, "color": "#443a83", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2385813679416209, "y": 0.740848095288, "z": 0.1256782419273106}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2385813679416209, "y": 0.740848095288, "z": 1.0385116220966895}, "radius": 0.05, "color": "#443a83", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2385813679416209, "y": 0.740848095288, "z": 0.1256782419273106}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 1.1972647853726892, "z": 1.8206762999536208}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 1.1972647853726892, "z": -0.6564864359296207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 0.2844314052033105, "z": 1.8206762999536208}, "radius": 0.05, "color": "#2fb47c", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 0.2844314052033105, "z": -0.6564864359296207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 1.9794294632296208, "z": 1.0385116220966895}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 1.9794294632296208, "z": 0.1256782419273106}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -0.49773327265362083, "z": 1.0385116220966895}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -0.49773327265362083, "z": 0.1256782419273106}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.20993505791062597, "y": 1.8444156357248458, "z": 1.2752514476376073}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.20993505791062597, "y": 1.8444156357248458, "z": -0.11106158361360742}, "radius": 0.05, "color": "#63cb5f", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.20993505791062597, "y": -0.36271944514884585, "z": 1.2752514476376073}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.20993505791062597, "y": -0.36271944514884585, "z": -0.11106158361360742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.20993505791062597, "y": 1.8444156357248458, "z": 1.2752514476376073}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.20993505791062597, "y": 1.8444156357248458, "z": -0.11106158361360742}, "radius": 0.05, "color": "#63cb5f", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.20993505791062597, "y": -0.36271944514884585, "z": 1.2752514476376073}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.20993505791062597, "y": -0.36271944514884585, "z": -0.11106158361360742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.20993505791062597, "y": 1.4340046109136073, "z": 1.6856624724488458}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.20993505791062597, "y": 1.4340046109136073, "z": -0.5214726084248458}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.20993505791062597, "y": 0.047691579662392486, "z": 1.6856624724488458}, "radius": 0.05, "color": "#440256", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.20993505791062597, "y": 0.047691579662392486, "z": -0.5214726084248458}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.20993505791062597, "y": 1.4340046109136073, "z": 1.6856624724488458}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.20993505791062597, "y": 1.4340046109136073, "z": -0.5214726084248458}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.20993505791062597, "y": 0.047691579662392486, "z": 1.6856624724488458}, "radius": 0.05, "color": "#440256", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.20993505791062597, "y": 0.047691579662392486, "z": -0.5214726084248458}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.1035675404368457, "y": 0.9507831531986258, "z": 1.2752514476376073}, "radius": 0.05, "color": "#f6e620", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.1035675404368457, "y": 0.9507831531986258, "z": -0.11106158361360742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.1035675404368457, "y": 0.530913037377374, "z": 1.2752514476376073}, "radius": 0.05, "color": "#472e7c", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.1035675404368457, "y": 0.530913037377374, "z": -0.11106158361360742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.1035675404368457, "y": 0.9507831531986258, "z": 1.2752514476376073}, "radius": 0.05, "color": "#f6e620", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.1035675404368457, "y": 0.9507831531986258, "z": -0.11106158361360742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.1035675404368457, "y": 0.530913037377374, "z": 1.2752514476376073}, "radius": 0.05, "color": "#472e7c", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.1035675404368457, "y": 0.530913037377374, "z": -0.11106158361360742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.1035675404368457, "y": 1.4340046109136073, "z": 0.792029989922626}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.1035675404368457, "y": 1.4340046109136073, "z": 0.3721598741013741}, "radius": 0.05, "color": "#3aba76", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.1035675404368457, "y": 0.047691579662392486, "z": 0.792029989922626}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.1035675404368457, "y": 0.047691579662392486, "z": 0.3721598741013741}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.1035675404368457, "y": 1.4340046109136073, "z": 0.792029989922626}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.1035675404368457, "y": 1.4340046109136073, "z": 0.3721598741013741}, "radius": 0.05, "color": "#3aba76", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.1035675404368457, "y": 0.047691579662392486, "z": 0.792029989922626}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.1035675404368457, "y": 0.047691579662392486, "z": 0.3721598741013741}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6931565156256074, "y": 0.9507831531986258, "z": 1.6856624724488458}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6931565156256074, "y": 0.9507831531986258, "z": -0.5214726084248458}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6931565156256074, "y": 0.530913037377374, "z": 1.6856624724488458}, "radius": 0.05, "color": "#d2e21b", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6931565156256074, "y": 0.530913037377374, "z": -0.5214726084248458}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6931565156256074, "y": 0.9507831531986258, "z": 1.6856624724488458}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6931565156256074, "y": 0.9507831531986258, "z": -0.5214726084248458}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6931565156256074, "y": 0.530913037377374, "z": 1.6856624724488458}, "radius": 0.05, "color": "#d2e21b", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6931565156256074, "y": 0.530913037377374, "z": -0.5214726084248458}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6931565156256074, "y": 1.8444156357248458, "z": 0.792029989922626}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6931565156256074, "y": 1.8444156357248458, "z": 0.3721598741013741}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6931565156256074, "y": -0.36271944514884585, "z": 0.792029989922626}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6931565156256074, "y": -0.36271944514884585, "z": 0.3721598741013741}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6931565156256074, "y": 1.8444156357248458, "z": 0.792029989922626}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6931565156256074, "y": 1.8444156357248458, "z": 0.3721598741013741}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6931565156256074, "y": -0.36271944514884585, "z": 0.792029989922626}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6931565156256074, "y": -0.36271944514884585, "z": 0.3721598741013741}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.32, "y": -0.740848095288, "z": 0.582094932012}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.32, "y": -0.740848095288, "z": 0.582094932012}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 0.5791519047120001, "z": 0.582094932012}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -2.060848095288, "z": 0.582094932012}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -0.740848095288, "z": 1.9020949320120002}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -0.740848095288, "z": -0.737905067988}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 0.19253285587824273, "z": 1.5154758831782429}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 0.19253285587824273, "z": -0.3512860191542426}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -1.6742290464542426, "z": 1.5154758831782429}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -1.6742290464542426, "z": -0.3512860191542426}, "radius": 0.05, "color": "#450559", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.9333809511662426, "y": -0.740848095288, "z": 1.5154758831782429}, "radius": 0.05, "color": "#f1e51d", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.9333809511662426, "y": -0.740848095288, "z": -0.3512860191542426}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.9333809511662426, "y": -0.740848095288, "z": 1.5154758831782429}, "radius": 0.05, "color": "#f1e51d", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.9333809511662426, "y": -0.740848095288, "z": -0.3512860191542426}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.9333809511662426, "y": 0.19253285587824273, "z": 0.582094932012}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.9333809511662426, "y": -1.6742290464542426, "z": 0.582094932012}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.9333809511662426, "y": 0.19253285587824273, "z": 0.582094932012}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.9333809511662426, "y": -1.6742290464542426, "z": 0.582094932012}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.7621023553303061, "y": 0.021254260042306156, "z": 1.3441972873423063}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.7621023553303061, "y": 0.021254260042306156, "z": -0.18000742331830605}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.7621023553303061, "y": -1.502950450618306, "z": 1.3441972873423063}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.7621023553303061, "y": -1.502950450618306, "z": -0.18000742331830605}, "radius": 0.05, "color": "#440256", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.7621023553303061, "y": 0.021254260042306156, "z": 1.3441972873423063}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.7621023553303061, "y": 0.021254260042306156, "z": -0.18000742331830605}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.7621023553303061, "y": -1.502950450618306, "z": 1.3441972873423063}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.7621023553303061, "y": -1.502950450618306, "z": -0.18000742331830605}, "radius": 0.05, "color": "#440256", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8861124944357698, "y": 0.14526439914776984, "z": 0.996834964333014}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8861124944357698, "y": 0.14526439914776984, "z": 0.1673548996909861}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8861124944357698, "y": -1.6269605897237698, "z": 0.996834964333014}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8861124944357698, "y": -1.6269605897237698, "z": 0.1673548996909861}, "radius": 0.05, "color": "#65cb5e", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8861124944357698, "y": 0.14526439914776984, "z": 0.996834964333014}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8861124944357698, "y": 0.14526439914776984, "z": 0.1673548996909861}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8861124944357698, "y": -1.6269605897237698, "z": 0.996834964333014}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8861124944357698, "y": -1.6269605897237698, "z": 0.1673548996909861}, "radius": 0.05, "color": "#65cb5e", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8861124944357698, "y": -0.326108062966986, "z": 1.4682074264477698}, "radius": 0.05, "color": "#481769", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8861124944357698, "y": -1.1555881276090139, "z": 1.4682074264477698}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8861124944357698, "y": -0.326108062966986, "z": -0.30401756242376976}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.8861124944357698, "y": -1.1555881276090139, "z": -0.30401756242376976}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8861124944357698, "y": -0.326108062966986, "z": 1.4682074264477698}, "radius": 0.05, "color": "#481769", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8861124944357698, "y": -1.1555881276090139, "z": 1.4682074264477698}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8861124944357698, "y": -0.326108062966986, "z": -0.30401756242376976}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.8861124944357698, "y": -1.1555881276090139, "z": -0.30401756242376976}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.4147400323210139, "y": 0.14526439914776984, "z": 1.4682074264477698}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.4147400323210139, "y": 0.14526439914776984, "z": 1.4682074264477698}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.4147400323210139, "y": 0.14526439914776984, "z": -0.30401756242376976}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.4147400323210139, "y": 0.14526439914776984, "z": -0.30401756242376976}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.4147400323210139, "y": -1.6269605897237698, "z": 1.4682074264477698}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.4147400323210139, "y": -1.6269605897237698, "z": 1.4682074264477698}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.4147400323210139, "y": -1.6269605897237698, "z": -0.30401756242376976}, "radius": 0.05, "color": "#450457", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.4147400323210139, "y": -1.6269605897237698, "z": -0.30401756242376976}, "radius": 0.05, "color": "#450457", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.381805462839958, "y": -0.35904263244804197, "z": 1.7866069398770654}, "radius": 0.05, "color": "#70cf57", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.381805462839958, "y": -0.35904263244804197, "z": -0.6224170758530654}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.381805462839958, "y": -1.1226535581279578, "z": 1.7866069398770654}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.381805462839958, "y": -1.1226535581279578, "z": -0.6224170758530654}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.381805462839958, "y": -0.35904263244804197, "z": 1.7866069398770654}, "radius": 0.05, "color": "#70cf57", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.381805462839958, "y": -0.35904263244804197, "z": -0.6224170758530654}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.381805462839958, "y": -1.1226535581279578, "z": 1.7866069398770654}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.381805462839958, "y": -1.1226535581279578, "z": -0.6224170758530654}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.381805462839958, "y": 0.4636639125770655, "z": 0.963900394851958}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.381805462839958, "y": -1.9453601031530654, "z": 0.963900394851958}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.381805462839958, "y": 0.4636639125770655, "z": 0.20028946917204207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.381805462839958, "y": -1.9453601031530654, "z": 0.20028946917204207}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.381805462839958, "y": 0.4636639125770655, "z": 0.963900394851958}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.381805462839958, "y": -1.9453601031530654, "z": 0.963900394851958}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.381805462839958, "y": 0.4636639125770655, "z": 0.20028946917204207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.381805462839958, "y": -1.9453601031530654, "z": 0.20028946917204207}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2045120078650655, "y": -0.35904263244804197, "z": 0.963900394851958}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2045120078650655, "y": -0.35904263244804197, "z": 0.963900394851958}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2045120078650655, "y": -0.35904263244804197, "z": 0.20028946917204207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2045120078650655, "y": -0.35904263244804197, "z": 0.20028946917204207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2045120078650655, "y": -1.1226535581279578, "z": 0.963900394851958}, "radius": 0.05, "color": "#e5e419", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2045120078650655, "y": -1.1226535581279578, "z": 0.963900394851958}, "radius": 0.05, "color": "#e5e419", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2045120078650655, "y": -1.1226535581279578, "z": 0.20028946917204207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2045120078650655, "y": -1.1226535581279578, "z": 0.20028946917204207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5869951795907017, "y": -0.15385291569729823, "z": 1.6083859815074926}, "radius": 0.05, "color": "#46075a", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5869951795907017, "y": -0.15385291569729823, "z": -0.4441961174834926}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5869951795907017, "y": -1.3278432748787017, "z": 1.6083859815074926}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5869951795907017, "y": -1.3278432748787017, "z": -0.4441961174834926}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5869951795907017, "y": -0.15385291569729823, "z": 1.6083859815074926}, "radius": 0.05, "color": "#46075a", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5869951795907017, "y": -0.15385291569729823, "z": -0.4441961174834926}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5869951795907017, "y": -1.3278432748787017, "z": 1.6083859815074926}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5869951795907017, "y": -1.3278432748787017, "z": -0.4441961174834926}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5869951795907017, "y": 0.28544295420749266, "z": 1.1690901116027017}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5869951795907017, "y": -1.7671391447834925, "z": 1.1690901116027017}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5869951795907017, "y": 0.28544295420749266, "z": -0.004900247578701679}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.5869951795907017, "y": -1.7671391447834925, "z": -0.004900247578701679}, "radius": 0.05, "color": "#6ccd5a", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5869951795907017, "y": 0.28544295420749266, "z": 1.1690901116027017}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5869951795907017, "y": -1.7671391447834925, "z": 1.1690901116027017}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5869951795907017, "y": 0.28544295420749266, "z": -0.004900247578701679}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.5869951795907017, "y": -1.7671391447834925, "z": -0.004900247578701679}, "radius": 0.05, "color": "#6ccd5a", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.0262910494954927, "y": -0.15385291569729823, "z": 1.1690901116027017}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.0262910494954927, "y": -0.15385291569729823, "z": 1.1690901116027017}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.0262910494954927, "y": -0.15385291569729823, "z": -0.004900247578701679}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.0262910494954927, "y": -0.15385291569729823, "z": -0.004900247578701679}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.0262910494954927, "y": -1.3278432748787017, "z": 1.1690901116027017}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.0262910494954927, "y": -1.3278432748787017, "z": 1.1690901116027017}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.0262910494954927, "y": -1.3278432748787017, "z": -0.004900247578701679}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.0262910494954927, "y": -1.3278432748787017, "z": -0.004900247578701679}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.17151227908980887, "y": -0.5693358161981911, "z": 1.8796183715855743}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.17151227908980887, "y": -0.5693358161981911, "z": -0.7154285075615742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.17151227908980887, "y": -0.9123603743778088, "z": 1.8796183715855743}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.17151227908980887, "y": -0.9123603743778088, "z": -0.7154285075615742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.17151227908980887, "y": -0.5693358161981911, "z": 1.8796183715855743}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.17151227908980887, "y": -0.5693358161981911, "z": -0.7154285075615742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.17151227908980887, "y": -0.9123603743778088, "z": 1.8796183715855743}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.17151227908980887, "y": -0.9123603743778088, "z": -0.7154285075615742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.17151227908980887, "y": 0.5566753442855743, "z": 0.753607211101809}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.17151227908980887, "y": -2.0383715348615743, "z": 0.753607211101809}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.17151227908980887, "y": 0.5566753442855743, "z": 0.4105826529221912}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.17151227908980887, "y": -2.0383715348615743, "z": 0.4105826529221912}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.17151227908980887, "y": 0.5566753442855743, "z": 0.753607211101809}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.17151227908980887, "y": -2.0383715348615743, "z": 0.753607211101809}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.17151227908980887, "y": 0.5566753442855743, "z": 0.4105826529221912}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.17151227908980887, "y": -2.0383715348615743, "z": 0.4105826529221912}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2975234395735742, "y": -0.5693358161981911, "z": 0.753607211101809}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2975234395735742, "y": -0.5693358161981911, "z": 0.753607211101809}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2975234395735742, "y": -0.5693358161981911, "z": 0.4105826529221912}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2975234395735742, "y": -0.5693358161981911, "z": 0.4105826529221912}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2975234395735742, "y": -0.9123603743778088, "z": 0.753607211101809}, "radius": 0.05, "color": "#481668", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2975234395735742, "y": -0.9123603743778088, "z": 0.753607211101809}, "radius": 0.05, "color": "#481668", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2975234395735742, "y": -0.9123603743778088, "z": 0.4105826529221912}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2975234395735742, "y": -0.9123603743778088, "z": 0.4105826529221912}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.45641669008468944, "y": 0.49773327265362083, "z": 0.582094932012}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.45641669008468944, "y": -1.9794294632296208, "z": 0.582094932012}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.45641669008468944, "y": 0.49773327265362083, "z": 0.582094932012}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.45641669008468944, "y": -1.9794294632296208, "z": 0.582094932012}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2385813679416209, "y": -0.2844314052033105, "z": 0.582094932012}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2385813679416209, "y": -1.1972647853726892, "z": 0.582094932012}, "radius": 0.05, "color": "#25848e", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2385813679416209, "y": -0.2844314052033105, "z": 0.582094932012}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2385813679416209, "y": -1.1972647853726892, "z": 0.582094932012}, "radius": 0.05, "color": "#25848e", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.45641669008468944, "y": -0.740848095288, "z": 1.8206762999536208}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.45641669008468944, "y": -0.740848095288, "z": -0.6564864359296207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.45641669008468944, "y": -0.740848095288, "z": 1.8206762999536208}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.45641669008468944, "y": -0.740848095288, "z": -0.6564864359296207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2385813679416209, "y": -0.740848095288, "z": 1.0385116220966895}, "radius": 0.05, "color": "#443a83", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.2385813679416209, "y": -0.740848095288, "z": 0.1256782419273106}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2385813679416209, "y": -0.740848095288, "z": 1.0385116220966895}, "radius": 0.05, "color": "#443a83", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.2385813679416209, "y": -0.740848095288, "z": 0.1256782419273106}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -0.2844314052033105, "z": 1.8206762999536208}, "radius": 0.05, "color": "#2fb47c", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -0.2844314052033105, "z": -0.6564864359296207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -1.1972647853726892, "z": 1.8206762999536208}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -1.1972647853726892, "z": -0.6564864359296207}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 0.49773327265362083, "z": 1.0385116220966895}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": 0.49773327265362083, "z": 0.1256782419273106}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -1.9794294632296208, "z": 1.0385116220966895}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.0, "y": -1.9794294632296208, "z": 0.1256782419273106}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.20993505791062597, "y": 0.36271944514884585, "z": 1.2752514476376073}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.20993505791062597, "y": 0.36271944514884585, "z": -0.11106158361360742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.20993505791062597, "y": -1.8444156357248458, "z": 1.2752514476376073}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.20993505791062597, "y": -1.8444156357248458, "z": -0.11106158361360742}, "radius": 0.05, "color": "#63cb5f", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.20993505791062597, "y": 0.36271944514884585, "z": 1.2752514476376073}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.20993505791062597, "y": 0.36271944514884585, "z": -0.11106158361360742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.20993505791062597, "y": -1.8444156357248458, "z": 1.2752514476376073}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.20993505791062597, "y": -1.8444156357248458, "z": -0.11106158361360742}, "radius": 0.05, "color": "#63cb5f", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.20993505791062597, "y": -0.047691579662392486, "z": 1.6856624724488458}, "radius": 0.05, "color": "#440256", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.20993505791062597, "y": -0.047691579662392486, "z": -0.5214726084248458}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.20993505791062597, "y": -1.4340046109136073, "z": 1.6856624724488458}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.20993505791062597, "y": -1.4340046109136073, "z": -0.5214726084248458}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.20993505791062597, "y": -0.047691579662392486, "z": 1.6856624724488458}, "radius": 0.05, "color": "#440256", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.20993505791062597, "y": -0.047691579662392486, "z": -0.5214726084248458}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.20993505791062597, "y": -1.4340046109136073, "z": 1.6856624724488458}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.20993505791062597, "y": -1.4340046109136073, "z": -0.5214726084248458}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.1035675404368457, "y": -0.530913037377374, "z": 1.2752514476376073}, "radius": 0.05, "color": "#472e7c", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.1035675404368457, "y": -0.530913037377374, "z": -0.11106158361360742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.1035675404368457, "y": -0.9507831531986258, "z": 1.2752514476376073}, "radius": 0.05, "color": "#f6e620", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.1035675404368457, "y": -0.9507831531986258, "z": -0.11106158361360742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.1035675404368457, "y": -0.530913037377374, "z": 1.2752514476376073}, "radius": 0.05, "color": "#472e7c", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.1035675404368457, "y": -0.530913037377374, "z": -0.11106158361360742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.1035675404368457, "y": -0.9507831531986258, "z": 1.2752514476376073}, "radius": 0.05, "color": "#f6e620", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.1035675404368457, "y": -0.9507831531986258, "z": -0.11106158361360742}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.1035675404368457, "y": -0.047691579662392486, "z": 0.792029989922626}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.1035675404368457, "y": -0.047691579662392486, "z": 0.3721598741013741}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.1035675404368457, "y": -1.4340046109136073, "z": 0.792029989922626}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 1.1035675404368457, "y": -1.4340046109136073, "z": 0.3721598741013741}, "radius": 0.05, "color": "#3aba76", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.1035675404368457, "y": -0.047691579662392486, "z": 0.792029989922626}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.1035675404368457, "y": -0.047691579662392486, "z": 0.3721598741013741}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.1035675404368457, "y": -1.4340046109136073, "z": 0.792029989922626}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -1.1035675404368457, "y": -1.4340046109136073, "z": 0.3721598741013741}, "radius": 0.05, "color": "#3aba76", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6931565156256074, "y": -0.530913037377374, "z": 1.6856624724488458}, "radius": 0.05, "color": "#d2e21b", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6931565156256074, "y": -0.530913037377374, "z": -0.5214726084248458}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6931565156256074, "y": -0.9507831531986258, "z": 1.6856624724488458}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6931565156256074, "y": -0.9507831531986258, "z": -0.5214726084248458}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6931565156256074, "y": -0.530913037377374, "z": 1.6856624724488458}, "radius": 0.05, "color": "#d2e21b", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6931565156256074, "y": -0.530913037377374, "z": -0.5214726084248458}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6931565156256074, "y": -0.9507831531986258, "z": 1.6856624724488458}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6931565156256074, "y": -0.9507831531986258, "z": -0.5214726084248458}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6931565156256074, "y": 0.36271944514884585, "z": 0.792029989922626}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6931565156256074, "y": 0.36271944514884585, "z": 0.3721598741013741}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6931565156256074, "y": -1.8444156357248458, "z": 0.792029989922626}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": 0.6931565156256074, "y": -1.8444156357248458, "z": 0.3721598741013741}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6931565156256074, "y": 0.36271944514884585, "z": 0.792029989922626}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6931565156256074, "y": 0.36271944514884585, "z": 0.3721598741013741}, "radius": 0.05, "color": "#440154", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6931565156256074, "y": -1.8444156357248458, "z": 0.792029989922626}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.addSphere({"center": {"x": -0.6931565156256074, "y": -1.8444156357248458, "z": 0.3721598741013741}, "radius": 0.05, "color": "#fde725", "opacity": 0.6});
	viewer_1763995690714717.zoomTo();
viewer_1763995690714717.render();
});
</script></div><img alt="../../_images/46ed8cf069684a2849494283c1129fe1650b7c7765729aea301470e4a7b6b733.png" src="../../_images/46ed8cf069684a2849494283c1129fe1650b7c7765729aea301470e4a7b6b733.png" />
</div>
</div>
<p>With the function defined below, one can observe how the switching function values of the grid points changes as one of the bonds is stretched/contracted by selecting a value from the drop-down menu below. The standard bond length is 1.0 (100%). Note: <code class="docutils literal notranslate"><span class="pre">ipywidgets</span></code> is required, so if the import fails, then it must be installed, and if the widget just shows up as some text, e.g., <code class="docutils literal notranslate"><span class="pre">display(widgets.IntSlider())</span> <span class="pre">IntSlider(value=0)</span></code> after importing ipywidgets, try refreshing the browser.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">ipywidgets</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">widgets</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">IPython.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">display</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ipywidgets required for this part!&#39;</span><span class="p">)</span>
    
<span class="k">def</span><span class="w"> </span><span class="nf">visualize_grid_for_shifted_mols</span><span class="p">(</span><span class="n">bond_sep</span><span class="p">):</span>
    <span class="n">O_xyz</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">H1_xyz</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.740848095288</span><span class="p">,</span> <span class="mf">0.582094932012</span><span class="p">)</span>
    <span class="n">H2_ref</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.740848095288</span><span class="p">,</span> <span class="mf">0.582094932012</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">shift</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="n">H1_shifted</span> <span class="o">=</span> <span class="p">(</span><span class="n">H1_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                      <span class="n">H1_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">shift</span><span class="p">,</span>
                      <span class="n">H1_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">shift</span><span class="p">)</span>

        <span class="n">xyz_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;3</span>

<span class="s2">        O  </span><span class="si">{</span><span class="n">O_xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">O_xyz</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">O_xyz</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span>
<span class="s2">        H  </span><span class="si">{</span><span class="n">H1_shifted</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">H1_shifted</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">H1_shifted</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span>
<span class="s2">        H  </span><span class="si">{</span><span class="n">H2_ref</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">H2_ref</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">  </span><span class="si">{</span><span class="n">H2_ref</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span>
<span class="s2">        &quot;&quot;&quot;</span>

        <span class="n">molecule_shifted</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="o">.</span><span class="n">read_xyz_string</span><span class="p">(</span><span class="n">xyz_str</span><span class="p">)</span>
        <span class="n">full_grid</span><span class="p">,</span> <span class="n">full_sw_f</span> <span class="o">=</span> <span class="n">raw_grid</span><span class="p">(</span><span class="n">molecule_shifted</span><span class="p">,</span> <span class="n">grid_per_sphere</span><span class="p">)</span>
        
        <span class="n">visualize_cpcm_grid</span><span class="p">(</span><span class="n">molecule_shifted</span><span class="p">,</span> <span class="n">full_grid</span><span class="p">,</span> <span class="n">full_sw_f</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">shift_slider</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">(</span>
    <span class="n">options</span><span class="o">=</span><span class="p">[(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">val</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">bond_sep</span><span class="p">],</span>
    <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Bond scaling&quot;</span><span class="p">,</span>
    <span class="n">value</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>

    <span class="n">out1</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">VBox</span><span class="p">([</span><span class="n">shift_slider</span><span class="p">])</span>
    <span class="n">out2</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interactive_output</span><span class="p">(</span><span class="n">update</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;shift&quot;</span><span class="p">:</span> <span class="n">shift_slider</span><span class="p">})</span>
    
    <span class="n">display</span><span class="p">(</span><span class="n">out1</span><span class="p">,</span> <span class="n">out2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note that for too large or too small bond distances, the separated atom is not</span>
<span class="c1"># displayed explicitly but the grid is still visualised correctly</span>
<span class="c1"># Note also that an active notebook is required for the drop-down menu to update the figure</span>

<span class="c1"># 1.0 corresponds to equilibrium</span>
<span class="n">bond_distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">bond_distances</span> <span class="o">=</span> <span class="p">[</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">visualize_grid_for_shifted_mols</span><span class="p">(</span><span class="n">bond_distances</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "b28f4480aa8c4b6aafa54e1e2c47cfb4"}</script><script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "05e68aadb5c4482089410712a4aafcaa"}</script></div>
</div>
<p>With the switching function, we have fixed the third issue as well, and these factors are taken into account in the grid-generating method of <code class="docutils literal notranslate"><span class="pre">CpcmDriver</span></code>. What we now need is a way to determine the charges on the surface.</p>
</section>
<section id="c-pcm-equations">
<h2>C-PCM equations<a class="headerlink" href="#c-pcm-equations" title="Link to this heading">#</a></h2>
<p>As the name of the model suggests, it is based on a conductor. The defining characteristic of a <em>perfect</em> conductor is that the electric field and charge density within is zero, which implies a constant electric potential on the surface. In C-PCM, the polarizable medium is approximated by a scaled perfect conductor carrying only an induced surface charge. Hence, the C-PCM equations enforce a conductor-like (scaled) boundary condition of vanishing potential on the cavity surface,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} \mathbf{Aq} = -f(\varepsilon) \mathbf{v} \end{equation*}\]</div>
<p>Here <span class="math notranslate nohighlight">\(\mathbf{q}\)</span> is the vector of induced polarization charges on the surface, <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> describes the (screened) Coulomb interaction between the charges <span class="math notranslate nohighlight">\(\mathbf{q}\)</span>, <span class="math notranslate nohighlight">\(\mathbf{v}\)</span> is the potential due to the solute on the cavity surface, and <span class="math notranslate nohighlight">\(f(\varepsilon) = (\varepsilon - 1) / \varepsilon\)</span> is the scaling function that reduces the induced charges as to reflect a dielectric of finite permittivity <span class="math notranslate nohighlight">\(\varepsilon\)</span>. Note that for a perfect conductor we have <span class="math notranslate nohighlight">\(\varepsilon \rightarrow \infty: f(\varepsilon) \rightarrow 1\)</span> and the equation reduces to the normal conductor boundary condition: <span class="math notranslate nohighlight">\(\mathbf{Aq + v} = 0\)</span>. The solute potential <span class="math notranslate nohighlight">\(\mathbf{v}\)</span> can be partitioned as:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} \mathbf{v} = \mathbf{B \hat{z} + c} \end{equation*}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{\hat{z}}\)</span> is the vector of nuclear charges so that <span class="math notranslate nohighlight">\(\mathbf{B \hat{z}}\)</span> generates the nuclear potential on the cavity surface, and <span class="math notranslate nohighlight">\(\mathbf{c}\)</span> is the potential on the cavity surface due to the electrons.</p>
<p>The induced charges, in turn, polarize the solute charge density. To account for this feedback, they are included as external charges in the Fock matrix and thus enter into the SCF iterations. At each step, the C-PCM equations are solved for the updated surface charges, and both the induced charges and the electron density are determined self-consistently. At the first iteration, the solute density corresponds to that in vacuum.</p>
<section id="matrix-definitions">
<h3>Matrix definitions<a class="headerlink" href="#matrix-definitions" title="Link to this heading">#</a></h3>
<p>The matrix elements are defined as:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} A_{kl} = \frac{\text{erf}(\zeta_{kl} |{\mathbf{s}_k - \mathbf{s}_l}|) }{|{\mathbf{s}_{k} - \mathbf{s}_l}|}; \,\,\,\, A_{kk} = \frac{\zeta_{k}}{F_k} \sqrt{\frac{2}{\pi}} \end{equation*}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">form_matrix_A</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">sw_func</span><span class="p">):</span>
    <span class="n">Amat</span>         <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">sqrt_2_invpi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">zi</span><span class="p">,</span> <span class="n">wi</span><span class="p">,</span> <span class="n">zeta_i</span><span class="p">,</span> <span class="n">atom_idx</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">Amat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">zeta_i</span> <span class="o">*</span> <span class="n">sqrt_2_invpi</span> <span class="o">/</span> <span class="n">sw_func</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">zeta_i2</span> <span class="o">=</span> <span class="n">zeta_i</span><span class="o">**</span><span class="mi">2</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">xj</span><span class="p">,</span> <span class="n">yj</span><span class="p">,</span> <span class="n">zj</span><span class="p">,</span> <span class="n">wj</span><span class="p">,</span> <span class="n">zeta_j</span><span class="p">,</span> <span class="n">atom_idx</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>

            <span class="n">zeta_j2</span> <span class="o">=</span> <span class="n">zeta_j</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">zeta_ij</span> <span class="o">=</span> <span class="n">zeta_i</span> <span class="o">*</span> <span class="n">zeta_j</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">zeta_i2</span> <span class="o">+</span> <span class="n">zeta_j2</span><span class="p">)</span>

            <span class="n">r_ij</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">xi</span> <span class="o">-</span> <span class="n">xj</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">yi</span> <span class="o">-</span> <span class="n">yj</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">zi</span> <span class="o">-</span> <span class="n">zj</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

            <span class="n">Aij</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span><span class="n">zeta_ij</span> <span class="o">*</span> <span class="n">r_ij</span><span class="p">)</span> <span class="o">/</span> <span class="n">r_ij</span>
            <span class="n">Amat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">Aij</span>
            <span class="n">Amat</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Aij</span>

    <span class="k">return</span> <span class="n">Amat</span>
</pre></div>
</div>
</div>
</div>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} B_{Ak} = \frac{\text{erf} \left( \zeta_{k} |{\mathbf{r}_k - \mathbf{R}_A}| \right) }{|{\mathbf{r}_k - \mathbf{R}_A}|} \end{equation*}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">form_matrix_B</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">molecule</span><span class="p">):</span>
    <span class="n">Bmat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">molecule</span><span class="o">.</span><span class="n">number_of_atoms</span><span class="p">()))</span>
    <span class="n">natoms</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">number_of_atoms</span><span class="p">()</span>
    <span class="n">atom_coords</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">get_coordinates_in_bohr</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">zi</span><span class="p">,</span> <span class="n">wi</span><span class="p">,</span> <span class="n">zeta_i</span><span class="p">,</span> <span class="n">atom_idx</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">):</span>
            <span class="n">xa</span><span class="p">,</span> <span class="n">ya</span><span class="p">,</span> <span class="n">za</span> <span class="o">=</span> <span class="n">atom_coords</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
            <span class="n">r_ia</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">xi</span> <span class="o">-</span> <span class="n">xa</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">yi</span> <span class="o">-</span> <span class="n">ya</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">zi</span> <span class="o">-</span> <span class="n">za</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">Bmat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span><span class="n">zeta_i</span> <span class="o">*</span> <span class="n">r_ia</span><span class="p">)</span> <span class="o">/</span> <span class="n">r_ia</span>

    <span class="k">return</span> <span class="n">Bmat</span>
</pre></div>
</div>
</div>
</div>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} c_{k} = \displaystyle \sum_{\mu \nu} D_{\mu \nu} L^k_{\mu \nu} \end{equation*}\]</div>
<p>where:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} L^k_{\mu \nu} = -(\mu | \hat{J}_k^{\textrm{screened}} | \nu ) = - \int \phi_{\mu}(\mathbf{r}) \frac{\text{erf} \left( \zeta_{k} |{\mathbf{r} - \mathbf{s}_k}| \right) }{|{\mathbf{r} - \mathbf{s}_k}|} \phi_{\nu}(\mathbf{r}) \text{d}^3 \mathbf{r} \end{equation*}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">form_vector_C</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">D</span><span class="p">):</span>
    <span class="c1"># electrostatic potential integrals</span>
    <span class="n">esp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">nerf_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">NuclearPotentialErfDriver</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">epi_matrix</span> <span class="o">=</span> <span class="n">nerf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">,:</span><span class="mi">3</span><span class="p">]],</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">full_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        <span class="n">esp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">epi_matrix</span> <span class="o">*</span> <span class="n">D</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">esp</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="scf-in-c-pcm">
<h2>SCF in C-PCM<a class="headerlink" href="#scf-in-c-pcm" title="Link to this heading">#</a></h2>
<p>To obtain the self-consistent charge distribution of the solute—the density matrix, and the induced polarization charges on the cavity surface we start by performing a gas-phase calculation for a starting guess of the density. We use a minimal basis set to speed up the numerical gradient calculations later.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">basis</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">MolecularBasis</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="s2">&quot;STO-3G&quot;</span><span class="p">)</span>
<span class="n">scf_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfRestrictedDriver</span><span class="p">()</span>
<span class="n">scf_drv</span><span class="o">.</span><span class="n">ostream</span><span class="o">.</span><span class="n">mute</span><span class="p">()</span>
<span class="n">scf_res</span> <span class="o">=</span> <span class="n">scf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The electrostatic solvation energy is then given by</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
   \Delta G_{\text{els}} = E_\text{pol} = (\mathbf{Bz})^{\dagger} \mathbf{q} + \mathbf{c}^{\dagger}\mathbf{q} + \frac{1}{2f} \mathbf{q}^{\dagger} \mathbf{A} \mathbf{q} = \frac{1}{2} \mathbf{q}^\dagger (\mathbf{Bz + c})
\end{equation*}\]</div>
<p>where the factor 1/2 arises due to the work expended in polarising the solvent. The total energy in solution is</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
    E = E_0 + E_{\textrm{pol}}
\end{equation*}\]</div>
<p>where <span class="math notranslate nohighlight">\(E_0\)</span> is the energy of the solute in vacuum, with a density relaxed in the presence of the induced polarization charges.</p>
<p>Next we construct the Hartree–Fock C-PCM SCF-solver where we include the C-PCM Fock contribution given by</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
    \displaystyle F^{\text{pol}}_{\mu \nu} = \frac{\partial E_\text{pol}}{\partial D_{\mu \nu}} = \sum_k q_k L_{\mu \nu}^k
\end{equation*}\]</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_ints</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">):</span>
    <span class="n">V_nuc</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">nuclear_repulsion_energy</span><span class="p">()</span>
    <span class="n">overlap_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">OverlapDriver</span><span class="p">()</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">overlap_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    
    <span class="c1"># kinetic energy</span>
    <span class="n">kinetic_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">KineticEnergyDriver</span><span class="p">()</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">kinetic_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
    
    <span class="c1"># nuclear attraction</span>
    <span class="n">npot_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">NuclearPotentialDriver</span><span class="p">()</span>
    <span class="n">V</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">npot_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

    <span class="c1"># one-electron Hamiltonian</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">T</span> <span class="o">+</span> <span class="n">V</span>
    
    <span class="c1"># two-electron Hamiltonian</span>
    <span class="n">fock_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">FockDriver</span><span class="p">()</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">fock_drv</span><span class="o">.</span><span class="n">compute_eri</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">S</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">V_nuc</span>
    
<span class="k">def</span><span class="w"> </span><span class="nf">scf_solver</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">A_mat</span><span class="p">,</span> <span class="n">Bz_vec</span><span class="p">,</span> <span class="n">mute</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">max_iter</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">conv_thresh</span> <span class="o">=</span> <span class="mf">1e-6</span>
    <span class="c1"># permittivity of water</span>
    <span class="n">eps</span>     <span class="o">=</span> <span class="mf">78.39</span>
    <span class="n">scale_f</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">eps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">eps</span>
    <span class="n">nocc</span>    <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">number_of_alpha_electrons</span><span class="p">()</span>

    <span class="n">grid_coords</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">zeta</span>        <span class="o">=</span> <span class="n">grid</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="n">S</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">V_nuc</span> <span class="o">=</span> <span class="n">get_ints</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
    
    <span class="c1"># to get grid-charge contribution to the Fock matrix</span>
    <span class="n">nerf_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">NuclearPotentialErfDriver</span><span class="p">()</span>
    
    <span class="n">epsilon</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span>

    <span class="k">for</span> <span class="nb">iter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
        <span class="c1"># restricted</span>
        <span class="n">D_alpha</span> <span class="o">=</span> <span class="n">C</span><span class="p">[:,</span> <span class="p">:</span><span class="n">nocc</span><span class="p">]</span> <span class="o">@</span> <span class="n">C</span><span class="p">[:,</span> <span class="p">:</span><span class="n">nocc</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>

        <span class="n">J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ijkl,kl-&gt;ij&quot;</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">D_alpha</span><span class="p">)</span>
        <span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilkj,kl-&gt;ij&quot;</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">D_alpha</span><span class="p">)</span>

        <span class="c1"># C-PCM part</span>
        <span class="n">C_vec</span> <span class="o">=</span> <span class="n">form_vector_C</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">D_alpha</span><span class="p">)</span>
        <span class="n">rhs</span> <span class="o">=</span> <span class="n">scale_f</span> <span class="o">*</span> <span class="p">(</span><span class="n">Bz_vec</span> <span class="o">+</span> <span class="n">C_vec</span><span class="p">)</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_mat</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
        
        <span class="c1"># grid-charge contribution to the Fock matrix</span>
        <span class="n">F_pol</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">nerf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">grid_coords</span><span class="p">,</span> <span class="n">zeta</span><span class="p">)</span><span class="o">.</span><span class="n">full_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        
        <span class="n">F</span> <span class="o">=</span> <span class="n">h</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">J</span> <span class="o">-</span> <span class="n">K</span> <span class="o">+</span> <span class="n">F_pol</span>

        <span class="n">E_pol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">Bz_vec</span> <span class="o">+</span> <span class="n">C_vec</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">scale_f</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">A_mat</span><span class="p">,</span><span class="n">q</span><span class="p">),</span> <span class="n">q</span><span class="p">)</span>
        <span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">((</span><span class="n">h</span> <span class="o">+</span> <span class="n">F</span><span class="p">)</span> <span class="o">@</span> <span class="n">D_alpha</span><span class="p">)</span> <span class="o">+</span> <span class="n">V_nuc</span> <span class="o">+</span> <span class="n">E_pol</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">F_pol</span> <span class="o">@</span> <span class="n">D_alpha</span><span class="p">)</span>

        <span class="n">F_mo</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">F</span> <span class="o">@</span> <span class="n">C</span>
        <span class="c1"># measure of how far from diagonal</span>
        <span class="n">e_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">F_mo</span><span class="p">[:</span><span class="n">nocc</span><span class="p">,</span> <span class="n">nocc</span><span class="p">:],</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">e_vec</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">error</span> <span class="o">&lt;</span> <span class="n">conv_thresh</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">mute</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">SCF converged in </span><span class="si">{</span><span class="nb">iter</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> iterations!&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Energy, E = </span><span class="si">{</span><span class="n">E</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> a.u&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Solvation energy, E_pol = </span><span class="si">{</span><span class="n">E_pol</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2"> a.u&quot;</span><span class="p">)</span>
            <span class="k">break</span>

        <span class="n">epsilon</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">E</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">E_pol</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">q</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>We can now run the C-PCM SCF.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">form_matrix_A</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">sw_f</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">form_matrix_B</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">molecule</span><span class="p">)</span>
<span class="n">Bz_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">molecule</span><span class="o">.</span><span class="n">get_element_ids</span><span class="p">())</span>

<span class="n">E</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="n">E_pol</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">scf_solver</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">Bz_vec</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SCF converged in 14 iterations!
Energy, E = -7.50e+01 a.u
Solvation energy, E_pol = -6.57e-03 a.u
</pre></div>
</div>
</div>
</div>
<p>To validate our implementation, we compare to the VeloxChem reference.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scf_drv_ref</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfRestrictedDriver</span><span class="p">()</span>
<span class="n">scf_drv_ref</span><span class="o">.</span><span class="n">ostream</span><span class="o">.</span><span class="n">mute</span><span class="p">()</span>
<span class="c1">#scf_drv_ref.update_settings({}, {&#39;solvation_model&#39;: &#39;CPCM&#39;})</span>
<span class="n">scf_drv_ref</span><span class="o">.</span><span class="n">solvation_model</span> <span class="o">=</span> <span class="s1">&#39;CPCM&#39;</span>
<span class="n">scf_drv_ref</span><span class="o">.</span><span class="n">cpcm_grid_per_sphere</span> <span class="o">=</span> <span class="p">(</span><span class="n">grid_per_sphere</span><span class="p">,</span> <span class="n">grid_per_sphere_h</span><span class="p">)</span>
<span class="n">scf_res_ref</span> <span class="o">=</span> <span class="n">scf_drv_ref</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>

<span class="n">epol_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">E_pol</span> <span class="o">-</span> <span class="n">scf_drv_ref</span><span class="o">.</span><span class="n">cpcm_drv</span><span class="o">.</span><span class="n">cpcm_epol</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Success! </span><span class="se">\n</span><span class="s1">Solvation energy vs reference: </span><span class="si">{</span><span class="n">epol_diff</span><span class="si">:</span><span class="s1">.3e</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="n">epol_diff</span> <span class="o">&lt;</span> <span class="mf">1e-6</span> <span class="k">else</span> <span class="s2">&quot;Trouble! No agreement&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">17</span><span class="p">],</span> <span class="n">line</span> <span class="mi">8</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">scf_drv_ref</span><span class="o">.</span><span class="n">cpcm_grid_per_sphere</span> <span class="o">=</span> <span class="p">(</span><span class="n">grid_per_sphere</span><span class="p">,</span> <span class="n">grid_per_sphere_h</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">scf_res_ref</span> <span class="o">=</span> <span class="n">scf_drv_ref</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">8</span> <span class="n">epol_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">E_pol</span> <span class="o">-</span> <span class="n">scf_drv_ref</span><span class="o">.</span><span class="n">cpcm_drv</span><span class="o">.</span><span class="n">cpcm_epol</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Success! </span><span class="se">\n</span><span class="s1">Solvation energy vs reference: </span><span class="si">{</span><span class="n">epol_diff</span><span class="si">:</span><span class="s1">.3e</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="n">epol_diff</span> <span class="o">&lt;</span> <span class="mf">1e-6</span> <span class="k">else</span> <span class="s2">&quot;Trouble! No agreement&quot;</span><span class="p">)</span>

<span class="ne">AttributeError</span>: &#39;CpcmDriver&#39; object has no attribute &#39;cpcm_epol&#39;
</pre></div>
</div>
</div>
</div>
<p>And we see that we get agreement with the reference.</p>
</section>
<section id="gradient">
<h2>Gradient<a class="headerlink" href="#gradient" title="Link to this heading">#</a></h2>
<section id="analytical-gradient">
<h3>Analytical gradient:<a class="headerlink" href="#analytical-gradient" title="Link to this heading">#</a></h3>
<p>With an expression for the energy, we can obtain the nuclear gradient in solution with finite-difference differentiation. Of course, an analytical gradient is much preferred due to its stability and lower computational cost. Looking at a specific component of the gradient—one coordinate <span class="math notranslate nohighlight">\(x \equiv (\mathbf{R}_I)_{x}\)</span> of some nucleus <span class="math notranslate nohighlight">\(I\)</span>, we can write the derivative</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
    \frac{\text{d} E}{\text{d} x} = \frac{\text{d} E_0}{\text{d} x} + \frac{\text{d} E_{\textrm{pol}}}{\text{d} x}
\end{equation*}\]</div>
<p>the first term is just the normal gas-phase gradient, the second term is then the contribution from C-PCM. The derivative can also be written, with the explicit dependencies highlighted as:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*} 
    \frac{\text{d} E}{\text{d} x} =  \frac{\partial E}{\partial x} + \frac{\partial E}{\partial \mathbf{C}} \frac{\text{d} \mathbf{C}}{\text{d} x}  + \frac{\partial E}{\partial \mathbf{s}} \frac{\text{d} \mathbf{s}}{\text{d} x} + \frac{\partial E}{\partial \mathbf{q}}  \frac{ \text{d} \mathbf{q^*}}{\text{d} x}
\end{equation*}\]</div>
<p>where the last term is zero because the charges are obtained variationally from a stationary condition—the energy is minimized with respect to the surface charges <span class="math notranslate nohighlight">\(\mathbf{q}\)</span> at the optimum <span class="math notranslate nohighlight">\(\mathbf{q}^*\)</span>. The first term in isolation we can call the unrelaxed fixed-cavity approximation: we take the derivative only with respect to explicit <span class="math notranslate nohighlight">\(x\)</span>-dependence, <em>i.e.</em>, we perturb the while keeping the grid, the MO-coefficients, and thus the density matrix fixed. Inclusion of the second term yields a corresponding relaxed fixed-cavity approximation, where the <span class="math notranslate nohighlight">\(x\)</span>-dependence of the molecular orbital coefficients are included. The third term, in isolation, corresponds to <em>only</em> perturbing the grid related to atom <span class="math notranslate nohighlight">\(I\)</span>.</p>
</section>
<section id="unrelaxed-fixed-cavity-ufc-approximation">
<h3>Unrelaxed fixed cavity (UFC) approximation<a class="headerlink" href="#unrelaxed-fixed-cavity-ufc-approximation" title="Link to this heading">#</a></h3>
<p>The unrelaxed fixed-cavity approximation is obtained by direct differentiation of the C-PCM matrix-elements. Focusing on the C-PCM contribution, as the <a class="reference internal" href="../mol_struct/opt.html#sec-struct-opt"><span class="std std-ref">gas-phase gradient</span></a> can be found separately,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
    \frac{\partial E_\text{pol}}{\partial x} = \mathbf{q}^{\dagger} \left(\frac{\partial }{\partial x} \mathbf{B \hat{z}} \right) + \mathbf{q}^\dagger \left( \frac{\partial }{\partial x} \mathbf{c} \right) + \frac{1}{2f} \mathbf{q}^{\dagger} \bigg( \underbrace{ \frac{\partial }{\partial x} \mathbf{A}}_{= 0} \bigg) \mathbf{q}.
\end{equation*}\]</div>
<p>Note that the third term is zero in this approximation since we have fixed <span class="math notranslate nohighlight">\(\mathbf{s}\)</span>—which is the only dependence of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> on <span class="math notranslate nohighlight">\(x\)</span>.</p>
<section id="nuclear-contribution">
<h4>Nuclear contribution<a class="headerlink" href="#nuclear-contribution" title="Link to this heading">#</a></h4>
<p>Here we construct the nuclear gradient of the potential on the cavity due to the nuclei.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">grad_B</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">fixed_cavity</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">atom_coords</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">get_coordinates_in_bohr</span><span class="p">()</span>
    <span class="n">natoms</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">number_of_atoms</span><span class="p">()</span>
    <span class="n">two_sqrt_invpi</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fixed_cavity</span><span class="p">:</span>
        <span class="n">dB_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">natoms</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">get_element_ids</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">):</span>
            <span class="n">ra</span> <span class="o">=</span> <span class="n">atom_coords</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
            <span class="n">z_a</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">zi</span><span class="p">,</span> <span class="n">wi</span><span class="p">,</span> <span class="n">zeta_i</span><span class="p">,</span> <span class="n">_</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">grid</span><span class="p">):</span>
                <span class="n">ri</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">zi</span><span class="p">])</span>
                <span class="n">r_ia_vec</span> <span class="o">=</span> <span class="n">ri</span> <span class="o">-</span> <span class="n">ra</span>
                <span class="n">r_ia_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r_ia_vec</span><span class="p">,</span> <span class="n">r_ia_vec</span><span class="p">)</span>
                <span class="n">r_ia</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r_ia_2</span><span class="p">)</span>
                <span class="n">dr_ia</span> <span class="o">=</span> <span class="n">r_ia_vec</span> <span class="o">/</span> <span class="n">r_ia</span>
                <span class="n">dB_dr</span> <span class="o">=</span> <span class="n">z_a</span> <span class="o">*</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span><span class="n">zeta_i</span> <span class="o">*</span> <span class="n">r_ia</span><span class="p">)</span> <span class="o">-</span>
                               <span class="n">two_sqrt_invpi</span> <span class="o">*</span> <span class="n">zeta_i</span> <span class="o">*</span> <span class="n">r_ia</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">zeta_i</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r_ia_2</span><span class="p">))</span> <span class="o">/</span> <span class="n">r_ia_2</span>
                <span class="n">dB_mat</span><span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">dB_dr</span> <span class="o">*</span> <span class="n">dr_ia</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;m,max-&gt;ax&#39;</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">dB_mat</span><span class="p">)</span>

    <span class="n">dB_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">natoms</span><span class="p">,</span> <span class="n">natoms</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="p">(</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">zi</span><span class="p">,</span> <span class="n">wi</span><span class="p">,</span> <span class="n">zeta_i</span><span class="p">,</span> <span class="n">atom_idx</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">grid</span><span class="p">):</span>
            <span class="n">ri</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">zi</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">):</span>
                <span class="n">ra</span> <span class="o">=</span> <span class="n">atom_coords</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
                <span class="n">r_ia_vec</span> <span class="o">=</span> <span class="n">ri</span> <span class="o">-</span> <span class="n">ra</span>
                <span class="n">r_ia_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r_ia_vec</span><span class="p">,</span> <span class="n">r_ia_vec</span><span class="p">)</span>
                <span class="n">r_ia</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r_ia_2</span><span class="p">)</span>
                <span class="n">dr_ia</span> <span class="o">=</span> <span class="n">r_ia_vec</span> <span class="o">/</span> <span class="n">r_ia</span>
                <span class="n">factor</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">I</span> <span class="o">==</span> <span class="n">atom_idx</span><span class="p">)</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">I</span> <span class="o">==</span> <span class="n">a</span><span class="p">)</span>
                <span class="n">dB_dr</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span><span class="n">zeta_i</span> <span class="o">*</span> <span class="n">r_ia</span><span class="p">)</span> <span class="o">-</span>
                           <span class="n">two_sqrt_invpi</span> <span class="o">*</span> <span class="n">zeta_i</span> <span class="o">*</span> <span class="n">r_ia</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">zeta_i</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r_ia_2</span><span class="p">))</span> <span class="o">/</span> <span class="n">r_ia_2</span>
                <span class="n">dB_mat</span><span class="p">[</span><span class="n">m</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">I</span><span class="p">]</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="n">dB_dr</span> <span class="o">*</span> <span class="n">dr_ia</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;m,mzax,z-&gt;ax&#39;</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">dB_mat</span><span class="p">,</span> <span class="n">molecule</span><span class="o">.</span><span class="n">get_element_ids</span><span class="p">())</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
<section id="electronic-contribution">
<h4>Electronic contribution<a class="headerlink" href="#electronic-contribution" title="Link to this heading">#</a></h4>
<p>Here we construct the nuclear gradient of the potential on the cavity due to the electrons.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">grad_C</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">DM</span><span class="p">,</span> <span class="n">fixed_cavity</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">natoms</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">number_of_atoms</span><span class="p">()</span>
    <span class="n">grad_C_nuc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">natoms</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">grad_C_cav</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">natoms</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">atom_indices</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">grid_coords</span>  <span class="o">=</span> <span class="n">grid</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">zeta</span>         <span class="o">=</span> <span class="n">grid</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="s1">&#39;Z&#39;</span><span class="p">]</span>
    <span class="n">geom100_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">NuclearPotentialErfGeom100Driver</span><span class="p">()</span>
    <span class="n">geom010_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">NuclearPotentialErfGeom010Driver</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">):</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="p">(</span><span class="n">atom_indices</span> <span class="o">==</span> <span class="n">a</span><span class="p">)</span>
        <span class="n">q_a</span>     <span class="o">=</span> <span class="n">q</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
        <span class="n">grid_a</span>  <span class="o">=</span> <span class="n">grid_coords</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
        <span class="n">zeta_a</span>  <span class="o">=</span> <span class="n">zeta</span><span class="p">[</span><span class="n">indices</span><span class="p">]</span>
        <span class="n">geom010_mats</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">grad_100</span> <span class="o">=</span> <span class="n">geom100_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">grid</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">q</span><span class="p">,</span> <span class="n">zeta</span><span class="p">)</span>
        <span class="n">geom100_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">grad_100</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">label</span><span class="p">)</span><span class="o">.</span><span class="n">full_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">])</span>
        <span class="n">geom001_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">grad_100</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">label</span><span class="p">)</span><span class="o">.</span><span class="n">full_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span><span class="o">.</span><span class="n">T</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">])</span>
        <span class="n">geom100_mats</span> <span class="o">+=</span> <span class="n">geom001_mats</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">fixed_cavity</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">charge</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">q_a</span><span class="p">):</span>
                <span class="n">grad_010</span> <span class="o">=</span> <span class="n">geom010_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="p">[</span><span class="n">charge</span><span class="p">],</span> <span class="p">[</span><span class="n">grid_a</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="p">[</span><span class="n">zeta_a</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
                <span class="n">geom010_mats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">grad_010</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">label</span><span class="p">)</span><span class="o">.</span><span class="n">full_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">geom010_mats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">q_a</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="n">DM</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DM</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="n">grad_C_nuc</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;kxij,ij -&gt; x&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">geom010_mats</span><span class="p">),</span> <span class="n">DM</span><span class="p">)</span>
        <span class="n">grad_C_cav</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;xmn, mn -&gt; x&quot;</span><span class="p">,</span> <span class="n">geom100_mats</span><span class="p">,</span> <span class="n">DM</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">grad_C_nuc</span> <span class="o">+</span> <span class="n">grad_C_cav</span>
</pre></div>
</div>
</div>
</details>
</div>
</section>
</section>
<section id="numerical-gradient">
<h3>Numerical gradient<a class="headerlink" href="#numerical-gradient" title="Link to this heading">#</a></h3>
<p>Let us construct a numerical gradient so that we can verify our analytical approach.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_cpcm_energy</span><span class="p">(</span><span class="n">A_mat</span><span class="p">,</span> <span class="n">Bz_vec</span><span class="p">,</span> <span class="n">C_vec</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
    <span class="n">eps</span>     <span class="o">=</span> <span class="mf">78.39</span>
    <span class="n">scale_f</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">eps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">eps</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">Bz_vec</span> <span class="o">+</span> <span class="n">C_vec</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">scale_f</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">A_mat</span><span class="p">,</span><span class="n">q</span><span class="p">),</span> <span class="n">q</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">numerical_derivative</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">A_mat</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">delta_h</span><span class="o">=</span><span class="mf">.001</span><span class="p">,</span> <span class="n">fixed_cavity</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">relaxed</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">eps</span>     <span class="o">=</span> <span class="mf">78.39</span>
    <span class="n">scale_f</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">eps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">eps</span>
    <span class="n">cpcm_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">CpcmDriver</span><span class="p">()</span>
    <span class="n">cpcm_drv</span><span class="o">.</span><span class="n">grid_per_sphere</span> <span class="o">=</span> <span class="p">(</span><span class="n">grid_per_sphere</span><span class="p">,</span> <span class="n">grid_per_sphere_h</span><span class="p">)</span>
    <span class="c1"># atom labels</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">get_labels</span><span class="p">()</span>

    <span class="n">nocc</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">number_of_alpha_electrons</span><span class="p">()</span>
    
    <span class="c1"># atom coordinates (nx3)</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">get_coordinates_in_bohr</span><span class="p">()</span>
    
    <span class="c1"># charge and spin multiplicity</span>
    <span class="n">charge</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">get_charge</span><span class="p">()</span>
    <span class="n">multiplicity</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">get_multiplicity</span><span class="p">()</span>
    
    <span class="n">V_nuc</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">nuclear_repulsion_energy</span><span class="p">()</span>
    
    <span class="c1"># numerical gradient</span>
    <span class="n">gradient</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">molecule</span><span class="o">.</span><span class="n">number_of_atoms</span><span class="p">(),</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">gradient_pol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">molecule</span><span class="o">.</span><span class="n">number_of_atoms</span><span class="p">(),</span> <span class="mi">3</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">molecule</span><span class="o">.</span><span class="n">number_of_atoms</span><span class="p">()):</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span> <span class="o">+=</span> <span class="n">delta_h</span>
            <span class="n">new_mol</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;au&#39;</span><span class="p">)</span>
            <span class="n">new_mol</span><span class="o">.</span><span class="n">set_charge</span><span class="p">(</span><span class="n">charge</span><span class="p">)</span>
            <span class="n">new_mol</span><span class="o">.</span><span class="n">set_multiplicity</span><span class="p">(</span><span class="n">multiplicity</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="n">fixed_cavity</span><span class="p">:</span>
                <span class="n">grid</span><span class="p">,</span> <span class="n">sw_f</span> <span class="o">=</span> <span class="n">cpcm_drv</span><span class="o">.</span><span class="n">generate_cpcm_grid</span><span class="p">(</span><span class="n">new_mol</span><span class="p">)</span>
                <span class="n">A_mat</span> <span class="o">=</span> <span class="n">form_matrix_A</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">sw_f</span><span class="p">)</span>
                <span class="n">B_mat</span> <span class="o">=</span> <span class="n">form_matrix_B</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">new_mol</span><span class="p">)</span>
                <span class="n">Bz_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B_mat</span><span class="p">,</span> <span class="n">new_mol</span><span class="o">.</span><span class="n">get_element_ids</span><span class="p">())</span>
                <span class="n">C_vec</span> <span class="o">=</span> <span class="n">form_vector_C</span><span class="p">(</span><span class="n">new_mol</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
                <span class="n">scale_f</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">eps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">eps</span>
                <span class="n">rhs</span> <span class="o">=</span> <span class="n">scale_f</span> <span class="o">*</span> <span class="p">(</span><span class="n">Bz_vec</span> <span class="o">+</span> <span class="n">C_vec</span><span class="p">)</span>
                <span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_mat</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">C_vec</span> <span class="o">=</span> <span class="n">form_vector_C</span><span class="p">(</span><span class="n">new_mol</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
                <span class="n">B_mat</span> <span class="o">=</span> <span class="n">form_matrix_B</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">new_mol</span><span class="p">)</span>
                <span class="n">Bz_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B_mat</span><span class="p">,</span> <span class="n">new_mol</span><span class="o">.</span><span class="n">get_element_ids</span><span class="p">())</span>
                
            <span class="k">if</span> <span class="n">relaxed</span><span class="p">:</span>
                <span class="n">E_plus</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">E_pol_plus</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">scf_solver</span><span class="p">(</span><span class="n">new_mol</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">A_mat</span><span class="p">,</span> <span class="n">Bz_vec</span><span class="p">,</span> <span class="n">mute</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">E_plus</span> <span class="o">=</span> <span class="n">get_cpcm_energy</span><span class="p">(</span><span class="n">A_mat</span><span class="p">,</span> <span class="n">Bz_vec</span><span class="p">,</span> <span class="n">C_vec</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

            <span class="c1">#----------------------------------#</span>
            <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">delta_h</span>
            <span class="n">new_mol</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">Molecule</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;au&#39;</span><span class="p">)</span>
            <span class="n">new_mol</span><span class="o">.</span><span class="n">set_charge</span><span class="p">(</span><span class="n">charge</span><span class="p">)</span>
            <span class="n">new_mol</span><span class="o">.</span><span class="n">set_multiplicity</span><span class="p">(</span><span class="n">multiplicity</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">fixed_cavity</span><span class="p">:</span>
                <span class="n">grid</span><span class="p">,</span> <span class="n">sw_f</span> <span class="o">=</span> <span class="n">cpcm_drv</span><span class="o">.</span><span class="n">generate_cpcm_grid</span><span class="p">(</span><span class="n">new_mol</span><span class="p">)</span>
                <span class="n">A_mat</span> <span class="o">=</span> <span class="n">form_matrix_A</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">sw_f</span><span class="p">)</span>
                <span class="n">B_mat</span> <span class="o">=</span> <span class="n">form_matrix_B</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">new_mol</span><span class="p">)</span>
                <span class="n">Bz_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B_mat</span><span class="p">,</span> <span class="n">new_mol</span><span class="o">.</span><span class="n">get_element_ids</span><span class="p">())</span>
                <span class="n">C_vec</span> <span class="o">=</span> <span class="n">form_vector_C</span><span class="p">(</span><span class="n">new_mol</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
                <span class="n">scale_f</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">eps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">eps</span>
                <span class="n">rhs</span> <span class="o">=</span> <span class="n">scale_f</span> <span class="o">*</span> <span class="p">(</span><span class="n">Bz_vec</span> <span class="o">+</span> <span class="n">C_vec</span><span class="p">)</span>
                <span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_mat</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">C_vec</span> <span class="o">=</span> <span class="n">form_vector_C</span><span class="p">(</span><span class="n">new_mol</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
                <span class="n">B_mat</span> <span class="o">=</span> <span class="n">form_matrix_B</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">new_mol</span><span class="p">)</span>
                <span class="n">Bz_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B_mat</span><span class="p">,</span> <span class="n">new_mol</span><span class="o">.</span><span class="n">get_element_ids</span><span class="p">())</span>
                
            <span class="k">if</span> <span class="n">relaxed</span><span class="p">:</span>
                <span class="n">E_minus</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">E_pol_minus</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">scf_solver</span><span class="p">(</span><span class="n">new_mol</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">A_mat</span><span class="p">,</span> <span class="n">Bz_vec</span><span class="p">,</span> <span class="n">mute</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">E_minus</span> <span class="o">=</span> <span class="n">get_cpcm_energy</span><span class="p">(</span><span class="n">A_mat</span><span class="p">,</span> <span class="n">Bz_vec</span><span class="p">,</span> <span class="n">C_vec</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
    
            <span class="n">coords</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">delta_h</span>
            
            <span class="n">gradient</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">d</span><span class="p">]</span> <span class="o">=</span> <span class="p">((</span><span class="n">E_plus</span> <span class="o">-</span> <span class="n">E_minus</span><span class="p">)</span> <span class="o">/</span>
                                <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">delta_h</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">gradient</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>For the <em>unrelaxed</em> gradient we use the gas-phase electronic density, and the fixed-cavity refers to not displacing the grid when perturbing the nuclei. As can be seen from the numerical gradient, this means we are only considering the energy change from perturbing the nuclei in isolation – keeping everything else fixed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nocc</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">number_of_alpha_electrons</span><span class="p">()</span>
<span class="n">C_gasphase</span> <span class="o">=</span> <span class="n">scf_res</span><span class="p">[</span><span class="s1">&#39;C_alpha&#39;</span><span class="p">]</span>
<span class="n">D_gasphase</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">C_gasphase</span><span class="p">[:,</span> <span class="p">:</span><span class="n">nocc</span><span class="p">]</span> <span class="o">@</span> <span class="n">C_gasphase</span><span class="p">[:,</span> <span class="p">:</span><span class="n">nocc</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>

<span class="c1"># analytical gradient</span>
<span class="n">B_grad</span> <span class="o">=</span> <span class="n">grad_B</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">fixed_cavity</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">C_grad_unrelaxed</span> <span class="o">=</span> <span class="n">grad_C</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">D_gasphase</span><span class="p">,</span> <span class="n">fixed_cavity</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ana_ufc_grad</span> <span class="o">=</span> <span class="n">B_grad</span> <span class="o">+</span> <span class="n">C_grad_unrelaxed</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_ufc_grad</span> <span class="o">=</span> <span class="n">numerical_derivative</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">D_gasphase</span><span class="p">,</span>
                                    <span class="n">fixed_cavity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">relaxed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comparison</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ana_ufc_grad</span> <span class="o">-</span> <span class="n">num_ufc_grad</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Success! </span><span class="se">\n</span><span class="s1">Max. difference analytical vs. numerical: </span><span class="si">{</span><span class="n">comparison</span><span class="si">:</span><span class="s1">.3e</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="n">comparison</span> <span class="o">&lt;</span> <span class="mf">1e-6</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;No agreement, difference &gt; 10^(-6) (</span><span class="si">{</span><span class="n">comparison</span><span class="si">:</span><span class="s1">.3e</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Success! 
Max. difference analytical vs. numerical: 4.205e-09
</pre></div>
</div>
</div>
</div>
</section>
<section id="relaxed-fixed-cavity-rfc-gradient">
<h3>Relaxed fixed cavity (RFC) gradient<a class="headerlink" href="#relaxed-fixed-cavity-rfc-gradient" title="Link to this heading">#</a></h3>
<p>For the relaxed part, as we are here only considering ground-state HF/DFT – for which the ground state is obtained from variational optimization of the energy w.r.t. orbital rotations – with the C-PCM contribution to the Fock matrix being a simple contribution, it can be shown that we will not have any additional orbital-response terms. This means that the C-PCM contribution to the relaxation can be handled by the gas-phase gradient routines with the density and orbital energies <span class="math notranslate nohighlight">\(\varepsilon\)</span>, from the C-PCM-included SCF,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
    \frac{\text{d} E_\text{RFC} }{\text{d} x} = \frac{\partial E}{\partial x} - \sum_i \varepsilon_i \frac{\partial S_{ii}}{\partial x} =  \frac{\partial E}{\partial x} - \sum_i \varepsilon_i \sum_{\mu \nu}  C_{\mu i} \frac{\text{d} S_{\mu \nu} }{\text{d} x} C_{\nu i}.
\end{equation*}\]</div>
<p>This means we can use the gas-phase gradient routines, but with the density and orbital energies from C-PCM–SCF to obtain the relaxation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># construct the density from our C-PCM--SCF results</span>
<span class="n">D</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">C</span><span class="p">[:,</span> <span class="p">:</span><span class="n">nocc</span><span class="p">]</span> <span class="o">@</span> <span class="n">C</span><span class="p">[:,</span> <span class="p">:</span><span class="n">nocc</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>

<span class="n">grad_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">ScfGradientDriver</span><span class="p">(</span><span class="n">scf_drv</span><span class="p">)</span>
<span class="n">scf_res_gp</span> <span class="o">=</span> <span class="n">scf_res</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">scf_res_gp</span><span class="p">[</span><span class="s1">&#39;C_alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">C</span>
<span class="n">scf_res_gp</span><span class="p">[</span><span class="s1">&#39;D_alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">D</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">scf_res_gp</span><span class="p">[</span><span class="s1">&#39;E_alpha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">epsilon</span>
<span class="n">grad_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">scf_res_gp</span><span class="p">)</span>

<span class="n">C_relaxed_grad</span> <span class="o">=</span> <span class="n">grad_C</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>

<span class="n">ana_rfc_grad</span> <span class="o">=</span> <span class="n">B_grad</span> <span class="o">+</span> <span class="n">C_relaxed_grad</span> <span class="o">+</span> <span class="n">grad_drv</span><span class="o">.</span><span class="n">get_gradient</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">ana_rfc_grad</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-1.476e-18 -9.543e-17 8.420e-02]
 [3.950e-19 -4.248e-02 -4.235e-02]
 [2.570e-19 4.248e-02 -4.235e-02]]
</pre></div>
</div>
</div>
</div>
<p>Note the (expected) symmetrical structure of the gradient concerning the hydrogen atoms.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_rfc_grad</span> <span class="o">=</span> <span class="n">numerical_derivative</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span>
                                    <span class="n">fixed_cavity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">relaxed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyboardInterrupt</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">32</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">num_rfc_grad</span> <span class="o">=</span> <span class="n">numerical_derivative</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>                                     <span class="n">fixed_cavity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">relaxed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nn">Cell In[31], line 51,</span> in <span class="ni">numerical_derivative</span><span class="nt">(molecule, grid, A_mat, q, D, delta_h, fixed_cavity, relaxed)</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span>     <span class="n">Bz_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">B_mat</span><span class="p">,</span> <span class="n">new_mol</span><span class="o">.</span><span class="n">get_element_ids</span><span class="p">())</span>
<span class="g g-Whitespace">     </span><span class="mi">50</span> <span class="k">if</span> <span class="n">relaxed</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">51</span>     <span class="n">E_plus</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">E_pol_plus</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">scf_solver</span><span class="p">(</span><span class="n">new_mol</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">A_mat</span><span class="p">,</span> <span class="n">Bz_vec</span><span class="p">,</span> <span class="n">mute</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">52</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span>     <span class="n">E_plus</span> <span class="o">=</span> <span class="n">get_cpcm_energy</span><span class="p">(</span><span class="n">A_mat</span><span class="p">,</span> <span class="n">Bz_vec</span><span class="p">,</span> <span class="n">C_vec</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

<span class="nn">Cell In[15], line 49,</span> in <span class="ni">scf_solver</span><span class="nt">(molecule, basis, grid, A_mat, Bz_vec, mute)</span>
<span class="g g-Whitespace">     </span><span class="mi">46</span> <span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s2">&quot;ilkj,kl-&gt;ij&quot;</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">D_alpha</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">48</span> <span class="c1"># C-PCM part</span>
<span class="ne">---&gt; </span><span class="mi">49</span> <span class="n">C_vec</span> <span class="o">=</span> <span class="n">form_vector_C</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">D_alpha</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">50</span> <span class="n">rhs</span> <span class="o">=</span> <span class="n">scale_f</span> <span class="o">*</span> <span class="p">(</span><span class="n">Bz_vec</span> <span class="o">+</span> <span class="n">C_vec</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">51</span> <span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A_mat</span><span class="p">,</span> <span class="n">rhs</span><span class="p">)</span>

<span class="nn">Cell In[13], line 7,</span> in <span class="ni">form_vector_C</span><span class="nt">(molecule, basis, grid, D)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">nerf_drv</span> <span class="o">=</span> <span class="n">vlx</span><span class="o">.</span><span class="n">NuclearPotentialErfDriver</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
<span class="ne">----&gt; </span><span class="mi">7</span>     <span class="n">epi_matrix</span> <span class="o">=</span> <span class="n">nerf_drv</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">],</span> <span class="p">[</span><span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">,:</span><span class="mi">3</span><span class="p">]],</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">full_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>     <span class="n">esp</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">epi_matrix</span> <span class="o">*</span> <span class="n">D</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="k">return</span> <span class="n">esp</span>

<span class="ne">KeyboardInterrupt</span>: 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comparison</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ana_rfc_grad</span> <span class="o">-</span> <span class="n">num_rfc_grad</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Success! </span><span class="se">\n</span><span class="s1">Max. difference analytical vs. numerical: </span><span class="si">{</span><span class="n">comparison</span><span class="si">:</span><span class="s1">.3e</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="n">comparison</span> <span class="o">&lt;</span> <span class="mf">1e-6</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;No agreement, difference &gt; 10^(-6) (</span><span class="si">{</span><span class="n">comparison</span><span class="si">:</span><span class="s1">.3e</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Success! 
Max. difference analytical vs. numerical: 5.502e-07
</pre></div>
</div>
</div>
</div>
</section>
<section id="full-gradient">
<h3>Full gradient<a class="headerlink" href="#full-gradient" title="Link to this heading">#</a></h3>
<p>Finally, for the full gradient where we allow the cavity grid to move with the respective nuclei. In addition to taking into account the dependence on the nuclear coordinates of the grid coordinates (through the <span class="math notranslate nohighlight">\(\mathbf{B}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{c}\)</span> terms from before, we must also consider the gradient of the cavity-cavity interactions – described by the gradient of <span class="math notranslate nohighlight">\(\mathbf{A}\)</span>. This gradient has below been split into a diagonal, describing the self-interaction of each screening charge – appearing as the screening charges have been discretized and occupy finite area/volume, and the off-diagonal which describes the interactions <em>between</em> the screening charges.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">grad_Aij</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">78.39</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">two_sqrt_invpi</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">natoms</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">number_of_atoms</span><span class="p">()</span>
    <span class="n">scale_f</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">eps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">eps</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">natoms</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">zi</span><span class="p">,</span> <span class="n">wi</span><span class="p">,</span> <span class="n">zeta_i</span><span class="p">,</span> <span class="n">atom_idx_i</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">r_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">zi</span><span class="p">])</span>
            <span class="n">zeta_i2</span> <span class="o">=</span> <span class="n">zeta_i</span><span class="o">**</span><span class="mi">2</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">xj</span><span class="p">,</span> <span class="n">yj</span><span class="p">,</span> <span class="n">zj</span><span class="p">,</span> <span class="n">wj</span><span class="p">,</span> <span class="n">zeta_j</span><span class="p">,</span> <span class="n">atom_idx_j</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">r_j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xj</span><span class="p">,</span> <span class="n">yj</span><span class="p">,</span> <span class="n">zj</span><span class="p">])</span>
                <span class="n">zeta_j2</span> <span class="o">=</span> <span class="n">zeta_j</span><span class="o">**</span><span class="mi">2</span>
                <span class="n">zeta_ij</span> <span class="o">=</span> <span class="n">zeta_i</span> <span class="o">*</span> <span class="n">zeta_j</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">zeta_i2</span> <span class="o">+</span> <span class="n">zeta_j2</span><span class="p">)</span>

                <span class="n">r_vec</span> <span class="o">=</span> <span class="n">r_i</span> <span class="o">-</span> <span class="n">r_j</span>
                <span class="n">r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r_vec</span><span class="p">,</span> <span class="n">r_vec</span><span class="p">)</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>
                <span class="n">factor</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">atom_idx_i</span><span class="p">)</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">atom_idx_j</span><span class="p">)</span>

                <span class="n">dr</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="p">(</span><span class="n">r_vec</span> <span class="o">/</span> <span class="n">r</span><span class="p">)</span>
                <span class="n">dA_dr</span> <span class="o">=</span> <span class="o">-</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span><span class="n">zeta_ij</span> <span class="o">*</span> <span class="n">r</span><span class="p">)</span> <span class="o">-</span> <span class="n">two_sqrt_invpi</span> <span class="o">*</span> <span class="n">zeta_ij</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span>
                           <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">zeta_ij</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r2</span><span class="p">))</span> <span class="o">/</span> <span class="n">r2</span>
                <span class="n">grad</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">dA_dr</span> <span class="o">*</span> <span class="n">dr</span>
                <span class="n">grad</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">grad</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span>

    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">scale_f</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ijax,j-&gt;ax&#39;</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">grad_Aii</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">sw_f</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">78.39</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">natoms</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">number_of_atoms</span><span class="p">()</span>
    <span class="n">grad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">natoms</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">sqrt_2_inv_pi</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">atom_radii</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">vdw_radii_to_numpy</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1.2</span>
    <span class="n">atom_coords</span> <span class="o">=</span> <span class="n">molecule</span><span class="o">.</span><span class="n">get_coordinates_in_bohr</span><span class="p">()</span>
    <span class="n">scale_f</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">eps</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">eps</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">zi</span><span class="p">,</span> <span class="n">wi</span><span class="p">,</span> <span class="n">zeta_i</span><span class="p">,</span> <span class="n">atom_idx</span> <span class="o">=</span> <span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">r_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">zi</span><span class="p">])</span>
            <span class="n">F_i</span> <span class="o">=</span> <span class="n">sw_f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

            <span class="n">summed_fi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">J</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">):</span>
                <span class="n">r_J</span> <span class="o">=</span> <span class="n">atom_coords</span><span class="p">[</span><span class="n">J</span><span class="p">]</span>
                <span class="n">RJ</span> <span class="o">=</span> <span class="n">atom_radii</span><span class="p">[</span><span class="n">J</span><span class="p">]</span>
                <span class="n">r_vec</span> <span class="o">=</span> <span class="n">r_i</span> <span class="o">-</span> <span class="n">r_J</span>
                <span class="n">r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r_vec</span><span class="p">,</span> <span class="n">r_vec</span><span class="p">)</span>
                <span class="n">r</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>
                <span class="n">factor</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">atom_idx</span><span class="p">)</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">J</span><span class="p">)</span>

                <span class="n">dr</span> <span class="o">=</span> <span class="n">factor</span> <span class="o">*</span> <span class="p">(</span><span class="n">r_vec</span> <span class="o">/</span> <span class="n">r</span><span class="p">)</span>
                <span class="n">fiJ</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span><span class="n">zeta_i</span> <span class="o">*</span> <span class="p">(</span><span class="n">RJ</span> <span class="o">-</span> <span class="n">r</span><span class="p">))</span> <span class="o">+</span> <span class="n">math</span><span class="o">.</span><span class="n">erf</span><span class="p">(</span><span class="n">zeta_i</span> <span class="o">*</span> <span class="p">(</span><span class="n">RJ</span> <span class="o">+</span> <span class="n">r</span><span class="p">)))</span>
                <span class="n">dfiJ_driJ</span> <span class="o">=</span> <span class="n">zeta_i</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">zeta_i</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">RJ</span> <span class="o">-</span> <span class="n">r</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
                                                            <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">zeta_i</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">RJ</span> <span class="o">+</span> <span class="n">r</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
                <span class="n">summed_fi</span> <span class="o">+=</span> <span class="n">dfiJ_driJ</span> <span class="o">/</span> <span class="n">fiJ</span> <span class="o">*</span> <span class="n">dr</span>

            <span class="n">grad_F_i</span> <span class="o">=</span> <span class="o">-</span><span class="n">F_i</span> <span class="o">*</span> <span class="n">summed_fi</span>
            <span class="n">grad</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">zeta_i</span> <span class="o">*</span> <span class="n">sqrt_2_inv_pi</span> <span class="o">/</span> <span class="n">F_i</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">grad_F_i</span>

    <span class="k">return</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.5</span> <span class="o">/</span> <span class="n">scale_f</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">einsum</span><span class="p">(</span><span class="s1">&#39;i,ijax,j-&gt;ax&#39;</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_grad</span> <span class="o">=</span> <span class="n">numerical_derivative</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span>
                                <span class="n">relaxed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fixed_cavity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Not fixed cavity!
Relaxed!
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B_grad</span> <span class="o">=</span> <span class="n">grad_B</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">fixed_cavity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">C_grad</span> <span class="o">=</span> <span class="n">grad_C</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">basis</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">fixed_cavity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">A_grad</span> <span class="o">=</span> <span class="n">grad_Aii</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">sw_f</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">+</span> <span class="n">grad_Aij</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

<span class="n">ana_grad</span> <span class="o">=</span> <span class="n">A_grad</span> <span class="o">+</span> <span class="n">B_grad</span> <span class="o">+</span> <span class="n">C_grad</span> <span class="o">+</span> <span class="n">grad_drv</span><span class="o">.</span><span class="n">get_gradient</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">comparison</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ana_grad</span> <span class="o">-</span> <span class="n">num_grad</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Success! </span><span class="se">\n</span><span class="s1">Max. difference analytical vs. numerical: </span><span class="si">{</span><span class="n">comparison</span><span class="si">:</span><span class="s1">.3e</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">if</span> <span class="n">comparison</span> <span class="o">&lt;</span> <span class="mf">1e-6</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;No agreement, difference &gt; 10^(-6) (</span><span class="si">{</span><span class="n">comparison</span><span class="si">:</span><span class="s1">.3e</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Success! 
Max. difference analytical vs. numerical: 5.518e-07
</pre></div>
</div>
</div>
</div>
<p>Extending C-PCM from a HF framework to Kohn–Sham DFT is straightforward, requiring only the inclusion of the exchange–correlation functional.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs/env"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="pcm.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Polarizable continuum models</p>
      </div>
    </a>
    <a class="right-next"
       href="../visualize/mol_struct.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Molecular structure and dynamics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cavity-grid">Cavity grid</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#c-pcm-equations">C-PCM equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-definitions">Matrix definitions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scf-in-c-pcm">SCF in C-PCM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#gradient">Gradient</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analytical-gradient">Analytical gradient:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unrelaxed-fixed-cavity-ufc-approximation">Unrelaxed fixed cavity (UFC) approximation</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nuclear-contribution">Nuclear contribution</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#electronic-contribution">Electronic contribution</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-gradient">Numerical gradient</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relaxed-fixed-cavity-rfc-gradient">Relaxed fixed cavity (RFC) gradient</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#full-gradient">Full gradient</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The eChem team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>